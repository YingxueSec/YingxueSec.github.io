<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ç¬¬8ç«  å‡½æ•° | Jackhou Blog</title><meta name="keywords" content="ã€ŠJavaScriptæƒå¨æŒ‡å—ã€‹,JavaScript"><meta name="author" content="Jack hou"><meta name="copyright" content="Jack hou"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="ç¬¬8ç«  å‡½æ•°"><meta name="application-name" content="ç¬¬8ç«  å‡½æ•°"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="default"><link rel="bookmark" href="/img/siteicon/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" sizes="180x180" href="/img/siteicon/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="192x192" href="/img/siteicon/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="512x512" href="/img/siteicon/apple-touch-icon.png"><link rel="apple-touch-startup-image" media="screen and (device-width:320px) and (device-height:568px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_1136x640.png"><link rel="apple-touch-startup-image" media="screen and (device-width:320px) and (device-height:568px) and (-webkit-device-pixel-ratio:2) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_640x1136.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:3) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_2688x1242.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_1792x828.png"><link rel="apple-touch-startup-image" media="screen and (device-width:375px) and (device-height:812px) and (-webkit-device-pixel-ratio:3) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_1125x2436.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:2) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_828x1792.png"><link rel="apple-touch-startup-image" media="screen and (device-width:375px) and (device-height:812px) and (-webkit-device-pixel-ratio:3) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_2436x1125.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:736px) and (-webkit-device-pixel-ratio:3) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_1242x2208.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:736px) and (-webkit-device-pixel-ratio:3) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_2208x1242.png"><link rel="apple-touch-startup-image" media="screen and (device-width:375px) and (device-height:667px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_1334x750.png"><link rel="apple-touch-startup-image" media="screen and (device-width:375px) and (device-height:667px) and (-webkit-device-pixel-ratio:2) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_750x1334.png"><link rel="apple-touch-startup-image" media="screen and (device-width:1024px) and (device-height:1366px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_2732x2048.png"><meta name="description" content="This chapter covers JavaScript functions. Functions are a fundamental building block for JavaScript programs and a common feature in almost all programming languages. You may already be familiar wi">
<meta property="og:type" content="article">
<meta property="og:title" content="ç¬¬8ç«  å‡½æ•°">
<meta property="og:url" content="http://www.houyanbin.com/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch8/index.html">
<meta property="og:site_name" content="Jackhou Blog">
<meta property="og:description" content="This chapter covers JavaScript functions. Functions are a fundamental building block for JavaScript programs and a common feature in almost all programming languages. You may already be familiar wi">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover8.jpg">
<meta property="article:published_time" content="2023-04-25T16:00:53.000Z">
<meta property="article:modified_time" content="2023-04-26T13:44:33.842Z">
<meta property="article:author" content="Jack hou">
<meta property="article:tag" content="ã€ŠJavaScriptæƒå¨æŒ‡å—ã€‹">
<meta property="article:tag" content="JavaScript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover8.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.houyanbin.com/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch8/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://npm.elemecdn.com/@fortawesome/fontawesome-free@6.3.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/@fancyapps/ui@4.0.31/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  navMusic: true,
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#3b70fc","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://npm.elemecdn.com/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://npm.elemecdn.com/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ç¬¬8ç«  å‡½æ•°',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-26 21:44:33'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><div class="back-home-button" tabindex="-1"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">ç½‘é¡µ</div><div class="back-menu-list"><a class="back-menu-item" href="https://www.houyanbin.com/" title="åšå®¢" target="_blank"><img class="back-menu-item-icon" src="/img/favicon.png"/><span class="back-menu-item-text">åšå®¢</span></a></div></div></div></div><a id="site-name" href="/"><div class="title">Jackhou Blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><center id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></center></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> æ–‡ç« </span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> éš§é“</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> å‹é“¾</span></a><ul class="menus_item_child" style="left:-31px;"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> å‹äººå¸</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> ç•™è¨€æ¿</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> æˆ‘çš„</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=8868465080&amp;server=tencent&amp;type=0"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> éŸ³ä¹é¦†</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> è¿½ç•ªé¡µ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> ç›¸å†Œé›†</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> å…³äº</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> å…³äºæœ¬äºº</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> é—²è¨€ç¢è¯­</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> éšä¾¿é€›é€›</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" style="display: flex"><a class="site-page" onclick="anzhiyu.totraveling()" title="éšæœºå‰å¾€ä¸€ä¸ªå¼€å¾€é¡¹ç›®ç½‘ç«™" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="éšæœºå‰å¾€ä¸€ä¸ªæ–‡ç« " href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="æœç´¢ğŸ”"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> æœç´¢</span></a></div><div class="nav-button" id="darkmode_navswitch"><a class="darkmode_switchbutton" type="button" href="javascript:void(0);" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢" onclick="rm.switchDarkMode()"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke" style="font-size: 1.3rem"></i></a></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ç¬¬8ç«  å‡½æ•°</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-04-25T16:00:53.000Z" title="å‘è¡¨äº 2023-04-26 00:00:53">2023-04-26</time><span class="post-meta-separator">|</span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-04-26T13:44:33.842Z" title="æ›´æ–°äº 2023-04-26 21:44:33">2023-04-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/JavaScript/">JavaScript</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ç¬¬8ç«  å‡½æ•°"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover8.jpg"></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><meta name="referrer" content="no-referrer"/>


<p>This chapter covers JavaScript functions. Functions are a fundamental building block for JavaScript programs and a common feature in almost all programming languages. You may already be familiar with the concept of a function under a name such as subroutine or procedure.</p>
<blockquote>
<p>æœ¬ç« ä»‹ç»äº† JavaScript å‡½æ•°ã€‚å‡½æ•°æ˜¯ JavaScript ç¨‹åºçš„åŸºæœ¬æ„å»ºå—ï¼Œä¹Ÿæ˜¯å‡ ä¹æ‰€æœ‰ç¼–ç¨‹è¯­è¨€çš„å…±åŒç‰¹æ€§ã€‚ä½ å¯èƒ½å·²ç»äº†è§£å‡½æ•°çš„æ¦‚å¿µï¼Œå¦‚å­ä¾‹ç¨‹æˆ–è¿‡ç¨‹ã€‚</p>
</blockquote>
<p>A function is a block of JavaScript code that is defined once but may be executed, or invoked, any number of times. JavaScript functions are parameterized: a function definition may include a list of identifiers, known as parameters, that work as local variables for the body of the function. Function invocations provide values, or arguments, for the functionâ€™s parameters. Functions often use their argument values to compute a return value that becomes the value of the function-invocation expression. In addition to the arguments, each invocation has another valueâ€”the invocation contextâ€”that is the value of the this keyword.</p>
<blockquote>
<p>å‡½æ•°æ˜¯ä¸€ä¸ª JavaScript ä»£ç å—ï¼Œåªå®šä¹‰ä¸€æ¬¡ï¼Œä½†å¯ä»¥æ‰§è¡Œæˆ–è°ƒç”¨ä»»æ„æ¬¡æ•°ã€‚JavaScript å‡½æ•°æ˜¯å‚æ•°åŒ–çš„ï¼šä¸€ä¸ªå‡½æ•°å®šä¹‰å¯ä»¥åŒ…å«ä¸€ä¸ªæ ‡è¯†ç¬¦åˆ—è¡¨ï¼Œç§°ä¸ºå‚æ•°ï¼Œä½œä¸ºå‡½æ•°ä½“çš„å±€éƒ¨å˜é‡ã€‚å‡½æ•°è°ƒç”¨ä¸ºå‡½æ•°çš„å‚æ•°æä¾›å€¼æˆ–å®å‚ã€‚å‡½æ•°é€šå¸¸ä½¿ç”¨å®ƒä»¬çš„å®å‚å€¼æ¥è®¡ç®—ä¸€ä¸ªè¿”å›å€¼ï¼Œè¯¥è¿”å›å€¼æˆä¸ºå‡½æ•°è°ƒç”¨è¡¨è¾¾å¼çš„å€¼ã€‚é™¤äº†å‚æ•°ä¹‹å¤–ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½æœ‰å¦ä¸€ä¸ªå€¼â€”â€”è°ƒç”¨ä¸Šä¸‹æ–‡â€”â€”å³ this å…³é”®å­—çš„å€¼ã€‚</p>
</blockquote>
<p>If a function is assigned to a property of an object, it is known as a method of that object. When a function is invoked on or through an object, that object is the invocation context or this value for the function. Functions designed to initialize a newly created object are called constructors. Constructors were described in Â§6.2 and will be covered again in Chapter 9.</p>
<blockquote>
<p>å¦‚æœå‡½æ•°æŒ‚è½½åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šä½œä¸ºå…¶å±æ€§ï¼Œå®ƒå°±è¢«ç§°ä¸ºæ–¹æ³•ã€‚å½“è¯¥æ–¹æ³•åœ¨å¯¹è±¡ä¸­è¢«è°ƒç”¨æˆ–é€šè¿‡å¯¹è±¡è°ƒç”¨æ—¶ï¼Œè¯¥å¯¹è±¡å°±æ˜¯è¯¥æ–¹æ³•å‡½æ•°çš„è°ƒç”¨ä¸Šä¸‹æ–‡æˆ– this å€¼ã€‚ç”¨äºåˆå§‹åŒ–æ–°åˆ›å»ºçš„å¯¹è±¡çš„å‡½æ•°ç§°ä¸ºæ„é€ å‡½æ•°ã€‚æ„é€ å‡½æ•°åœ¨ Â§6.2 ä¸­æœ‰ä»‹ç»ï¼Œæˆ‘ä»¬å°†åœ¨ç¬¬ 9 ç« ä¸­å†æ¬¡è°ˆåˆ°å®ƒã€‚</p>
</blockquote>
<p>In JavaScript, functions are objects, and they can be manipulated by programs. JavaScript can assign functions to variables and pass them to other functions, for example. Since functions are objects, you can set properties on them and even invoke methods on them.</p>
<blockquote>
<p>åœ¨ JavaScript ä¸­ï¼Œå‡½æ•°æ˜¯å¯¹è±¡ï¼Œå®ƒä»¬å¯ä»¥è¢«ç¨‹åºæ“ä½œã€‚ä¾‹å¦‚ï¼ŒJavaScript å¯ä»¥å°†å‡½æ•°èµ‹ç»™å˜é‡ï¼Œå¹¶å°†å®ƒä»¬ä¼ é€’ç»™å…¶ä»–å‡½æ•°ã€‚ç”±äºå‡½æ•°æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥ç»™å®ƒä»¬è®¾ç½®å±æ€§ï¼Œç”šè‡³è°ƒç”¨å®ƒä»¬çš„æ–¹æ³•ã€‚</p>
</blockquote>
<p>JavaScript function definitions can be nested within other functions, and they have access to any variables that are in scope where they are defined. This means that JavaScript functions are closures, and it enables important and powerful programming techniques.</p>
<blockquote>
<p>JavaScript å‡½æ•°å¯ä»¥åµŒå¥—åœ¨å…¶ä»–å‡½æ•°ä¸­å®šä¹‰ï¼Œå¹¶ä¸”å®ƒä»¬å¯ä»¥è®¿é—®å®šä¹‰å®ƒä»¬æ‰€å¤„çš„ä½œç”¨åŸŸå†…ä»»ä½•å˜é‡ã€‚è¿™æ„å‘³ç€ JavaScript å‡½æ•°æ˜¯é—­åŒ…ï¼Œæ”¯æŒé—­åŒ…æ˜¯éå¸¸é‡è¦çš„ï¼Œå®ƒæ˜¯éå¸¸å¼ºå¤§çš„ç¼–ç¨‹æŠ€å·§ã€‚</p>
</blockquote>
<h2 id="8-1-Defining-Functions"><a href="#8-1-Defining-Functions" class="headerlink" title="8.1 Defining Functions"></a>8.1 Defining Functions</h2><p>The most straightforward way to define a JavaScript function is with the function keyword, which can be used as a declaration or as an expression. ES6 defines an important new way to define functions without the function keyword: â€œarrow functionsâ€ have a particularly compact syntax and are useful when passing one function as an argument to another function. The subsections that follow cover these three ways of defining functions. Note that some details of function definition syntax involving function parameters are deferred to Â§8.3.</p>
<blockquote>
<p>å®šä¹‰ JavaScript å‡½æ•°æœ€ç›´æ¥çš„æ–¹æ³•æ˜¯ä½¿ç”¨ function å…³é”®å­—ï¼Œå®ƒæ—¢å¯ä»¥ç”¨ä½œå£°æ˜åˆå¯ä»¥ç”¨ä½œè¡¨è¾¾å¼ã€‚ES6 å®šä¹‰äº†ä¸€ç§ä¸ä½¿ç”¨ function å…³é”®å­—çš„é‡è¦æ–°æ–¹æ³•æ¥å®šä¹‰çš„å‡½æ•°ï¼šâ€œç®­å¤´å‡½æ•°â€ï¼Œå®ƒå…·æœ‰ç‰¹åˆ«ç®€æ´è¯­æ³•ï¼Œå¹¶ä¸”åœ¨å°†ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°çš„åœºæ™¯ä¸­éå¸¸å®ç”¨ã€‚æ¥ä¸‹æ¥çš„å°èŠ‚å°†ä»‹ç»è¿™ä¸‰ç§å®šä¹‰å‡½æ•°çš„æ–¹æ³•ã€‚æ³¨æ„ï¼Œå…³äºå‡½æ•°å®šä¹‰è¯­æ³•åŒ…å«çš„å‡½æ•°å‚æ•°ç›¸å…³å†…å®¹å°†åœ¨ Â§8.3 ä¸­ä»‹ç»ã€‚</p>
</blockquote>
<p>In object literals and class definitions, there is a convenient shorthand syntax for defining methods. This shorthand syntax was covered in Â§6.10.5 and is equivalent to using a function definition expression and assigning it to an object property using the basic name:value object literal syntax. In another special case, you can use keywords get and set in object literals to define special property getter and setter methods. This function definition syntax was covered in Â§6.10.6.</p>
<blockquote>
<p>åœ¨å¯¹è±¡å­—é¢é‡å’Œç±»å®šä¹‰ä¸­ï¼Œæœ‰ä¸€ç§æ–¹ä¾¿çš„å¿«æ·è¯­æ³•æ¥å®šä¹‰æ–¹æ³•ã€‚è¿™ç§ç®€å†™è¯­æ³•åœ¨ Â§6.10.5 ä¸­æœ‰ä»‹ç»ï¼Œç›¸å½“äºé€šè¿‡å¯¹è±¡å­—é¢é‡è¯­æ³•å°†å‡½æ•°å®šä¹‰è¡¨è¾¾å¼ç”¨æœ€åŸºæœ¬çš„å±æ€§åï¼šå±æ€§å€¼çš„æ–¹å¼èµ‹å€¼ç»™å¯¹è±¡çš„å±æ€§ã€‚åœ¨å¦ä¸€ç§ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨å¯¹è±¡å­—é¢é‡ä¸­ä½¿ç”¨å…³é”®å­— get å’Œ set æ¥å®šä¹‰ç‰¹æ®Šçš„å±æ€§ getter å’Œ setter æ–¹æ³•ã€‚è¿™ä¸ªå‡½æ•°å®šä¹‰è¯­æ³•åœ¨ Â§6.10.6 ä¸­ä»‹ç»è¿‡ã€‚</p>
</blockquote>
<p>Note that functions can also be defined with the Function() constructor, which is the subject of Â§8.7.7. Also, JavaScript defines some specialized kinds of functions. function* defines generator functions (see Chapter 12) and async function defines asynchronous functions (see Chapter 13).</p>
<blockquote>
<p>æ³¨æ„ï¼Œå‡½æ•°ä¹Ÿå¯ä»¥ç”¨ Function() æ„é€ å‡½æ•°æ¥å®šä¹‰ï¼Œè¿™æ˜¯ Â§8.7.7 çš„ä¸»é¢˜ã€‚æ­¤å¤–ï¼ŒJavaScript è¿˜å®šä¹‰äº†ä¸€äº›ç‰¹æ®Šç±»å‹çš„å‡½æ•°ã€‚function* å®šä¹‰å‡½æ•°ç”Ÿæˆå™¨ï¼ˆè§ç¬¬ 12 ç« ï¼‰å’Œ async function å®šä¹‰å¼‚æ­¥å‡½æ•°ï¼ˆè§ç¬¬ 13 ç« ï¼‰ã€‚</p>
</blockquote>
<h3 id="8-1-1-Function-Declarations"><a href="#8-1-1-Function-Declarations" class="headerlink" title="8.1.1 Function Declarations"></a>8.1.1 Function Declarations</h3><p>Function declarations consist of the function keyword, followed by these components:</p>
<ul>
<li>An identifier that names the function. The name is a required part of function declarations: it is used as the name of a variable, and the newly defined function object is assigned to the variable.</li>
<li>A pair of parentheses around a comma-separated list of zero or more identifiers. These identifiers are the parameter names for the function, and they behave like local variables within the body of the function.</li>
<li>A pair of curly braces with zero or more JavaScript statements inside. These statements are the body of the function: they are executed whenever the function is invoked.</li>
</ul>
<hr>
<p>å‡½æ•°å£°æ˜ç”± function å…³é”®å­—ç»„æˆï¼Œåé¢è·Ÿç€è¿™äº›ç»„ä»¶:</p>
<ul>
<li>å‡½æ•°åç§°æ ‡è¯†ç¬¦ã€‚åç§°æ˜¯å‡½æ•°å£°æ˜çš„å¿…è¦éƒ¨åˆ†:å®ƒç”¨ä½œå˜é‡çš„åç§°ï¼Œå¹¶å°†æ–°å®šä¹‰çš„å‡½æ•°å¯¹è±¡èµ‹å€¼ç»™è¯¥å˜é‡ã€‚</li>
<li>ä¸€å¯¹åœ†æ‹¬å·ï¼Œå…¶ä¸­åŒ…å«ç”±0ä¸ªæˆ–è€…å¤šä¸ªç”¨é€—å·åˆ†éš”çš„æ ‡è¯†ç¬¦ç»„æˆçš„åˆ—è¡¨ã€‚è¿™äº›æ ‡è¯†ç¬¦æ˜¯å‡½æ•°çš„å‚æ•°åï¼Œå®ƒä»¬çš„è¡Œä¸ºç±»ä¼¼äºå‡½æ•°ä½“ä¸­çš„å±€éƒ¨å˜é‡ã€‚</li>
<li>ä¸€å¯¹èŠ±æ‹¬å·ï¼Œå…¶ä¸­åŒ…å«ç”±0æ¡æˆ–è€…å¤šæ¡ JavaScript è¯­å¥ã€‚è¿™äº›è¯­å¥æ„æˆäº†å‡½æ•°ä½“ï¼šæ¯å½“å‡½æ•°è°ƒç”¨æ—¶ï¼Œå°±ä¼šæ‰§è¡Œè¿™äº›è¯­å¥ã€‚</li>
</ul>
<p>Here are some example function declarations:</p>
<blockquote>
<p>ä¸‹é¢æ˜¯ä¸€äº›å‡½æ•°å£°æ˜çš„ä¾‹å­:</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Print the name and value of each property of o.  Return undefined.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">printprops</span>(<span class="params">o</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> p <span class="keyword">in</span> o) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;p&#125;</span>: <span class="subst">$&#123;o[p]&#125;</span>\n`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Compute the distance between Cartesian points (x1,y1) and (x2,y2).</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">distance</span>(<span class="params">x1, y1, x2, y2</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> dx = x2 - x1;</span><br><span class="line">    <span class="keyword">let</span> dy = y2 - y1;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(dx*dx + dy*dy);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// A recursive function (one that calls itself) that computes factorials</span></span><br><span class="line"><span class="comment">// Recall that x! is the product of x and all positive integers less than it.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">factorial</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> x * <span class="title function_">factorial</span>(x-<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>One of the important things to understand about function declarations is that the name of the function becomes a variable whose value is the function itself. Function declaration statements are â€œhoistedâ€ to the top of the enclosing script, function, or block so that functions defined in this way may be invoked from code that appears before the definition. Another way to say this is that all of the functions declared in a block of JavaScript code will be defined throughout that block, and they will be defined before the JavaScript interpreter begins to execute any of the code in that block.</p>
<blockquote>
<p>é‡ä¸­ä¹‹é‡è¦ç†è§£å‡½æ•°å£°æ˜æ˜¯å‡½æ•°åå˜æˆä¸€ä¸ªå˜é‡ï¼Œè¿™ä¸ªå˜é‡çš„å€¼æ˜¯å‡½æ•°æœ¬èº«ã€‚å‡½æ•°å£°æ˜è¯­å¥â€œè¢«æå‰â€åˆ°è„šæœ¬ã€å‡½æ•°ã€å—ä¹‹å‰ï¼Œå› æ­¤è¿™ç§æ–¹å¼å®šä¹‰çš„å‡½æ•°å¯ä»¥åœ¨å®ƒå®šä¹‰ä¹‹å‰è¢«è°ƒç”¨ã€‚å¦ä¸€ç§è¯´æ³•æ˜¯æ‰€æœ‰å£°æ˜åœ¨ Javascript ä»£ç å—ä¸­çš„å‡½æ•°ï¼Œåœ¨å—å†…å§‹ç»ˆæ˜¯æœ‰å®šä¹‰çš„ï¼Œå®ƒä»¬å®šä¹‰åœ¨ JavaScript è§£é‡Šå™¨å¼€å§‹è§£é‡Šæ‰§è¡Œå—å†…ä»»ä½•è¯­å¥ä¹‹å‰ã€‚</p>
</blockquote>
<p>The distance() and factorial() functions weâ€™ve described are designed to compute a value, and they use return to return that value to their caller. The return statement causes the function to stop executing and to return the value of its expression (if any) to the caller. If the return statement does not have an associated expression, the return value of the function is undefined.</p>
<blockquote>
<p>distance() å’Œ factorial() å‡½æ•°è®¡ç®—ä¸€ä¸ªå€¼ï¼Œå®ƒä»¬ç”¨ retrun æ¥å°†è¿™ä¸ªå€¼è¿”å›ç»™è°ƒç”¨è€…ã€‚return è¯­å¥å¯¼è‡´å‡½æ•°åœæ­¢æ‰§è¡Œï¼Œå¹¶è¿”å›å®ƒçš„è¡¨è¾¾å¼çš„å€¼ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ç»™è°ƒç”¨è€…ã€‚å¦‚æœ return è¯­å¥æ²¡æœ‰ä¸€ä¸ªä¸ä¹‹ç›¸å…³çš„è¡¨è¾¾å¼ï¼Œåˆ™å‡½æ•°è¿”å› undefined å€¼ã€‚</p>
</blockquote>
<p>The printprops() function is different: its job is to output the names and values of an objectâ€™s properties. No return value is necessary, and the function does not include a return statement. The value of an invocation of the printprops() function is always undefined. If a function does not contain a return statement, it simply executes each statement in the function body until it reaches the end, and returns the undefined value to the caller.</p>
<blockquote>
<p>printprops() å‡½æ•°ä¸åŒï¼šå®ƒè´Ÿè´£è¾“å‡ºå¯¹è±¡å±æ€§çš„åç§°å’Œå€¼ã€‚æ²¡æœ‰è¿”å›å€¼çš„å¿…è¦ï¼Œå¹¶ä¸”è¯¥å‡½æ•°ä¹Ÿä¸åŒ…å«ä¸€ä¸ª return è¯­å¥ã€‚ è°ƒç”¨ printprops() å‡½æ•°çš„è¿”å›å€¼æ°¸è¿œæ˜¯ undefinedã€‚å¦‚æœä¸€ä¸ªå‡½æ•°ä¸åŒ…å«ä¸€ä¸ª return è¯­å¥ï¼Œå®ƒä»…ä»…æ‰§è¡Œå‡½æ•°ä½“å†…æ¯ä¸€æ¡è¯­å¥ç›´åˆ°ç»“æŸï¼Œå¹¶è¿”å› undefined ç»™è°ƒç”¨è€…ã€‚</p>
</blockquote>
<p>Prior to ES6, function declarations were only allowed at the top level within a JavaScript file or within another function. While some implementations bent the rule, it was not technically legal to define functions inside the body of loops, conditionals, or other blocks. In the strict mode of ES6, however, function declarations are allowed within blocks. A function defined within a block only exists within that block, however, and is not visible outside the block.</p>
<blockquote>
<p>åœ¨ ES6 ä¹‹å‰ï¼Œå‡½æ•°åªå…è®¸åœ¨ JavaScript æ–‡ä»¶é¡¶å±‚æˆ–è€…å…¶ä»–å‡½æ•°ä¸­å£°æ˜ã€‚ç„¶è€Œä¸€äº›å®ç°è¿åè§„çº¦ï¼Œåœ¨å¾ªç¯ä½“æ¡ä»¶ä½“æˆ–è€…å…¶ä»–å—ä¸­å®šä¹‰å‡½æ•°ã€‚åœ¨ ES6 çš„ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå‡½æ•°å…è®¸åœ¨å—å†…è¿›è¡Œå£°æ˜ã€‚ä¸€ä¸ªå®šä¹‰åœ¨å—å†…çš„å‡½æ•°åªå­˜åœ¨äºè¯¥å—å†…ï¼Œå—å¤–æ˜¯ä¸å¯è§çš„ã€‚</p>
</blockquote>
<h3 id="8-1-2-Function-Expressions"><a href="#8-1-2-Function-Expressions" class="headerlink" title="8.1.2 Function Expressions"></a>8.1.2 Function Expressions</h3><p>Function expressions look a lot like function declarations, but they appear within the context of a larger expression or statement, and the name is optional.</p>
<blockquote>
<p>å‡½æ•°è¡¨è¾¾å¼çœ‹èµ·æ¥å¾ˆåƒå‡½æ•°å£°æ˜ï¼Œä½†æ˜¯å®ƒå‡ºç°åœ¨ä¸€ä¸ªå®ƒçš„ä¸Šå±‚è¡¨è¾¾å¼æˆ–è¯­å¥çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå¹¶ä¸”å‡½æ•°åç§°æ˜¯å¯é€‰é¡¹ã€‚</p>
</blockquote>
<p> Here are some example function expressions:</p>
<blockquote>
<p>ä¸‹é¢æ˜¯ä¸€äº›å‡½æ•°è¡¨è¾¾å¼çš„ä¾‹å­ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This function expression defines a function that squares its argument.</span></span><br><span class="line"><span class="comment">// Note that we assign it to a variable</span></span><br><span class="line"><span class="keyword">const</span> square = <span class="keyword">function</span>(<span class="params">x</span>) &#123; <span class="keyword">return</span> x*x; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Function expressions can include names, which is useful for recursion.</span></span><br><span class="line"><span class="keyword">const</span> f = <span class="keyword">function</span> <span class="title function_">fact</span>(<span class="params">x</span>) &#123; <span class="keyword">if</span> (x &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> x*<span class="title function_">fact</span>(x-<span class="number">1</span>); &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Function expressions can also be used as arguments to other functions:</span></span><br><span class="line">[<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>].<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">a,b</span>) &#123; <span class="keyword">return</span> a-b; &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Function expressions are sometimes defined and immediately invoked:</span></span><br><span class="line"><span class="keyword">let</span> tensquared = (<span class="keyword">function</span>(<span class="params">x</span>) &#123;<span class="keyword">return</span> x*x;&#125;(<span class="number">10</span>));</span><br></pre></td></tr></table></figure>

<p>Note that the function name is optional for functions defined as expressions, and most of the preceding function expressions weâ€™ve shown omit it. A function declaration actually declares a variable and assigns a function object to it. A function expression, on the other hand, does not declare a variable: it is up to you to assign the newly defined function object to a constant or variable if you are going to need to refer to it multiple times. It is a good practice to use const with function expressions so you donâ€™t accidentally overwrite your functions by assigning new values.</p>
<blockquote>
<p>æ³¨æ„å‡½æ•°åç§°åœ¨å‡½æ•°è¡¨è¾¾å¼ä¸­æ˜¯å¯é€‰é¡¹ï¼Œåœ¨å¤§éƒ¨åˆ†å‡½æ•°è¡¨è¾¾å¼ä¸­æˆ‘ä»¬çœç•¥äº†å®ƒã€‚å‡½æ•°å£°æ˜å®é™…ä¸Šå£°æ˜äº†ä¸€ä¸ªå˜é‡å¹¶ä¸”å°†å‡½æ•°å¯¹è±¡èµ‹å€¼ç»™å®ƒã€‚æŒ‰ç…§è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œå‡½æ•°è¡¨è¾¾å¼æ²¡æœ‰å£°æ˜ä¸€ä¸ªå˜é‡ï¼šå¯ä»¥æ ¹æ®å®ƒæ˜¯å¦ä¼šå¤šæ¬¡è°ƒç”¨ç”±ä½ è‡ªå·±å†³å®šæ˜¯å°†æ–°å®šä¹‰çš„å‡½æ•°å¯¹è±¡èµ‹å€¼ç»™ä¸€ä¸ªå¸¸é‡è¿˜æ˜¯å˜é‡ã€‚ç”¨ const å®šä¹‰å‡½æ•°è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„åšæ³•ï¼Œä½ ä¸ä¼šå› ä¸ºæ„å¤–èµ‹å€¼è€Œé‡å†™äº†ä½ çš„å‡½æ•°ã€‚</p>
</blockquote>
<p>A name is allowed for functions, like the factorial function, that need to refer to themselves. If a function expression includes a name, the local function scope for that function will include a binding of that name to the function object. In effect, the function name becomes a local variable within the function. Most functions defined as expressions do not need names, which makes their definition more compact (though not nearly as compact as arrow functions, described below).</p>
<blockquote>
<p>å¯ä»¥ç»™å‡½æ•°ä¸€ä¸ªåç§°ï¼Œå°±åƒ factorial å‡½æ•°ï¼Œå®ƒéœ€è¦è°ƒç”¨å®ƒè‡ªå·±ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°è¡¨è¾¾å¼åŒ…å«ä¸€ä¸ªåç§°ï¼Œé‚£è¿™ä¸ªå‡½æ•°çš„å±€éƒ¨å‡½æ•°ä½œç”¨åŸŸå†…ä¼šåŒ…å«ä¸€ä¸ªå±æ€§åä¸ºè¯¥å‡½æ•°åçš„å¯¹è±¡ï¼Œå…¶å€¼ç»‘å®šçš„æ˜¯è¯¥å‡½æ•°ã€‚å®é™…ä¸Šï¼Œå‡½æ•°åå˜æˆè¿™ä¸ªå‡½æ•°çš„ä¸€ä¸ªå±€éƒ¨å˜é‡ã€‚å¤§å¤šæ•°å‡½æ•°è¡¨è¾¾å¼ä¸éœ€è¦å‡½æ•°åç§°ï¼Œè¿™è®©å®ƒä»¬çš„å®šä¹‰æ›´ç®€æ´ï¼ˆä½†æ˜¯å¹¶æ²¡æœ‰ä¸‹é¢è¦è®²çš„ç®­å¤´å‡½æ•°ç®€æ´ï¼‰ã€‚</p>
</blockquote>
<p>There is an important difference between defining a function f() with a function declaration and assigning a function to the variable f after creating it as an expression. When you use the declaration form, the function objects are created before the code that contains them starts to run, and the definitions are hoisted so that you can call these functions from code that appears above the definition statement. This is not true for functions defined as expressions, however: these functions do not exist until the expression that defines them are actually evaluated. Furthermore, in order to invoke a function, you must be able to refer to it, and you canâ€™t refer to a function defined as an expression until it is assigned to a variable, so functions defined with expressions cannot be invoked before they are defined.</p>
<blockquote>
<p>åœ¨å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼ä¹‹é—´æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„ä¸åŒã€‚å½“ä½ ç”¨å‡½æ•°å£°æ˜ï¼Œè¯¥å‡½æ•°å¯¹è±¡åˆ›å»ºäºè¯¥å‡½æ•°æ‰€åœ¨ä½œç”¨åŸŸçš„ä»£ç å¼€å§‹æ‰§è¡Œä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯å£°æ˜æå‰ï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨å‡½æ•°å®šä¹‰ä¹‹å‰è°ƒç”¨ä»–ä»¬ã€‚å¦‚æœç”¨å‡½æ•°è¡¨è¾¾å¼æ¥å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¿™æ ·ä½¿ç”¨å°±æ˜¯ä¸å¯¹çš„ï¼šè¯¥å‡½æ•°ä¸ä¼šå­˜åœ¨ï¼Œç›´åˆ°å‡½æ•°å®šä¹‰è¡¨è¾¾å¼çœŸæ­£è¢«è®¡ç®—ã€‚å› ä¸ºï¼Œæƒ³è¦æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œä½ å¿…é¡»å¯ä»¥å¼•ç”¨å®ƒï¼Œè€Œä¸€ä¸ªå‡½æ•°è¡¨è¾¾å¼å®šä¹‰çš„å‡½æ•°ä¸€ç›´åˆ°è¯¥å‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡åæ‰èƒ½è¢«å¼•ç”¨ï¼Œæ‰€ä»¥è¦ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼éœ€è¦åœ¨å‡½æ•°è¢«è°ƒç”¨ä¹‹å‰å®šä¹‰ã€‚</p>
</blockquote>
<h3 id="8-1-3-Arrow-Functions"><a href="#8-1-3-Arrow-Functions" class="headerlink" title="8.1.3 Arrow Functions"></a>8.1.3 Arrow Functions</h3><p>In ES6, you can define functions using a particularly compact syntax known as â€œarrow functions.â€ This syntax is reminiscent of mathematical notation and uses an &#x3D;&gt; â€œarrowâ€ to separate the function parameters from the function body. The function keyword is not used, and, since arrow functions are expressions instead of statements, there is no need for a function name, either. The general form of an arrow function is a comma-separated list of parameters in parentheses, followed by the &#x3D;&gt; arrow, followed by the function body in curly braces:</p>
<blockquote>
<p>åœ¨ ES6 ä¹‹åï¼Œä½ å¯ä»¥ç”¨ä¸€ä¸ªç‰¹åˆ«ç®€æ´çš„è¯­æ³•æ¥å®šä¹‰å‡½æ•°ï¼Œè¢«ç§°ä¸ºâ€œç®­å¤´å‡½æ•°â€ã€‚è¿™ä¸ªè¯­æ³•è”æƒ³åˆ°æ•°å­¦ç¬¦å·ï¼Œç”¨ä¸€ä¸ª &#x3D;&gt; â€œç®­å¤´â€æ¥åˆ†éš”å‡½æ•°çš„å‚æ•°å’Œå‡½æ•°ä½“ã€‚function å…³é”®å­—æœªä½¿ç”¨ï¼Œå¹¶ä¸”ï¼Œç”±äºç®­å¤´å‡½æ•°æ˜¯è¡¨è¾¾å¼è€Œä¸æ˜¯å£°æ˜è¯­å¥ï¼Œä¹Ÿä¸éœ€è¦ä¸€ä¸ªå‡½æ•°åç§°ã€‚ä¸€èˆ¬ç®­å¤´å‡½æ•°ç”¨åœ†æ‹¬å·åŒ…å«ä¸€ä¸ªé€—å·åˆ†éš”çš„å‚æ•°åˆ—è¡¨ï¼Œæ¥ä¸€ä¸ª &#x3D;&gt; ç®­å¤´ï¼Œåé¢æ˜¯èŠ±æ‹¬å·åŒ…å«çš„å‡½æ•°ä½“ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">sum</span> = (<span class="params">x, y</span>) =&gt; &#123; <span class="keyword">return</span> x + y; &#125;;</span><br></pre></td></tr></table></figure>

<p>But arrow functions support an even more compact syntax. If the body of the function is a single return statement, you can omit the return keyword, the semicolon that goes with it, and the curly braces, and write the body of the function as the expression whose value is to be returned:</p>
<blockquote>
<p>ä½†æ˜¯ç®­å¤´å‡½æ•°æ”¯æŒæ›´åŠ ç®€æ´çš„è¯­æ³•ã€‚å¦‚æœå‡½æ•°ä½“åªæœ‰ä¸€ä¸ªç®€å•çš„ return è¯­å¥ï¼Œä½ å¯ä»¥çœç•¥ return å…³é”®å­—ï¼Œåˆ†å·å’ŒèŠ±æ‹¬å·éƒ½ä¸€èµ·çœç•¥ï¼Œå°†å‡½æ•°ä½“å†™æˆä¸€ä¸ªè®¡ç®—è¿”å›å€¼çš„è¡¨è¾¾å¼ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">sum</span> = (<span class="params">x, y</span>) =&gt; x + y;</span><br></pre></td></tr></table></figure>

<p>Furthermore, if an arrow function has exactly one parameter, you can omit the parentheses around the parameter list:</p>
<blockquote>
<p>è€Œä¸”ï¼Œå¦‚æœä¸€ä¸ªç®­å¤´å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä½ å¯ä»¥çœç•¥å‚æ•°åˆ—è¡¨çš„åœ†æ‹¬å·ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">polynomial</span> = x =&gt; x*x + <span class="number">2</span>*x + <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<p>Note, however, that an arrow function with no arguments at all must be written with an empty pair of parentheses:</p>
<blockquote>
<p>æ³¨æ„ï¼Œå¦‚æœç®­å¤´å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œå¿…é¡»å†™ä¸€å¯¹ç©ºåœ†æ‹¬å·ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">constantFunc</span> = (<span class="params"></span>) =&gt; <span class="number">42</span>;</span><br></pre></td></tr></table></figure>

<p>Note that, when writing an arrow function, you must not put a new line between the function parameters and the &#x3D;&gt; arrow. Otherwise, you could end up with a line like const polynomial &#x3D; x, which is a syntactically valid assignment statement on its own.</p>
<blockquote>
<p>æ³¨æ„ï¼Œå½“å†™ä¸€ä¸ªç®­å¤´å‡½æ•°æ—¶ï¼Œå‡½æ•°å‚æ•°å’Œç®­å¤´ä¹‹é—´ä¸èƒ½æ¢è¡Œã€‚å¦åˆ™ï¼Œå¯èƒ½ä¼šç›´æ¥åœ¨èµ‹å€¼åä¸­æ­¢ï¼Œå°±åƒ const polynomial &#x3D; xï¼Œå› ä¸ºå®ƒæœ¬èº«æ˜¯ä¸€ä¸ªè¯­æ³•ä¸Šåˆæ³•çš„èµ‹å€¼è¯­å¥ã€‚</p>
</blockquote>
<p>Also, if the body of your arrow function is a single return statement but the expression to be returned is an object literal, then you have to put the object literal inside parentheses to avoid syntactic ambiguity between the curly braces of a function body and the curly braces of an object literal:</p>
<blockquote>
<p>æ­¤å¤–ï¼Œå¦‚æœç®­å¤´å‡½æ•°ä½“æ˜¯ä¸€ä¸ªå•ä¸€çš„ return è¯­å¥ï¼Œè€Œä¸”ä»–è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡å­—é¢é‡ï¼Œé‚£å¿…é¡»å°†å¯¹è±¡å­—é¢é‡ç”¨åœ†æ‹¬å·åŒ…èµ·æ¥ï¼Œé¿å…å°†å¯¹è±¡å­—é¢é‡çš„å¤§æ‹¬å·è¯¯è§£æˆå‡½æ•°ä½“çš„å¤§æ‹¬å·ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">f</span> = x =&gt; &#123; <span class="keyword">return</span> &#123; <span class="attr">value</span>: x &#125;; &#125;;  <span class="comment">// Good: f() returns an object</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">g</span> = x =&gt; (&#123; <span class="attr">value</span>: x &#125;);            <span class="comment">// Good: g() returns an object</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">h</span> = x =&gt; &#123; <span class="attr">value</span>: x &#125;;              <span class="comment">// Bad: h() returns nothing</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">i</span> = x =&gt; &#123; <span class="attr">v</span>: x, <span class="attr">w</span>: x &#125;;            <span class="comment">// Bad: Syntax Error</span></span><br></pre></td></tr></table></figure>

<p>In the third line of this code, the function h() is truly ambiguous: the code you intended as an object literal can be parsed as a labeled statement, so a function that returns undefined is created. On the fourth line, however, the more complicated object literal is not a valid statement, and this illegal code causes a syntax error.</p>
<blockquote>
<p>è¿™æ®µä»£ç çš„ç¬¬ä¸‰è¡Œï¼Œå‡½æ•° h() å°±æœ‰æ­§ä¹‰ï¼šè¿™æ®µä»£ç åŸæœ¬è¿”å›å¯¹è±¡å­—é¢é‡è¢«è½¬åŒ–ä¸ºä¸€ä¸ªæ ‡ç­¾è¯­å¥ï¼Œæ‰€ä»¥ä¸€ä¸ªè¿”å› undefined çš„å‡½æ•°è¢«åˆ›å»ºã€‚ç¬¬å››è¡Œï¼Œç»“æ„æ›´å¤æ‚çš„å¯¹è±¡å­—é¢é‡ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„è¯­å¥ï¼Œè¿™æ®µä»£ç ä¼šæŠ›å‡ºä¸€ä¸ªè¯­æ³•å¼‚å¸¸ã€‚</p>
</blockquote>
<p>The concise syntax of arrow functions makes them ideal when you need to pass one function to another function, which is a common thing to do with array methods like map(), filter(), and reduce() (see Â§7.8.1), for example:</p>
<blockquote>
<p>ç®€æ´çš„ç®­å¤´å‡½æ•°å¯ä»¥å®Œç¾çš„ä¼ é€’ä¸€ä¸ªå‡½æ•°ç»™å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œæ¯”å¦‚ä¸€äº›æ•°ç»„çš„å¸¸è§„æ“ä½œæ–¹æ³• map()ï¼Œfilter() å’Œ reduce()ï¼ˆè§ Â§7.8.1ï¼‰ï¼Œä¾‹å¦‚ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Make a copy of an array with null elements removed.</span></span><br><span class="line"><span class="keyword">let</span> filtered = [<span class="number">1</span>,<span class="literal">null</span>,<span class="number">2</span>,<span class="number">3</span>].<span class="title function_">filter</span>(<span class="function"><span class="params">x</span> =&gt;</span> x !== <span class="literal">null</span>); <span class="comment">// filtered == [1,2,3]</span></span><br><span class="line"><span class="comment">// Square some numbers:</span></span><br><span class="line"><span class="keyword">let</span> squares = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>].<span class="title function_">map</span>(<span class="function"><span class="params">x</span> =&gt;</span> x*x);               <span class="comment">// squares == [1,4,9,16]</span></span><br></pre></td></tr></table></figure>

<p>Arrow functions differ from functions defined in other ways in one critical way: they inherit the value of the this keyword from the environment in which they are defined rather than defining their own invocation context as functions defined in other ways do. This is an important and very useful feature of arrow functions, and weâ€™ll return to it again later in this chapter. Arrow functions also differ from other functions in that they do not have a prototype property, which means that they cannot be used as constructor functions for new classes (see Â§9.2).</p>
<blockquote>
<p>ç®­å¤´å‡½æ•°ä¸åŒäºç”¨å…³é”®å­—å®šä¹‰çš„å‡½æ•°ï¼šç®­å¤´å‡½æ•°ä»å®šä¹‰å®ƒä»¬çš„ç¯å¢ƒç»§æ‰¿ this å…³é”®å­—ï¼Œè€Œä¸æ˜¯åƒå…¶ä»–å®šä¹‰æ–¹å¼é‚£æ ·å®šä¹‰è‡ªå·±çš„è°ƒç”¨ä¸Šä¸‹æ–‡ã€‚è¿™æ˜¯ç®­å¤´å‡½æ•°ä¸€ä¸ªé‡è¦ä¸”ç‰¹åˆ«å®ç”¨çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™ä¸€ç« çš„åé¢å†æ¬¡æåˆ°å®ƒã€‚ç®­å¤´å‡½æ•°ä¹Ÿä¸åŒäºå…¶ä»–å‡½æ•°ï¼Œå®ƒä»¬æ²¡æœ‰æœ‰åŸå‹å±æ€§ã€‚è¿™æ„å‘³ç€å®ƒä¸èƒ½è¢«å½“ä½œä¸€ä¸ªæ„é€ å‡½æ•°å»åˆ›å»ºä¸€ä¸ªç±»ï¼ˆè§ Â§9.2ï¼‰ã€‚</p>
</blockquote>
<h3 id="8-1-4-Nested-Functions"><a href="#8-1-4-Nested-Functions" class="headerlink" title="8.1.4 Nested Functions"></a>8.1.4 Nested Functions</h3><p>In JavaScript, functions may be nested within other functions. For example:</p>
<blockquote>
<p>åœ¨ JavaScript ä¸­ï¼Œå‡½æ•°å¯ä»¥åµŒå¥—åœ¨å…¶ä»–å‡½æ•°å†…ã€‚ä¾‹å¦‚ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hypotenuse</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">square</span>(<span class="params">x</span>) &#123; <span class="keyword">return</span> x*x; &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(<span class="title function_">square</span>(a) + <span class="title function_">square</span>(b));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The interesting thing about nested functions is their variable scoping rules: they can access the parameters and variables of the function (or functions) they are nested within. In the code shown here, for example, the inner function square() can read and write the parameters a and b defined by the outer function hypotenuse(). These scope rules for nested functions are very important, and we will consider them again in Â§8.6.</p>
<blockquote>
<p>åµŒå¥—å‡½æ•°çš„æœ‰è¶£ä¹‹å¤„åœ¨äºå®ƒçš„å˜é‡ä½œç”¨åŸŸè§„åˆ™ï¼šå®ƒä»¬å¯ä»¥è®¿é—®åµŒå¥—å®ƒä»¬ï¼ˆæˆ–å¤šé‡åµŒå¥—ï¼‰çš„å‡½æ•°çš„å‚æ•°å’Œå˜é‡ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„ä»£ç é‡Œï¼Œå†…éƒ¨å‡½æ•° square() å¯ä»¥è¯»å†™å¤–éƒ¨å‡½æ•° hypotenuse() å®šä¹‰çš„å‚æ•° a å’Œ bã€‚è¿™äº›ä½œç”¨åŸŸè§„åˆ™å¯¹åµŒå¥—å‡½æ•°éå¸¸é‡è¦ï¼Œæˆ‘ä»¬ä¼šåœ¨ Â§8.6 å†æ·±å…¥äº†è§£å®ƒä»¬ã€‚</p>
</blockquote>
<h2 id="8-2-Invoking-Functions"><a href="#8-2-Invoking-Functions" class="headerlink" title="8.2 Invoking Functions"></a>8.2 Invoking Functions</h2><p>The JavaScript code that makes up the body of a function is not executed when the function is defined, but rather when it is invoked. JavaScript functions can be invoked in five ways:</p>
<blockquote>
<p>æ„æˆå‡½æ•°ä¸»ä½“çš„ JavaScript ä»£ç åœ¨å®šä¹‰ä¹‹æ—¶å¹¶ä¸ä¼šæ‰§è¡Œï¼Œåªæœ‰è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå®ƒä»¬æ‰ä¼šæ‰§è¡Œã€‚JavaScript å‡½æ•°å¯ä»¥ä»¥äº”ç§æ–¹å¼è¢«è°ƒç”¨ã€‚</p>
</blockquote>
<p>As functions</p>
<p>As methods</p>
<p>As constructors</p>
<p>Indirectly through their call() and apply() methods</p>
<p>Implicitly, via JavaScript language features that do not appear like normal function invocations</p>
<blockquote>
<p>ä½œä¸ºå‡½æ•°</p>
<p>ä½œä¸ºæ–¹æ³•</p>
<p>ä½œä¸ºæ„é€ å‡½æ•°</p>
<p>é€šè¿‡å®ƒä»¬çš„ call() å’Œ apply() æ–¹æ³•é—´æ¥è°ƒç”¨</p>
<p>éšå¼è°ƒç”¨ï¼Œä¸åŒäºæ™®é€šå‡½æ•°è°ƒï¼Œé€šè¿‡ JavaScript è¯­è¨€ç‰¹æ€§è°ƒç”¨å‡½æ•°ã€‚</p>
</blockquote>
<h3 id="8-2-1-Function-Invocation"><a href="#8-2-1-Function-Invocation" class="headerlink" title="8.2.1 Function Invocation"></a>8.2.1 Function Invocation</h3><p>Functions are invoked as functions or as methods with an invocation expression (Â§4.5). An invocation expression consists of a function expression that evaluates to a function object followed by an open parenthesis, a comma-separated list of zero or more argument expressions, and a close parenthesis. If the function expression is a property-access expressionâ€”if the function is the property of an object or an element of an arrayâ€”then it is a method invocation expression. That case will be explained in the following example. The following code includes a number of regular function invocation expressions:</p>
<blockquote>
<p>å‡½æ•°æˆ–æ–¹æ³•é€šè¿‡è°ƒç”¨è¡¨è¾¾å¼ï¼ˆÂ§4.5ï¼‰è¢«è°ƒç”¨ã€‚è°ƒç”¨è¡¨è¾¾å¼ç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼Œè®¡ç®—å‡½æ•°å¯¹è±¡çš„å‡½æ•°è¡¨è¾¾å¼ï¼Œä¸€ä¸ªå¼€æ”¾åœ†æ‹¬å·ï¼Œé€—å·åˆ†éš”çš„é›¶ä¸ªæˆ–å¤šä¸ªå®å‚è¡¨è¾¾å¼åˆ—è¡¨ï¼Œä¸€ä¸ªé—­åˆåœ†æ‹¬å·ã€‚å¦‚æœå‡½æ•°è¡¨è¾¾å¼æ˜¯å±æ€§è®¿é—®è¡¨è¾¾å¼ï¼ˆå‡½æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æˆ–è€…ä¸€ä¸ªæ•°ç»„çš„å…ƒç´ ï¼‰é‚£ä¹ˆå®ƒæ˜¯ä¸€ä¸ªæ–¹æ³•è°ƒç”¨è¡¨è¾¾å¼ã€‚è¿™ç§æƒ…å†µä¼šé€šè¿‡ä¸‹é¢çš„ä¾‹å­è¯´æ˜ï¼Œæ¥ä¸‹æ¥è¿™ä¸ªä»£ç åŒ…å«äº†ä¸€äº›å¸¸è§„çš„å‡½æ•°è°ƒç”¨è¡¨è¾¾å¼ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">printprops</span>(&#123;<span class="attr">x</span>: <span class="number">1</span>&#125;);</span><br><span class="line"><span class="keyword">let</span> total = <span class="title function_">distance</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>) + <span class="title function_">distance</span>(<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>);</span><br><span class="line"><span class="keyword">let</span> probability = <span class="title function_">factorial</span>(<span class="number">5</span>)/<span class="title function_">factorial</span>(<span class="number">13</span>);</span><br></pre></td></tr></table></figure>
<p>In an invocation, each argument expression (the ones between the parentheses) is evaluated, and the resulting values become the arguments to the function. These values are assigned to the parameters named in the function definition. In the body of the function, a reference to a parameter evaluates to the corresponding argument value.</p>
<blockquote>
<p>åœ¨è°ƒç”¨ä¸­ï¼Œæ¯ä¸ªå®å‚è¡¨è¾¾å¼ï¼ˆåœ†æ‹¬å·å†…çš„ï¼‰æ‰§è¡Œè®¡ç®—ï¼Œè¿”å›å€¼ä½œä¸ºå‡½æ•°çš„å®å‚ã€‚è¿™äº›å€¼ä¼ ç»™å‡½æ•°å®šä¹‰çš„å‚æ•°ã€‚åœ¨å‡½æ•°ä½“å†…ï¼Œå‚æ•°çš„å¼•ç”¨æŒ‡å‘å¯¹åº”å®å‚çš„å€¼ã€‚</p>
</blockquote>
<p>For regular function invocation, the return value of the function becomes the value of the invocation expression. If the function returns because the interpreter reaches the end, the return value is undefined. If the function returns because the interpreter executes a return statement, then the return value is the value of the expression that follows the return or is undefined if the return statement has no value.</p>
<blockquote>
<p>å¯¹äºå¸¸è§„çš„å‡½æ•°è°ƒç”¨ï¼Œå‡½æ•°è¿”å›å€¼å˜æˆå‡½æ•°è°ƒç”¨è¡¨è¾¾å¼çš„å€¼ã€‚å¦‚æœå› è§£é‡Šå™¨æ‰§è¡Œåˆ°å‡½æ•°ç»“å°¾è€Œè¿”å›ï¼Œè¿”å›å€¼å°±æ˜¯ undefinedã€‚å¦‚æœå‡½æ•°è¿”å›æ˜¯å› ä¸ºè§£é‡Šå™¨æ‰§è¡Œä¸€ä¸ª return è¯­å¥ï¼Œé‚£ä¹ˆè¿”å›å€¼æ˜¯ return åé¢çš„è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœï¼Œå¦‚æœ return è¯­å¥æ²¡æœ‰å€¼ä¹Ÿè¿”å› undefinedã€‚</p>
</blockquote>
<h4 id="CONDITIONAL-INVOCATION"><a href="#CONDITIONAL-INVOCATION" class="headerlink" title="CONDITIONAL INVOCATION"></a>CONDITIONAL INVOCATION</h4><p>In ES2020 you can insert ?. after the function expression and before the open parenthesis in a function invocation in order to invoke the function only if it is not null or undefined. That is, the expression f?.(x) is equivalent (assuming no side effects) to:</p>
<blockquote>
<p>åœ¨ ES2020 ä¸­ä½ å¯ä»¥é€šè¿‡åœ¨å‡½æ•°è¡¨è¾¾å¼å’Œåœ†æ‹¬å·ä¹‹é—´æ’å…¥ ?. ç¬¦å·ï¼Œä½¿å‡½æ•°åªæœ‰åœ¨ä¸ä¸º null å’Œ undefined æ—¶å€™å†è°ƒç”¨ã€‚è¡¨è¾¾å¼ f?.(x) ç­‰ä»·ï¼ˆå‡è®¾æ²¡æœ‰å‰¯ä½œç”¨ï¼‰äºï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(f !== <span class="literal">null</span> &amp;&amp; f !== <span class="literal">undefined</span>) ? <span class="title function_">f</span>(x) : <span class="literal">undefined</span></span><br></pre></td></tr></table></figure>
<p>Full details on this conditional invocation syntax are in Â§4.5.1.</p>
<blockquote>
<p>è¯¦ç»†çš„æ¡ä»¶æ‰§è¡Œè¯­æ³•æè¿°åœ¨ Â§4.5.1ã€‚</p>
</blockquote>
<p>For function invocation in non-strict mode, the invocation context (the this value) is the global object. In strict mode, however, the invocation context is undefined. Note that functions defined using the arrow syntax behave differently: they always inherit the this value that is in effect where they are defined.</p>
<blockquote>
<p>å‡½æ•°è°ƒç”¨åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè°ƒç”¨ä¸Šä¸‹æ–‡ï¼ˆ this ï¼‰æ˜¯å…¨å±€å¯¹è±¡ã€‚ç„¶è€Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè°ƒç”¨ä¸Šä¸‹æ–‡æ˜¯ undefinedã€‚æ³¨æ„ç®­å¤´è¯­æ³•å®šä¹‰çš„å‡½æ•°è¡Œä¸ºæ˜¯ä¸åŒçš„ï¼šå®é™…ä¸Šå®ƒä»¬æ€»æ˜¯ç»§æ‰¿å®ƒä»¬å®šä¹‰ä½ç½®çš„ this å€¼ã€‚</p>
</blockquote>
<p>Functions written to be invoked as functions (and not as methods) do not typically use the this keyword at all. The keyword can be used, however, to determine whether strict mode is in effect:</p>
<blockquote>
<p>ä»¥å‡½æ•°å½¢å¼è°ƒç”¨çš„å‡½æ•°é€šå¸¸ä¸ä½¿ç”¨ this å…³é”®å­—ã€‚ä¸è¿‡ï¼Œthis å…³é”®å­—å¯ä»¥ç”¨æ¥åˆ¤æ–­å½“å‰æ˜¯å¦æ˜¯ä¸¥æ ¼æ¨¡å¼ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Define and invoke a function to determine if we&#x27;re in strict mode.</span></span><br><span class="line"><span class="keyword">const</span> strict = (<span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> !<span class="variable language_">this</span>; &#125;());</span><br></pre></td></tr></table></figure>
<h4 id="RECURSIVE-FUNCTIONS-AND-THE-STACK"><a href="#RECURSIVE-FUNCTIONS-AND-THE-STACK" class="headerlink" title="RECURSIVE FUNCTIONS AND THE STACK"></a>RECURSIVE FUNCTIONS AND THE STACK</h4><p>A recursive function is one, like the factorial() function at the start of this chapter, that calls itself. Some algorithms, such as those involving tree-based data structures, can be implemented particularly elegantly with recursive functions. When writing a recursive function, however, it is important to think about memory constraints. When a function A calls function B, and then function B calls function C, the JavaScript interpreter needs to keep track of the execution contexts for all three functions. When function C completes, the interpreter needs to know where to resume executing function B, and when function B completes, it needs to know where to resume executing function A. You can imagine these execution contexts as a stack. When a function calls another function, a new execution context is pushed onto the stack. When that function returns, its execution context object is popped off the stack. If a function calls itself recursively 100 times, the stack will have 100 objects pushed onto it, and then have those 100 objects popped off. This call stack takes memory. On modern hardware, it is typically fine to write recursive functions that call themselves hundreds of times. But if a function calls itself ten thousand times, it is likely to fail with an error such as â€œMaximum call-stack size exceeded.â€</p>
<blockquote>
<p>é€’å½’å‡½æ•°å°±åƒæœ¬ç« å¼€å§‹çš„ factorial() å‡½æ•°ï¼Œå®ƒè°ƒç”¨å®ƒè‡ªå·±ã€‚æŸäº›ç®—æ³•ï¼ˆå¦‚æ¶‰åŠåŸºäºæ ‘çš„æ•°æ®ç»“æ„ï¼‰å¯ä»¥ä½¿ç”¨é€’å½’å‡½æ•°ç‰¹åˆ«ä¼˜é›…åœ°å®ç°ã€‚åœ¨å†™é€’å½’å‡½æ•°æ—¶ï¼Œè€ƒè™‘å†…å­˜åˆ†é…æ˜¯å¾ˆé‡è¦çš„ã€‚å½“å‡½æ•° A è°ƒç”¨å‡½æ•° Bï¼Œç„¶åå‡½æ•° B åˆè°ƒç”¨å‡½æ•° C æ—¶ï¼ŒJavascript ç¼–è¯‘å™¨éœ€è¦çŸ¥é“åœ¨å“ªé‡Œé‡æ–°æ‰§è¡Œå‡½æ•° Bï¼Œå½“å‡½æ•° B æ‰§è¡Œå®Œæˆåå®ƒéœ€è¦çŸ¥é“åœ¨å“ªé‡Œæ‰§è¡Œå‡½æ•° Aã€‚ä½ å¯ä»¥å°†æ‰§è¡Œä¸Šä¸‹æ–‡æƒ³è±¡æˆä¸€ä¸ªæ ˆã€‚å½“ä¸€ä¸ªå‡½æ•°è°ƒç”¨å¦å¤–ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡è¢«å‹å…¥æ ˆä¸­ã€‚å½“è¢«è°ƒç”¨å‡½æ•°è¿”å›ï¼Œå®ƒçš„æ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡ä»æ ˆä¸­å¼¹å‡ºã€‚å¦‚æœä¸€ä¸ªå‡½æ•°é€’å½’è°ƒç”¨100æ¬¡ï¼Œé‚£ä¹ˆä¼šæœ‰100ä¸ªå¯¹è±¡è¢«å‹å…¥æ ˆä¸­ï¼Œç„¶åè¿™100ä¸ªå¯¹è±¡å†ä¾æ¬¡ä»æ ˆä¸­å¼¹å‡ºã€‚è¿™ç§è°ƒç”¨éå¸¸è€—å†…å­˜ã€‚ä»¥ç°ä»£çš„ç¡¬ä»¶é€’å½’è°ƒç”¨100æ¬¡é€šå¸¸æ²¡ä»€ä¹ˆé—®é¢˜ã€‚ä½†æ˜¯å¦‚æœä¸€ä¸ªå‡½æ•°é€’å½’ä¸Šåƒæ¬¡ï¼Œå®ƒå¯èƒ½ä¼šå¤±è´¥å¹¶æŠ¥é”™â€œMaximum call-stack size exceeded.â€ã€‚</p>
</blockquote>
<h3 id="8-2-2-Method-Invocation"><a href="#8-2-2-Method-Invocation" class="headerlink" title="8.2.2 Method Invocation"></a>8.2.2 Method Invocation</h3><p>A method is nothing more than a JavaScript function that is stored in a property of an object. If you have a function f and an object o, you can define a method named m of o with the following line:</p>
<blockquote>
<p>æ–¹æ³•åªä¸è¿‡æ˜¯å¯¹è±¡å±æ€§å‡½æ•°ã€‚å¦‚æœæœ‰ä¸€ä¸ªå‡½æ•° f å’Œä¸€ä¸ªå¯¹è±¡ oï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç ç»™å¯¹è±¡ o å®šä¹‰ä¸€ä¸ªåä¸º m çš„æ–¹æ³•ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">o.<span class="property">m</span> = f;</span><br></pre></td></tr></table></figure>
<p>Having defined the method m() of the object o, invoke it like this:</p>
<blockquote>
<p>ç»™å¯¹è±¡ o å®šä¹‰äº†æ–¹æ³• m()ï¼Œç”¨è¿™ç§æ–¹å¼è°ƒç”¨å®ƒï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">o.<span class="title function_">m</span>();</span><br></pre></td></tr></table></figure>
<p>Or, if m() expects two arguments, you might invoke it like this:</p>
<blockquote>
<p>æˆ–è€… m() éœ€è¦ä¸¤ä¸ªå®å‚ï¼Œå¯ä»¥è¿™æ ·è°ƒç”¨å®ƒï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">o.<span class="title function_">m</span>(x, y);</span><br></pre></td></tr></table></figure>
<p>The code in this example is an invocation expression: it includes a function expression o.m and two argument expressions, x and y. The function expression is itself a property access expression, and this means that the function is invoked as a method rather than as a regular function.</p>
<blockquote>
<p>ç¤ºä¾‹ä¸­çš„ä»£ç æ˜¯ä¸€ä¸ªè°ƒç”¨è¡¨è¾¾å¼ï¼šå®ƒåŒ…å«ä¸€ä¸ªå‡½æ•°è¡¨è¾¾å¼ o.m å’Œä¸¤ä¸ªå®å‚è¡¨è¾¾å¼ x å’Œ yã€‚å‡½æ•°è¡¨è¾¾å¼æœ¬èº«æ˜¯ä¸€ä¸ªå±æ€§è®¿é—®è¡¨è¾¾å¼ï¼Œè¿™æ„å‘³ç€è¯¥å‡½æ•°è¢«å½“ä½œä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ™®é€šçš„å‡½æ•°ã€‚</p>
</blockquote>
<p>The arguments and return value of a method invocation are handled exactly as described for regular function invocation. Method invocations differ from function invocations in one important way, however: the invocation context. Property access expressions consist of two parts: an object (in this case o) and a property name (m). In a method-invocation expression like this, the object o becomes the invocation context, and the function body can refer to that object by using the keyword this. Here is a concrete example:</p>
<blockquote>
<p>å¯¹æ–¹æ³•è°ƒç”¨çš„å‚æ•°å’Œè¿”å›å€¼çš„å¤„ç†ï¼Œå’Œä¸Šé¢æ‰€æè¿°çš„æ™®é€šå‡½æ•°è°ƒç”¨å®Œå…¨ä¸€è‡´ã€‚ä½†æ˜¯ï¼Œæ–¹æ³•è°ƒç”¨å’Œå‡½æ•°è°ƒç”¨æœ‰ä¸€ä¸ªé‡è¦çš„åŒºåˆ«ï¼Œå³ï¼šè°ƒç”¨ä¸Šä¸‹æ–‡ã€‚å±æ€§è®¿é—®è¡¨è¾¾å¼ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šä¸€ä¸ªå¯¹è±¡ï¼ˆæœ¬ä¾‹ä¸­çš„ oï¼‰å’Œå±æ€§åç§°ï¼ˆmï¼‰ã€‚åœ¨åƒè¿™æ ·çš„æ–¹æ³•è°ƒç”¨è¡¨è¾¾å¼é‡Œï¼Œå¯¹è±¡ o æˆä¸ºè°ƒç”¨ä¸Šä¸‹æ–‡ï¼Œå‡½æ•°ä½“å¯ä»¥ä½¿ç”¨å…³é”®å­—thiså¼•ç”¨è¯¥å¯¹è±¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> calculator = &#123; <span class="comment">// An object literal</span></span><br><span class="line">    <span class="attr">operand1</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">operand2</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="title function_">add</span>(<span class="params"></span>) &#123;        <span class="comment">// We&#x27;re using method shorthand syntax for this function</span></span><br><span class="line">        <span class="comment">// Note the use of the this keyword to refer to the containing object.</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">result</span> = <span class="variable language_">this</span>.<span class="property">operand1</span> + <span class="variable language_">this</span>.<span class="property">operand2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">calculator.<span class="title function_">add</span>();  <span class="comment">// A method invocation to compute 1+1.</span></span><br><span class="line">calculator.<span class="property">result</span>  <span class="comment">// =&gt; 2</span></span><br></pre></td></tr></table></figure>
<p>Most method invocations use the dot notation for property access, but property access expressions that use square brackets also cause method invocation. The following are both method invocations, for example:</p>
<blockquote>
<p>å¤§å¤šæ•°æ–¹æ³•è°ƒç”¨ä½¿ç”¨ç‚¹ç¬¦å·æ¥è®¿é—®å±æ€§ï¼Œä½¿ç”¨æ–¹æ‹¬å·ï¼ˆå±æ€§è®¿é—®è¡¨è¾¾å¼ï¼‰ä¹Ÿå¯ä»¥è¿›è¡Œå±æ€§è®¿é—®æ“ä½œã€‚ä¸‹é¢ä¸¤ä¸ªä¾‹å­éƒ½æ˜¯å‡½æ•°è°ƒç”¨ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">o[<span class="string">&quot;m&quot;</span>](x,y);   <span class="comment">// Another way to write o.m(x,y).</span></span><br><span class="line">a[<span class="number">0</span>](z)        <span class="comment">// Also a method invocation (assuming a[0] is a function).</span></span><br></pre></td></tr></table></figure>
<p>Method invocations may also involve more complex property access expressions:</p>
<blockquote>
<p>æ–¹æ³•è°ƒç”¨å¯èƒ½åŒ…æ‹¬æ›´å¤æ‚çš„å±æ€§è®¿é—®è¡¨è¾¾å¼ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">customer.<span class="property">surname</span>.<span class="title function_">toUpperCase</span>(); <span class="comment">// Invoke method on customer.surname</span></span><br><span class="line"><span class="title function_">f</span>().<span class="title function_">m</span>();                        <span class="comment">// Invoke method m() on return value of f()</span></span><br></pre></td></tr></table></figure>
<p>Methods and the this keyword are central to the object-oriented programming paradigm. Any function that is used as a method is effectively passed an implicit argumentâ€”the object through which it is invoked. Typically, a method performs some sort of operation on that object, and the method-invocation syntax is an elegant way to express the fact that a function is operating on an object. Compare the following two lines:</p>
<blockquote>
<p>æ–¹æ³•å’Œ this å…³é”®å­—æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹èŒƒå¼çš„æ ¸å¿ƒã€‚ä»»ä½•å‡½æ•°åªè¦ä½œä¸ºæ–¹æ³•è°ƒç”¨å®é™…ä¸Šéƒ½ä¼šä¼ å…¥ä¸€ä¸ªéšå¼çš„å®å‚å¯¹è±¡ï¼Œå°±æ˜¯è°ƒç”¨è¿™ä¸ªæ–¹æ³•å¯¹è±¡æœ¬èº«ã€‚é€šå¸¸æ¥è®²ï¼Œæ–¹æ³•æ‰§è¡Œå°±æ˜¯å¯¹è±¡çš„æŸç§æ“ä½œï¼Œæ–¹æ³•è°ƒç”¨çš„è¯­æ³•ä¹Ÿæ¸…æ™°çš„è¡¨è¾¾äº†å®ƒæ˜¯æ“ä½œå¯¹è±¡çš„å‡½æ•°ï¼Œæ¯”è¾ƒä¸‹é¢ä¸¤è¡Œä»£ç ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rect.<span class="title function_">setSize</span>(width, height);</span><br><span class="line"><span class="title function_">setRectSize</span>(rect, width, height);</span><br></pre></td></tr></table></figure>
<p>The hypothetical functions invoked in these two lines of code may perform exactly the same operation on the (hypothetical) object rect, but the method-invocation syntax in the first line more clearly indicates the idea that it is the object rect that is the primary focus of the operation.</p>
<blockquote>
<p>æˆ‘ä»¬å‡è®¾è¿™ä¸¤è¡Œä»£ç çš„åŠŸèƒ½å®Œå…¨ä¸€æ ·ï¼Œå®ƒä»¬éƒ½ä½œç”¨äºä¸€ä¸ªå‡å®šçš„å¯¹è±¡ rectã€‚å¯ä»¥çœ‹å‡ºï¼Œç¬¬ä¸€è¡Œçš„æ–¹æ³•è°ƒç”¨è¯­æ³•éå¸¸æ¸…æ™°åœ°è¡¨æ˜è¿™ä¸ªå‡½æ•°æ‰§è¡Œçš„è½½ä½“æ˜¯ rect å¯¹è±¡ï¼Œå‡½æ•°ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½å°†åŸºäºè¿™ä¸ªå¯¹è±¡ã€‚</p>
</blockquote>
<h4 id="METHOD-CHAINING"><a href="#METHOD-CHAINING" class="headerlink" title="METHOD CHAINING"></a>METHOD CHAINING</h4><p>When methods return objects, you can use the return value of one method invocation as part of a subsequent invocation. This results in a series (or â€œchainâ€) of method invocations as a single expression. When working with Promise-based asynchronous operations (see Chapter 13), for example, it is common to write code structured like this:</p>
<blockquote>
<p>å½“æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡è¿˜å¯ä»¥å†è°ƒç”¨å®ƒçš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•è°ƒç”¨åºåˆ—ä¸­ï¼ˆæˆ–â€œé“¾â€ï¼‰æ¯æ¬¡çš„è°ƒç”¨ç»“æœéƒ½æ˜¯å¦å¤–ä¸€ä¸ªè¡¨è¾¾å¼çš„ç»„æˆéƒ¨åˆ†ã€‚æ¯”å¦‚ï¼ŒåŸºäº Promise çš„å¼‚æ­¥æ“ä½œï¼ˆå‚è§ç¬¬ 13 ç« ï¼‰ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šè¿™æ ·å†™ä»£ç ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Run three asynchronous operations in sequence, handling errors.</span></span><br><span class="line"><span class="title function_">doStepOne</span>().<span class="title function_">then</span>(doStepTwo).<span class="title function_">then</span>(doStepThree).<span class="title function_">catch</span>(handleErrors);</span><br></pre></td></tr></table></figure>
<p>When you write a method that does not have a return value of its own, consider having the method return this. If you do this consistently throughout your API, you will enable a style of programming known as method chaining1 in which an object can be named once and then multiple methods can be invoked on it:</p>
<blockquote>
<p>å½“æ–¹æ³•å¹¶ä¸éœ€è¦è¿”å›å€¼æ—¶ï¼Œæœ€å¥½ç›´æ¥è¿”å› thisã€‚å¦‚æœåœ¨è®¾è®¡çš„ API ä¸­ä¸€ç›´é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œä½¿ç”¨ API å°±å¯ä»¥ç”¨æ–¹æ³•é“¾ ^1 é£æ ¼çš„ç¼–ç¨‹ï¼Œåœ¨è¿™ç§ç¼–ç¨‹é£æ ¼ä¸­ï¼Œåªè¦æŒ‡å®šä¸€æ¬¡è¦è°ƒç”¨çš„å¯¹è±¡å³å¯ï¼Œä½™ä¸‹çš„æ–¹æ³•éƒ½å¯ä»¥åŸºäºæ­¤è¿›è¡Œè°ƒç”¨ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Square</span>().<span class="title function_">x</span>(<span class="number">100</span>).<span class="title function_">y</span>(<span class="number">100</span>).<span class="title function_">size</span>(<span class="number">50</span>).<span class="title function_">outline</span>(<span class="string">&quot;red&quot;</span>).<span class="title function_">fill</span>(<span class="string">&quot;blue&quot;</span>).<span class="title function_">draw</span>();</span><br></pre></td></tr></table></figure>
<p>Note that this is a keyword, not a variable or property name. JavaScript syntax does not allow you to assign a value to this.</p>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œthis æ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œä¸æ˜¯å˜é‡ï¼Œä¹Ÿä¸æ˜¯å±æ€§åã€‚JavaScript çš„è¯­æ³•ä¸å…è®¸ç»™ this èµ‹å€¼ã€‚</p>
</blockquote>
<p>The this keyword is not scoped the way variables are, and, except for arrow functions, nested functions do not inherit the this value of the containing function. If a nested function is invoked as a method, its this value is the object it was invoked on. If a nested function (that is not an arrow function) is invoked as a function, then its this value will be either the global object (non-strict mode) or undefined (strict mode). It is a common mistake to assume that a nested function defined within a method and invoked as a function can use this to obtain the invocation context of the method. The following code demonstrates the problem:</p>
<blockquote>
<p>å…³é”®å­— this æ²¡æœ‰å˜é‡ä½œç”¨åŸŸçš„é™åˆ¶ï¼Œé™¤äº†ç®­å¤´å‡½æ•°ï¼ŒåµŒå¥—å‡½æ•°ä¸ä¼šä»åŒ…å«å®ƒçš„å‡½æ•°ä¸­ç»§æ‰¿ thisã€‚å¦‚æœåµŒå¥—å‡½æ•°ä½œä¸ºæ–¹æ³•è°ƒç”¨ï¼Œå…¶ this çš„å€¼æŒ‡å‘è°ƒç”¨å®ƒçš„å¯¹è±¡ã€‚å¦‚æœåµŒå¥—çš„å‡½æ•°ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼ˆä¸åŒ…å«ç®­å¤´å‡½æ•°ï¼‰ï¼Œå…¶ this å€¼ä¸æ˜¯å…¨å±€å¯¹è±¡ï¼ˆéä¸¥æ ¼æ¨¡å¼ä¸‹ï¼‰å°±æ˜¯ undefinedï¼ˆä¸¥æ ¼æ¨¡å¼ä¸‹ï¼‰ã€‚å¾ˆå¤šäººè¯¯ä»¥ä¸ºåœ¨ä¸€ä¸ªæ–¹æ³•ä¸­çš„å‡½æ•°å£°æ˜å¹¶ä»¥å‡½æ•°è°ƒç”¨çš„æ–¹å¼å»æ‰§è¡Œå¯ä»¥ç”¨ this æ¥è·å–æ–¹æ³•çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­è¯´æ˜äº†è¿™ä¸ªé—®é¢˜ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;                 <span class="comment">// An object o.</span></span><br><span class="line">    <span class="attr">m</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;       <span class="comment">// Method m of the object.</span></span><br><span class="line">        <span class="keyword">let</span> self = <span class="variable language_">this</span>;  <span class="comment">// Save the &quot;this&quot; value in a variable.</span></span><br><span class="line">        <span class="variable language_">this</span> === o        <span class="comment">// =&gt; true: &quot;this&quot; is the object o.</span></span><br><span class="line">        <span class="title function_">f</span>();              <span class="comment">// Now call the helper function f().</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;    <span class="comment">// A nested function f</span></span><br><span class="line">            <span class="variable language_">this</span> === o    <span class="comment">// =&gt; false: &quot;this&quot; is global or undefined</span></span><br><span class="line">            self === o    <span class="comment">// =&gt; true: self is the outer &quot;this&quot; value.</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">o.<span class="title function_">m</span>();                    <span class="comment">// Invoke the method m on the object o.</span></span><br></pre></td></tr></table></figure>
<p>Inside the nested function f(), the this keyword is not equal to the object o. This is widely considered to be a flaw in the JavaScript language, and it is important to be aware of it. The code above demonstrates one common workaround. Within the method m, we assign the this value to a variable self, and within the nested function f, we can use self instead of this to refer to the containing object.</p>
<blockquote>
<p>åµŒå¥—å‡½æ•° f() ä¸­ï¼Œthis å…³é”®ä¹‹ä¸ç­‰äºå¯¹è±¡ oã€‚è¿™è¢«å¹¿æ³›çš„è®¤ä¸ºæ˜¯ JavaScript çš„ä¸€ä¸ªç¼ºé™·ï¼Œäº†è§£è¿™ä¸€ç‚¹æ˜¯å¾ˆæ˜¯å¾ˆé‡è¦çš„ã€‚ä¸Šé¢çš„ä»£ç æ¼”ç¤ºäº†ä¸€ç§å¸¸ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚åœ¨æ–¹æ³• m ä¸­ï¼Œå°† this å€¼èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ selfï¼Œåœ¨ç­¾åˆ°å‡½æ•° f ä¸­ï¼Œå¯ä»¥ç”¨ self ä»£æ›¿ this æ¥å¼•ç”¨åŒ…å«å®ƒçš„å¯¹è±¡ã€‚</p>
</blockquote>
<p>In ES6 and later, another workaround to this issue is to convert the nested function f into an arrow function, which will properly inherit the this value:</p>
<blockquote>
<p>åœ¨ ES6 ä¹‹åï¼Œæœ‰å¦å¤–ä¸€ç§è§£å†³æ–¹æ¡ˆæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°†åµŒå¥—å‡½æ•° f è½¬æ¢æˆç®­å¤´å‡½æ•°ï¼Œå®ƒä¼šæ­£ç¡®çš„ç»§æ‰¿ this å€¼ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">f</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">this</span> === o  <span class="comment">// true, since arrow functions inherit this</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Functions defined as expressions instead of statements are not hoisted, so in order to make this code work, the function definition for f will need to be moved within the method m so that it appears before it is invoked.</p>
<blockquote>
<p>å‡½æ•°è¡¨è¾¾å¼ä¸åƒå‡½æ•°å£°æ˜ï¼Œå£°æ˜æå‰ï¼Œæ‰€ä»¥ä¸ºäº†è®©è¿™ç§è§£å†³æ–¹æ¡ˆå®šä¹‰çš„å‡½æ•°å¯ä»¥è¢«è°ƒç”¨ï¼Œéœ€è¦å°† f å‡½æ•°å®šä¹‰è¡¨è¾¾å¼æ”¾åœ¨æ–¹æ³• m ä¸­ï¼Œè¿™æ ·å®ƒæ‰å¯ä»¥åœ¨å®ƒè¢«è°ƒç”¨æ—¶å­˜åœ¨ã€‚</p>
</blockquote>
<p>Another workaround is to invoke the bind() method of the nested function to define a new function that is implicitly invoked on a specified object:</p>
<blockquote>
<p>å¦å¤–è¿˜å¯ä»¥ç”¨åµŒå¥—å‡½æ•°çš„ bind() æ–¹æ³•ï¼Œåœ¨æŒ‡å®šå¯¹è±¡ä¸Šéšå¼è°ƒç”¨ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> f = (<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span> === o  <span class="comment">// true, since we bound this function to the outer this</span></span><br><span class="line">&#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br></pre></td></tr></table></figure>
<p>Weâ€™ll talk more about bind() in Â§8.7.5.</p>
<blockquote>
<p>å…³äº bind() æ–¹æ³•å°†åœ¨ Â§8.7.5 ä¸­è®²è§£ã€‚</p>
</blockquote>
<h3 id="8-2-3-Constructor-Invocation"><a href="#8-2-3-Constructor-Invocation" class="headerlink" title="8.2.3 Constructor Invocation"></a>8.2.3 Constructor Invocation</h3><p>If a function or method invocation is preceded by the keyword new, then it is a constructor invocation. (Constructor invocations were introduced in Â§4.6 and Â§6.2.2, and constructors will be covered in more detail in Chapter 9.) Constructor invocations differ from regular function and method invocations in their handling of arguments, invocation context, and return value.</p>
<blockquote>
<p>å¦‚æœå‡½æ•°æˆ–è€…æ–¹æ³•è°ƒç”¨ä¹‹å‰å¸¦æœ‰å…³é”®å­— newï¼Œå®ƒå°±æ„æˆæ„é€ å‡½æ•°è°ƒç”¨ï¼ˆæ„é€ å‡½æ•°è°ƒç”¨åœ¨ Â§4.6 å’Œ Â§6.2.2 èŠ‚æœ‰ç®€å•ä»‹ç»ï¼Œç¬¬ 9 ç« ä¼šå¯¹æ„é€ å‡½æ•°åšæ›´è¯¦ç»†çš„è®¨è®ºï¼‰ã€‚æ„é€ å‡½æ•°è°ƒç”¨å’Œæ™®é€šçš„å‡½æ•°è°ƒç”¨ä»¥åŠæ–¹æ³•è°ƒç”¨åœ¨å®å‚å¤„ç†ã€è°ƒç”¨ä¸Šä¸‹æ–‡å’Œè¿”å›å€¼æ–¹é¢éƒ½æœ‰ä¸åŒã€‚</p>
</blockquote>
<p>If a constructor invocation includes an argument list in parentheses, those argument expressions are evaluated and passed to the function in the same way they would be for function and method invocations. It is not common practice, but you can omit a pair of empty parentheses in a constructor invocation. The following two lines, for example, are equivalent:</p>
<blockquote>
<p>å¦‚æœæ„é€ å‡½æ•°è°ƒç”¨åœ¨åœ†æ‹¬å·å†…åŒ…å«ä¸€ç»„å®å‚åˆ—è¡¨ï¼Œå…ˆè®¡ç®—è¿™äº›å®å‚è¡¨è¾¾å¼ï¼Œç„¶åä¼ å…¥å‡½æ•°å†…ï¼Œè¿™å’Œå‡½æ•°è°ƒç”¨å’Œæ–¹æ³•è°ƒç”¨æ˜¯ä¸€è‡´çš„ã€‚ä½†å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰å½¢å‚ï¼ŒJavaScript æ„é€ å‡½æ•°è°ƒç”¨çš„è¯­æ³•æ˜¯å…è®¸çœç•¥å®å‚åˆ—è¡¨å’Œåœ†æ‹¬å·çš„ã€‚å‡¡æ˜¯æ²¡æœ‰å½¢å‚çš„æ„é€ å‡½æ•°è°ƒç”¨éƒ½å¯ä»¥çœç•¥åœ†æ‹¬å·ï¼Œæ¯”å¦‚ï¼Œä¸‹é¢è¿™ä¸¤è¡Œä»£ç å°±æ˜¯ç­‰ä»·çš„ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">o = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">o = <span class="keyword">new</span> <span class="title class_">Object</span>;</span><br></pre></td></tr></table></figure>
<p>A constructor invocation creates a new, empty object that inherits from the object specified by the prototype property of the constructor. Constructor functions are intended to initialize objects, and this newly created object is used as the invocation context, so the constructor function can refer to it with the this keyword. Note that the new object is used as the invocation context even if the constructor invocation looks like a method invocation. That is, in the expression new o.m(), o is not used as the invocation context.</p>
<blockquote>
<p>æ„é€ å‡½æ•°è°ƒç”¨åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ç»§æ‰¿è‡ªæ„é€ å‡½æ•°çš„ prototype å±æ€§ã€‚æ„é€ å‡½æ•°è¯•å›¾åˆå§‹åŒ–è¿™ä¸ªæ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œå¹¶å°†è¿™ä¸ªå¯¹è±¡ç”¨åšå…¶è°ƒç”¨ä¸Šä¸‹æ–‡ï¼Œå› æ­¤æ„é€ å‡½æ•°å†…å¯ä»¥ä½¿ç”¨ this å…³é”®å­—æ¥å¼•ç”¨è¿™ä¸ªæ–°åˆ›å»ºçš„å¯¹è±¡ã€‚æ³¨æ„ï¼Œå°½ç®¡æ„é€ å‡½æ•°çœ‹èµ·æ¥åƒä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œå®ƒä¾ç„¶ä¼šä½¿ç”¨è¿™ä¸ªæ–°å¯¹è±¡ä½œä¸ºè°ƒç”¨ä¸Šä¸‹æ–‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¡¨è¾¾å¼ new o.m() ä¸­ï¼Œè°ƒç”¨ä¸Šä¸‹æ–‡å¹¶ä¸æ˜¯ oã€‚</p>
</blockquote>
<p>Constructor functions do not normally use the return keyword. They typically initialize the new object and then return implicitly when they reach the end of their body. In this case, the new object is the value of the constructor invocation expression. If, however, a constructor explicitly uses the return statement to return an object, then that object becomes the value of the invocation expression. If the constructor uses return with no value, or if it returns a primitive value, that return value is ignored and the new object is used as the value of the invocation.</p>
<blockquote>
<p>æ„é€ å‡½æ•°é€šå¸¸ä¸ä½¿ç”¨ return å…³é”®å­—ï¼Œå®ƒä»¬é€šå¸¸åˆå§‹åŒ–æ–°å¯¹è±¡ï¼Œå½“æ„é€ å‡½æ•°çš„å‡½æ•°ä½“æ‰§è¡Œå®Œæ¯•æ—¶ï¼Œå®ƒä¼šéšå¼è¿”å›ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ„é€ å‡½æ•°è°ƒç”¨è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœå°±æ˜¯è¿™ä¸ªæ–°å¯¹è±¡çš„å€¼ã€‚ç„¶è€Œå¦‚æœæ„é€ å‡½æ•°æ˜¾å¼åœ°ä½¿ç”¨ return è¯­å¥è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆè°ƒç”¨è¡¨è¾¾å¼çš„å€¼å°±æ˜¯è¿™ä¸ªå¯¹è±¡ã€‚å¦‚æœæ„é€ å‡½æ•°ä½¿ç”¨ return è¯­å¥ä½†æ²¡æœ‰æŒ‡å®šè¿”å›å€¼ï¼Œæˆ–è€…è¿”å›ä¸€ä¸ªåŸå§‹å€¼ï¼Œé‚£ä¹ˆè¿™æ—¶å°†å¿½ç•¥è¿”å›å€¼ï¼ŒåŒæ—¶ä½¿ç”¨è¿™ä¸ªæ–°å¯¹è±¡ä½œä¸ºè°ƒç”¨ç»“æœã€‚</p>
</blockquote>
<h3 id="8-2-4-Indirect-Invocation"><a href="#8-2-4-Indirect-Invocation" class="headerlink" title="8.2.4 Indirect Invocation"></a>8.2.4 Indirect Invocation</h3><p>JavaScript functions are objects, and like all JavaScript objects, they have methods. Two of these methods, call() and apply(), invoke the function indirectly. Both methods allow you to explicitly specify the this value for the invocation, which means you can invoke any function as a method of any object, even if it is not actually a method of that object. Both methods also allow you to specify the arguments for the invocation. The call() method uses its own argument list as arguments to the function, and the apply() method expects an array of values to be used as arguments. The call() and apply() methods are described in detail in Â§8.7.4.</p>
<blockquote>
<p>JavaScript ä¸­çš„å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œå’Œå…¶ä»– JavaScript å¯¹è±¡æ²¡ä»€ä¹ˆä¸¤æ ·ï¼Œå‡½æ•°å¯¹è±¡ä¹Ÿå¯ä»¥åŒ…å«æ–¹æ³•ã€‚å…¶ä¸­çš„ä¸¤ä¸ªæ–¹æ³• call() å’Œ apply() å¯ä»¥ç”¨æ¥é—´æ¥åœ°è°ƒç”¨å‡½æ•°ã€‚ä¸¤ä¸ªæ–¹æ³•éƒ½å…è®¸æ˜¾å¼æŒ‡å®šè°ƒç”¨æ‰€éœ€çš„ this å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»»ä½•å‡½æ•°å¯ä»¥ä½œä¸ºä»»ä½•å¯¹è±¡çš„æ–¹æ³•æ¥è°ƒç”¨ï¼Œå“ªæ€•è¿™ä¸ªå‡½æ•°ä¸æ˜¯é‚£ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥æŒ‡å®šè°ƒç”¨çš„å®å‚ã€‚call() æ–¹æ³•ä½¿ç”¨å®ƒè‡ªæœ‰çš„å®å‚åˆ—è¡¨ä½œä¸ºå‡½æ•°çš„å®å‚ï¼Œapply() æ–¹æ³•åˆ™è¦æ±‚ä»¥æ•°ç»„çš„å½¢å¼ä¼ å…¥å®å‚ã€‚Â§8.7.4 èŠ‚ä¼šæœ‰å…³äº call() å’Œapply () æ–¹æ³•çš„è¯¦ç»†è®¨è®ºã€‚</p>
</blockquote>
<h3 id="8-2-5-Implicit-Function-Invocation"><a href="#8-2-5-Implicit-Function-Invocation" class="headerlink" title="8.2.5 Implicit Function Invocation"></a>8.2.5 Implicit Function Invocation</h3><p>There are various JavaScript language features that do not look like function invocations but that cause functions to be invoked. Be extra careful when writing functions that may be implicitly invoked, because bugs, side effects, and performance issues in these functions are harder to diagnose and fix than in regular functions for the simple reason that it may not be obvious from a simple inspection of your code when they are being called.</p>
<blockquote>
<p>æœ‰å„ç§å„æ ·çš„ JavaScript è¯­è¨€ç‰¹æ€§ï¼Œå®ƒä»¬çœ‹èµ·æ¥ä¸åƒå‡½æ•°è°ƒç”¨ä½†æ˜¯å´èƒ½è°ƒç”¨å‡½æ•°ã€‚é¢å¤–å°å¿ƒç¼–å†™å‡½æ•°æ—¶å¯èƒ½ä¼šéšå¼è°ƒç”¨ï¼Œå› ä¸ºåœ¨éšå¼å‡½æ•°è°ƒç”¨ä¸­ bugã€å‰¯ä½œç”¨å’Œæ€§èƒ½é—®é¢˜éƒ½æ¯”æ™®é€šçš„å‡½æ•°æ›´éš¾è¯Šæ–­å’Œä¿®å¤ã€‚</p>
</blockquote>
<p>The language features that can cause implicit function invocation include:</p>
<blockquote>
<p>å¯èƒ½å¼•èµ·å‡½æ•°éšå¼è°ƒç”¨çš„è¯­è¨€ç‰¹æ€§åŒ…æ‹¬ï¼š</p>
</blockquote>
<p>If an object has getters or setters defined, then querying or setting the value of its properties may invoke those methods. See Â§6.10.6 for more information.</p>
<blockquote>
<p>å¦‚æœä¸€ä¸ªå¯¹è±¡å®šä¹‰äº† getter æˆ–è€… setter æ–¹æ³•ï¼Œè·å–æˆ–è€…è®¾ç½®å®ƒçš„å±æ€§å€¼å¯èƒ½è°ƒç”¨è¿™äº›æ–¹æ³•ã€‚è§ Â§6.10.6 æœ‰æ›´å¤šç›¸å…³æè¿°ã€‚</p>
</blockquote>
<p>When an object is used in a string context (such as when it is concatenated with a string), its toString() method is called. Similarly, when an object is used in a numeric context, its valueOf() method is invoked. See Â§3.9.3 for details.</p>
<blockquote>
<p>å½“å¯¹è±¡ç”¨ä½œä¸€ä¸ªå­—ç¬¦ä¸²æ–‡æœ¬æ—¶ï¼ˆä¾‹å¦‚å¯¹è±¡å’Œä¸€ä¸ªå­—ç¬¦ä¸²è¿æ¥ï¼‰ï¼Œå®ƒçš„ toString() æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚åŒæ ·çš„ï¼Œå¯¹è±¡ç”¨ä½œä¸€ä¸ªæ•°å€¼å‹æ–‡æœ¬æ—¶ï¼Œå®ƒçš„ valueOf() æ–¹æ³•è¢«è°ƒç”¨ã€‚è¯¦è§ Â§3.9.3ã€‚</p>
</blockquote>
<p>When you loop over the elements of an iterable object, there are a number of method calls that occur. Chapter 12 explains how iterators work at the function call level and demonstrates how to write these methods so that you can define your own iterable types.</p>
<blockquote>
<p>å½“å¾ªç¯å¯è¿­ä»£å¯¹è±¡çš„å…ƒç´ æ—¶ä¼šäº§ç”Ÿå¾ˆå¤šæ–¹æ³•è°ƒç”¨ã€‚ç¬¬ 12 ç« ä»‹ç»äº†è¿­ä»£å™¨åœ¨å‡½æ•°è°ƒç”¨çº§åˆ«å¦‚ä½•å·¥ä½œï¼Œå¹¶æ¼”ç¤ºå¦‚ä½•ç¼–å†™æ–¹æ³•æ¥å®šä¹‰è‡ªå·±çš„å¯è¿­ä»£ç±»å‹ã€‚</p>
</blockquote>
<p>A tagged template literal is a function invocation in disguise. Â§14.5 demonstrates how to write functions that can be used in conjunction with template literal strings.</p>
<blockquote>
<p>å¯ä»¥ä¼ªè£…åœ¨æ¨¡æ¿å­—é¢é‡ä¸­ ã€‚åœ¨ Â§14.5 ä¸­æ¼”ç¤ºå¦‚ä½•åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¸­è°ƒç”¨å‡½æ•°ã€‚</p>
</blockquote>
<p>Proxy objects (described in Â§14.7) have their behavior completely controlled by functions. Just about any operation on one of these objects will cause a function to be invoked.</p>
<blockquote>
<p>Proxy å¯¹è±¡ï¼ˆåœ¨ Â§14.7 ä¸­æè¿°ï¼‰çš„è¡Œä¸ºå®Œå…¨ç”±å‡½æ•°æ§åˆ¶ã€‚å®ƒçš„ä»»ä½•ä¸€ä¸ªæ“ä½œéƒ½ä¼šå¯¼è‡´å‡½æ•°è°ƒç”¨ã€‚</p>
</blockquote>
<h2 id="8-3-Function-Arguments-and-Parameters"><a href="#8-3-Function-Arguments-and-Parameters" class="headerlink" title="8.3 Function Arguments and Parameters"></a>8.3 Function Arguments and Parameters</h2><p>JavaScript function definitions do not specify an expected type for the function parameters, and function invocations do not do any type checking on the argument values you pass. In fact, JavaScript function invocations do not even check the number of arguments being passed. The subsections that follow describe what happens when a function is invoked with fewer arguments than declared parameters or with more arguments than declared parameters. They also demonstrate how you can explicitly test the type of function arguments if you need to ensure that a function is not invoked with inappropriate arguments.</p>
<blockquote>
<p>JavaScript ä¸­çš„å‡½æ•°å®šä¹‰å¹¶æœªæŒ‡å®šå‡½æ•°å½¢å‚çš„ç±»å‹ï¼Œå‡½æ•°è°ƒç”¨ä¹Ÿæœªå¯¹ä¼ å…¥çš„å®å‚å€¼åšä»»ä½•ç±»å‹æ£€æŸ¥ã€‚å®é™…ä¸Šï¼ŒJavaScript å‡½æ•°è°ƒç”¨ç”šè‡³ä¸æ£€æŸ¥ä¼ å…¥å½¢å‚çš„ä¸ªæ•°ã€‚ä¸‹é¢å‡ èŠ‚å°†ä¼šè®¨è®ºå½“è°ƒç”¨å‡½æ•°æ—¶çš„å®å‚ä¸ªæ•°å’Œå£°æ˜çš„å½¢å‚ä¸ªæ•°ä¸åŒ¹é…æ—¶å‡ºç°çš„çŠ¶å†µï¼ŒåŒæ ·ä»‹ç»äº†å¦‚ä½•æ˜¾å¼æµ‹è¯•å‡½æ•°å®å‚çš„ç±»å‹ï¼Œä»¥é¿å…éæ³•çš„å®å‚ä¼ å…¥å‡½æ•°ã€‚</p>
</blockquote>
<h3 id="8-3-1-Optional-Parameters-and-Defaults"><a href="#8-3-1-Optional-Parameters-and-Defaults" class="headerlink" title="8.3.1 Optional Parameters and Defaults"></a>8.3.1 Optional Parameters and Defaults</h3><p>When a function is invoked with fewer arguments than declared parameters, the additional parameters are set to their default value, which is normally undefined. It is often useful to write functions so that some arguments are optional. Following is an example:</p>
<blockquote>
<p>å½“è°ƒç”¨å‡½æ•°çš„æ—¶å€™ä¼ å…¥çš„å®å‚æ¯”å‡½æ•°å£°æ˜æ—¶æŒ‡å®šçš„å½¢å‚ä¸ªæ•°è¦å°‘ï¼Œå‰©ä¸‹çš„å½¢å‚éƒ½å°†è®¾ç½®ä¸º undefined å€¼ã€‚æ‰€ä»¥ä¸€äº›å‚æ•°è®¾ç½®æˆå¯é€‰çš„æ˜¯éå¸¸å®ç”¨çš„ã€‚çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Append the names of the enumerable properties of object o to the</span></span><br><span class="line"><span class="comment">// array a, and return a.  If a is omitted, create and return a new array.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getPropertyNames</span>(<span class="params">o, a</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (a === <span class="literal">undefined</span>) a = [];  <span class="comment">// If undefined, use a new array</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> property <span class="keyword">in</span> o) a.<span class="title function_">push</span>(property);</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// getPropertyNames() can be invoked with one or two arguments:</span></span><br><span class="line"><span class="keyword">let</span> o = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;, p = &#123;<span class="attr">y</span>: <span class="number">2</span>, <span class="attr">z</span>: <span class="number">3</span>&#125;;  <span class="comment">// Two objects for testing</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="title function_">getPropertyNames</span>(o); <span class="comment">// a == [&quot;x&quot;]; get o&#x27;s properties in a new array</span></span><br><span class="line"><span class="title function_">getPropertyNames</span>(p, a);      <span class="comment">// a == [&quot;x&quot;,&quot;y&quot;,&quot;z&quot;]; add p&#x27;s properties to it</span></span><br></pre></td></tr></table></figure>
<p>Instead of using an if statement in the first line of this function, you can use the || operator in this idiomatic way:</p>
<blockquote>
<p>ç¬¬ä¸€è¡Œä»£ç ä¸­å¯ä»¥ä½¿ç”¨ || è¿ç®—ç¬¦æ¥ä»£æ›¿ä¸€ä¸ª if è¯­å¥ï¼Œè¿™æ˜¯ä¸€ç§ä¹ æƒ¯ç”¨æ³•ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = a || [];</span><br></pre></td></tr></table></figure>
<p>Recall from Â§4.10.2 that the || operator returns its first argument if that argument is truthy and otherwise returns its second argument. In this case, if any object is passed as the second argument, the function will use that object. But if the second argument is omitted (or null or another falsy value is passed), a newly created empty array will be used instead.</p>
<blockquote>
<p>å›å¿†ä¸€ä¸‹ï¼ŒÂ§4.10.2 ä»‹ç»äº†â€œ||â€è¿ç®—ç¬¦ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå®å‚æ˜¯çœŸå€¼çš„è¯å°±è¿”å›ç¬¬ä¸€ä¸ªå®å‚ï¼›å¦åˆ™è¿”å›ç¬¬äºŒä¸ªå®å‚ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œå¦‚æœä½œä¸ºç¬¬äºŒä¸ªå®å‚ä¼ å…¥ä»»æ„å¯¹è±¡ï¼Œé‚£ä¹ˆå‡½æ•°å°±ä¼šä½¿ç”¨è¿™ä¸ªå¯¹è±¡ã€‚å¦‚æœçœç•¥æ‰ç¬¬äºŒä¸ªå®å‚ï¼ˆæˆ–è€…ä¼ é€’ null ä»¥åŠå…¶ä»–ä»»ä½•å‡å€¼ï¼‰ï¼Œé‚£ä¹ˆå°±æ–°åˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„ï¼Œå¹¶èµ‹å€¼ç»™ aã€‚</p>
</blockquote>
<p>Note that when designing functions with optional arguments, you should be sure to put the optional ones at the end of the argument list so that they can be omitted. The programmer who calls your function cannot omit the first argument and pass the second: they would have to explicitly pass undefined as the first argument.</p>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ç”¨è¿™ç§å¯é€‰å®å‚æ¥å®ç°å‡½æ•°æ—¶ï¼Œéœ€è¦å°†å¯é€‰å®å‚æ”¾åœ¨å®å‚åˆ—è¡¨çš„æœ€åã€‚é‚£äº›è°ƒç”¨ä½ çš„å‡½æ•°çš„ç¨‹åºå‘˜æ˜¯æ²¡åŠæ³•çœç•¥ç¬¬ä¸€ä¸ªå®å‚å¹¶ä¼ å…¥ç¬¬äºŒä¸ªå®å‚ï¼Œä»–ä»¬å¿…é¡»æ˜¾åœ°çš„å°† undefined ä¼ å…¥ä½œä¸ºç¬¬ä¸€ä¸ªå®å‚ ã€‚</p>
</blockquote>
<p>In ES6 and later, you can define a default value for each of your function parameters directly in the parameter list of your function. Simply follow the parameter name with an equals sign and the default value to use when no argument is supplied for that parameter:</p>
<blockquote>
<p>åœ¨ ES6 ä¹‹åï¼Œå¯ä»¥ç›´æ¥åœ¨å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸­ä¸ºæ¯ä¸ªå‡½æ•°å‚æ•°å®šä¹‰é»˜è®¤å€¼ã€‚ç›´æ¥åœ¨å‚æ•°ååé¢æ¥ä¸€ä¸ªç­‰å·å†æ¥ä¸€ä¸ªé»˜è®¤å€¼ï¼ˆç”¨äºæ²¡æœ‰å®å‚æä¾›ç»™å‚æ•°æ—¶å‚æ•°çš„å€¼ï¼‰ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Append the names of the enumerable properties of object o to the</span></span><br><span class="line"><span class="comment">// array a, and return a.  If a is omitted, create and return a new array.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getPropertyNames</span>(<span class="params">o, a = []</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> property <span class="keyword">in</span> o) a.<span class="title function_">push</span>(property);</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Parameter default expressions are evaluated when your function is called, not when it is defined, so each time this getPropertyNames() function is invoked with one argument, a new empty array is created and passed.2 It is probably easiest to reason about functions if the parameter defaults are constants (or literal expressions like [] and {}). But this is not required: you can use variables, or function invocations, for example, to compute the default value of a parameter. One interesting case is that, for functions with multiple parameters, you can use the value of a previous parameter to define the default value of the parameters that follow it:</p>
<blockquote>
<p>é»˜è®¤å‚æ•°è¡¨è¾¾å¼åªæœ‰åœ¨å‡½æ•°è°ƒç”¨æ—¶è¿›è¡Œè®¡ç®—ï¼Œè€Œä¸æ˜¯åœ¨å®ƒå®šä¹‰æ—¶ï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡ getPropertyNames() å‡½æ•°åªä¼ ä¸€ä¸ªå®å‚è°ƒç”¨æ—¶ï¼Œä¸€ä¸ªæ–°çš„ç©ºæ•°ç»„è¢«åˆ›å»ºå¹¶ä¼ ç»™å‚æ•°ã€‚2 æœ€å®¹æ˜“ç†è§£çš„å°±æ˜¯å‚æ•°é»˜è®¤å€¼æ˜¯å¸¸é‡ï¼ˆæˆ–è€…å­—é¢é‡è¡¨è¾¾å¼ [] å’Œ {}ï¼‰ã€‚ä½†è¿™å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼šä¸¾ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥ç”¨å˜é‡æˆ–è€…å‡½æ•°è°ƒç”¨ï¼Œè®¡ç®—ä¸€ä¸ªé»˜è®¤å‚æ•°çš„å€¼ã€‚ä¸€ä¸ªå¾ˆæœ‰è¶£çš„æƒ…å†µæ˜¯ï¼Œå¯¹äºæœ‰å¤šä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå¯ä»¥ç”¨å‰é¢çš„å‚æ•°å€¼æ¥å®šä¹‰åé¢çš„å‚æ•°é»˜è®¤å€¼ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This function returns an object representing a rectangle&#x27;s dimensions.</span></span><br><span class="line"><span class="comment">// If only width is supplied, make it twice as high as it is wide.</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">rectangle</span> = (<span class="params">width, height=width*<span class="number">2</span></span>) =&gt; (&#123;width, height&#125;);</span><br><span class="line"><span class="title function_">rectangle</span>(<span class="number">1</span>)  <span class="comment">// =&gt; &#123; width: 1, height: 2 &#125;</span></span><br></pre></td></tr></table></figure>
<p>This code demonstrates that parameter defaults work with arrow functions. The same is true for method shorthand functions and all other forms of function definitions.</p>
<blockquote>
<p>è¿™æ®µä»£ç æè¿°äº†ç®­å¤´å‡½æ•°ä¸­çš„å‚æ•°é»˜è®¤å€¼ã€‚æ–¹æ³•å‡½æ•°å’Œå…¶ä»–å½¢å¼çš„å‡½æ•°å®šä¹‰ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
</blockquote>
<h3 id="8-3-2-Rest-Parameters-and-Variable-Length-Argument-Lists"><a href="#8-3-2-Rest-Parameters-and-Variable-Length-Argument-Lists" class="headerlink" title="8.3.2 Rest Parameters and Variable-Length Argument Lists"></a>8.3.2 Rest Parameters and Variable-Length Argument Lists</h3><p>Parameter defaults enable us to write functions that can be invoked with fewer arguments than parameters. Rest parameters enable the opposite case: they allow us to write functions that can be invoked with arbitrarily more arguments than parameters. Here is an example function that expects one or more numeric arguments and returns the largest one:</p>
<blockquote>
<p>è°ƒç”¨å‡½æ•°æ—¶å…è®¸ä¼ å…¥çš„å®å‚æ¯”å‡½æ•°å£°æ˜æ—¶æŒ‡å®šçš„å½¢å‚ä¸ªæ•°å°‘ã€‚å‰©ä½™å‚æ•°å…è®¸ç›¸åçš„æƒ…å†µï¼šå®ƒå…è®¸æˆ‘ä»¬åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œä¼ å…¥æ¯”å‹å‚å¤šä»»æ„ä¸ªæ•°çš„å®å‚ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¯ä»¥ä¼ å…¥ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å€¼å‹å®å‚çš„ä¾‹å­ï¼Œå¹¶ä¸”è¿”å›å…¶ä¸­æœ€å¤§çš„æ•°ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">max</span>(<span class="params">first=-<span class="literal">Infinity</span>, ...rest</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> maxValue = first; <span class="comment">// Start by assuming the first arg is biggest</span></span><br><span class="line">    <span class="comment">// Then loop through the rest of the arguments, looking for bigger</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> n <span class="keyword">of</span> rest) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &gt; maxValue) &#123;</span><br><span class="line">            maxValue = n;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Return the biggest</span></span><br><span class="line">    <span class="keyword">return</span> maxValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">max</span>(<span class="number">1</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1000</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)  <span class="comment">// =&gt; 1000</span></span><br></pre></td></tr></table></figure>
<p>A rest parameter is preceded by three periods, and it must be the last parameter in a function declaration. When you invoke a function with a rest parameter, the arguments you pass are first assigned to the non-rest parameters, and then any remaining arguments (i.e., the â€œrestâ€ of the arguments) are stored in an array that becomes the value of the rest parameter. This last point is important: within the body of a function, the value of a rest parameter will always be an array. The array may be empty, but a rest parameter will never be undefined. (It follows from this that it is never usefulâ€”and not legalâ€”to define a parameter default for a rest parameter.)</p>
<blockquote>
<p>å‰©ä½™å‚æ•°ç”±ä¸‰ä¸ª . å¼€å§‹ï¼Œå¿…é¡»æ˜¯å‡½æ•°å£°æ˜çš„æœ€åä¸€ä¸ªå‚æ•°ã€‚è°ƒç”¨æœ‰å‰©ä½™å‚æ•°çš„å‡½æ•°æ—¶ï¼Œä¼ é€’çš„å®å‚å…ˆèµ‹å€¼ç»™éå‰©ä½™å‚æ•°ï¼Œç„¶åå…¶ä½™æ‰€æœ‰çš„å®å‚ï¼ˆä¹Ÿå°±æ˜¯â€œå‰©ä½™â€å®å‚ï¼‰å­˜å‚¨åœ¨ä¸€ä¸ªæ•°ç»„ä¸­å˜æˆå‰©ä½™å‚æ•°çš„å€¼ï¼Œæœ€åä¸€ç‚¹éå¸¸é‡è¦ï¼šåœ¨ä¸€ä¸ªå‡½æ•°ä½“ä¸­ï¼Œå‰©ä½™å‚æ•°çš„å€¼æ€»æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„å¯èƒ½æ˜¯ç©ºçš„ï¼Œä½†æ˜¯å‰©ä½™å‚æ•°æ°¸è¿œä¸ä¼šæ˜¯ undefinedã€‚ï¼ˆå› æ­¤ï¼Œä»ä¸ä¼šç»™å‰©ä½™å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œå¹¶ä¸”è¿™ä¹Ÿæ˜¯ä¸åˆæ³•çš„ã€‚ï¼‰</p>
</blockquote>
<p>Functions like the previous example that can accept any number of arguments are called variadic functions, variable arity functions, or vararg functions. This book uses the most colloquial term, varargs, which dates to the early days of the C programming language.</p>
<blockquote>
<p>ç±»ä¼¼è¿™ç§å‡½æ•°å¯ä»¥æ¥æ”¶ä»»æ„ä¸ªæ•°çš„å®å‚ï¼Œè¿™ç§å‡½æ•°ä¹Ÿç§°ä¸ºâ€œä¸å®šå®å‚å‡½æ•°â€ï¼Œè¿™ä¸ªæœ¯è¯­æºè‡ªå¤è€çš„Cè¯­è¨€ã€‚</p>
</blockquote>
<p>Donâ€™t confuse the â€¦ that defines a rest parameter in a function definition with the â€¦ spread operator, described in Â§8.3.4, which can be used in function invocations.</p>
<blockquote>
<p>ä¸è¦æ··æ·† â€¦ å®šä¹‰å‡½æ•°çš„å‰©ä½™å‚æ•°å’Œ â€¦ å±•å¼€è¿ç®—ç¬¦ï¼Œå°†åœ¨ Â§8.3.4 æè¿°å±•å¼€è¿ç®—ç¬¦åœ¨å‡½æ•°è°ƒç”¨ä¸­çš„åº”ç”¨ã€‚</p>
</blockquote>
<h3 id="8-3-3-The-Arguments-Object"><a href="#8-3-3-The-Arguments-Object" class="headerlink" title="8.3.3 The Arguments Object"></a>8.3.3 The Arguments Object</h3><p>Rest parameters were introduced into JavaScript in ES6. Before that version of the language, varargs functions were written using the Arguments object: within the body of any function, the identifier arguments refers to the Arguments object for that invocation. The Arguments object is an array-like object (see Â§7.9) that allows the argument values passed to the function to be retrieved by number, rather than by name. Here is the max() function from earlier, rewritten to use the Arguments object instead of a rest parameter:</p>
<blockquote>
<p>å‰©ä½™å‚æ•°æ˜¯åœ¨ ES6 ä¸­åŠ å…¥çš„æ¦‚å¿µã€‚åœ¨è¿™ä¹‹å‰ï¼Œä¸å®šå®å‚å‡½æ•°æ˜¯ç”¨ Arguments å¯¹è±¡å®ç°çš„ï¼šåœ¨å‡½æ•°ä½“ä¸­ï¼Œæ ‡è¯†ç¬¦ Arguments æ˜¯æŒ‡å‘å®å‚å¯¹è±¡çš„å¼•ç”¨ã€‚Arguments å¯¹è±¡æ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼ˆå‚ç…§ Â§7.9ï¼‰ï¼Œè¿™æ ·å¯ä»¥é€šè¿‡æ•°å­—ä¸‹æ ‡å°±èƒ½è®¿é—®ä¼ å…¥å‡½æ•°çš„å®å‚å€¼ï¼Œè€Œä¸ç”¨éè¦é€šè¿‡åå­—æ¥å¾—åˆ°å®å‚ã€‚ä¸‹é¢çš„ max() å‡½æ•°å°±æ˜¯ä»¥å‰ç”¨ Arguments å¯¹è±¡ä»£æ›¿å‰©ä½™å‚æ•°çš„ä¾‹å­ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">max</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> maxValue = -<span class="title class_">Infinity</span>;</span><br><span class="line">    <span class="comment">// Loop through the arguments, looking for, and remembering, the biggest.</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">arguments</span>[i] &gt; maxValue) maxValue = <span class="variable language_">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Return the biggest</span></span><br><span class="line">    <span class="keyword">return</span> maxValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">max</span>(<span class="number">1</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1000</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)  <span class="comment">// =&gt; 1000</span></span><br></pre></td></tr></table></figure>
<p>The Arguments object dates back to the earliest days of JavaScript and carries with it some strange historical baggage that makes it inefficient and hard to optimize, especially outside of strict mode. You may still encounter code that uses the Arguments object, but you should avoid using it in any new code you write. When refactoring old code, if you encounter a function that uses arguments, you can often replace it with a â€¦args rest parameter. Part of the unfortunate legacy of the Arguments object is that, in strict mode, arguments is treated as a reserved word, and you cannot declare a function parameter or a local variable with that name.</p>
<blockquote>
<p>Arguments å¯¹è±¡å¯è¿½æº¯åˆ° JavaScript çš„æœ€æ—©æ—¶ä»£ï¼Œå¹¶å¸¦æœ‰ä¸€äº›å¥‡æ€ªçš„å†å²åŒ…è¢±ï¼Œè¿™ä½¿å¾—å®ƒæ•ˆç‡ä½ä¸‹ä¸”éš¾ä»¥ä¼˜åŒ–ï¼Œå°¤å…¶æ˜¯ä¸åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ã€‚å¯èƒ½è¿˜ä¼šé‡åˆ°ä¸€äº›ä»£ç ä½¿ç”¨ Arguments å¯¹è±¡ï¼Œä½†æ˜¯åœ¨ç¼–å†™æ–°ä»£ç æ—¶è¦é¿å…ä½¿ç”¨ï¼Œå¯ä»¥ç”¨ â€¦ å‰©ä½™å‡½æ•°æ¥æ›¿ä»£ã€‚Arguments å¯¹è±¡è¿˜æœ‰éƒ¨åˆ†ä»¤äººé—æ†¾çš„é—äº§ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œarguments è¢«è§†ä¸ºä¿ç•™å­—ï¼Œä¸èƒ½å£°æ˜å…·æœ‰è¯¥åç§°çš„å±€éƒ¨å˜é‡æ¥å®šä¹‰å‡½æ•°çš„å‚æ•°ã€‚</p>
</blockquote>
<h3 id="8-3-4-The-Spread-Operator-for-Function-Calls"><a href="#8-3-4-The-Spread-Operator-for-Function-Calls" class="headerlink" title="8.3.4 The Spread Operator for Function Calls"></a>8.3.4 The Spread Operator for Function Calls</h3><p>The spread operator â€¦ is used to unpack, or â€œspread out,â€ the elements of an array (or any other iterable object, such as strings) in a context where individual values are expected. Weâ€™ve seen the spread operator used with array literals in Â§7.1.2. The operator can be used, in the same way, in function invocations:</p>
<blockquote>
<p>å½“éœ€è¦å•ä¸ªå€¼æ—¶ï¼Œâ€¦ å±•å¼€è¿ç®—ç¬¦ç”¨æ¥æ‹†åŒ…ï¼Œæˆ–è€…è¯´å°†å…ƒç´ ä»æ•°ç»„ï¼ˆæˆ–è€…å…¶ä»–çš„ä»»ä½•å’Œè¿­ä»£å¯¹è±¡ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ï¼‰ä¸­â€œå±•å¼€â€åˆ°ä¸Šä¸‹æ–‡ã€‚æˆ‘ä»¬å·²ç»åœ¨ Â§7.1.2 è§åˆ°äº†å±•å¼€è¿ç®—ç¬¦åœ¨æ•°ç»„å­—é¢é‡ä¸Šçš„ä½¿ç”¨ã€‚å±•å¼€è¿ç®—ç¬¦å¯ä»¥åœ¨å‡½æ•°è°ƒç”¨ä¸­ä»¥åŒæ ·æ–¹å¼ä½¿ç”¨ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">5</span>, <span class="number">2</span>, <span class="number">10</span>, -<span class="number">1</span>, <span class="number">9</span>, <span class="number">100</span>, <span class="number">1</span>];</span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">min</span>(...numbers)  <span class="comment">// =&gt; -1</span></span><br></pre></td></tr></table></figure>
<p>Note that â€¦ is not a true operator in the sense that it cannot be evaluated to produce a value. Instead, it is a special JavaScript syntax that can be used in array literals and function invocations.</p>
<blockquote>
<p>æ³¨æ„ â€¦ ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„è¿ç®—ç¬¦ï¼Œå› ä¸ºå®ƒä¸èƒ½é€šè¿‡è®¡ç®—æ¥æä¾›ä¸€ä¸ªå€¼ã€‚å®ƒæ˜¯ä¸€ä¸ªå¯ä»¥ç”¨åœ¨æ•°ç»„å­—é¢é‡å’Œå‡½æ•°è°ƒç”¨ä¸­çš„ç‰¹æ®Šçš„ JavaScript è¯­æ³•ã€‚</p>
</blockquote>
<p>When we use the same â€¦ syntax in a function definition rather than a function invocation, it has the opposite effect to the spread operator. As we saw in Â§8.3.2, using â€¦ in a function definition gathers multiple function arguments into an array. Rest parameters and the spread operator are often useful together, as in the following function, which takes a function argument and returns an instrumented version of the function for testing: </p>
<blockquote>
<p>åœ¨å‡½æ•°å®šä¹‰å’Œå‡½æ•°è°ƒç”¨ä¸­ä½¿ç”¨ç›¸åŒçš„ â€¦ è¯­æ³•æ—¶ï¼Œå’Œå±•å¼€è¿ç®—ç¬¦æœ‰ç€ç›¸ä»¿çš„æ•ˆæœã€‚åœ¨ Â§8.3.2 ä¸­æˆ‘ä»¬çœ‹åˆ°å‡½æ•°å®šä¹‰ä½¿ç”¨ â€¦ å°†å¤æ•°ä¸ªå‡½æ•°å®å‚åˆå¹¶åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ã€‚å‰©ä½™å‚æ•°å’Œå±•å¼€è¿ç®—ç¬¦ç»å¸¸ä¸€åŒä½¿ç”¨ï¼Œå°±åƒä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This function takes a function and returns a wrapped version</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">timed</span>(<span class="params">f</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>) &#123;  <span class="comment">// Collect args into a rest parameter array</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Entering function <span class="subst">$&#123;f.name&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">let</span> startTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// Pass all of our arguments to the wrapped function</span></span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">f</span>(...args);  <span class="comment">// Spread the args back out again</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// Before we return the wrapped return value, print elapsed time.</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Exiting <span class="subst">$&#123;f.name&#125;</span> after <span class="subst">$&#123;<span class="built_in">Date</span>.now()-startTime&#125;</span>ms`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Compute the sum of the numbers between 1 and n by brute force</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">benchmark</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= n; i++) sum += i;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Now invoke the timed version of that test function</span></span><br><span class="line"><span class="title function_">timed</span>(benchmark)(<span class="number">1000000</span>) <span class="comment">// =&gt; 500000500000; this is the sum of the numbers</span></span><br></pre></td></tr></table></figure>
<h3 id="8-3-5-Destructuring-Function-Arguments-into-Parameters"><a href="#8-3-5-Destructuring-Function-Arguments-into-Parameters" class="headerlink" title="8.3.5 Destructuring Function Arguments into Parameters"></a>8.3.5 Destructuring Function Arguments into Parameters</h3><p>When you invoke a function with a list of argument values, those values end up being assigned to the parameters declared in the function definition. This initial phase of function invocation is a lot like variable assignment. So it should not be surprising that we can use the techniques of destructuring assignment (see Â§3.10.3) with functions.</p>
<blockquote>
<p>ç”¨å®å‚åˆ—è¡¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œå®å‚çš„å€¼æœ€ç»ˆèµ‹å€¼ç»™å‡½æ•°å®šä¹‰çš„å‚æ•°ã€‚å‡½æ•°è°ƒç”¨åˆå§‹åŒ–é˜¶æ®µéå¸¸åƒå˜é‡èµ‹å€¼ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸å¿…æƒŠè®¶äºå¯ä»¥å°†è§£æ„èµ‹å€¼ï¼ˆè§ Â§3.10.3ï¼‰ç”¨äºå‡½æ•°ã€‚</p>
</blockquote>
<p>If you define a function that has parameter names within square brackets, you are telling the function to expect an array value to be passed for each pair of square brackets. As part of the invocation process, the array arguments will be unpacked into the individually named parameters. As an example, suppose we are representing 2D vectors as arrays of two numbers, where the first element is the X coordinate and the second element is the Y coordinate. With this simple data structure, we could write the following function to add two vectors:</p>
<blockquote>
<p>å¦‚æœä¸€ä¸ªå‡½æ•°çš„å‚æ•°å¸¦æœ‰æ–¹æ‹¬å·ï¼Œå°±è¯´æ˜å‡½æ•°è¦ç»™æ¯ä¸€ä¸ªæ–¹æ‹¬å·ä¼ ä¸€ä¸ªæ•°ç»„ã€‚åœ¨ä¸€ä¸ªè°ƒç”¨è¿›ç¨‹ä¸­ï¼Œæ•°ç»„å®å‚ä¼šè¢«æ‹†åŒ…ä¼ é€’ç»™å¯¹åº”çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬å°† 2D çŸ¢é‡è¡¨ç¤ºä¸ºä¸¤ä¸ªæ•°å­—çš„æ•°ç»„ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ X åæ ‡ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯ Y åæ ‡ã€‚ç”¨è¿™ä¸ªç®€å•çš„æ•°æ®ç»“æ„ï¼Œç¼–å†™ä¸‹é¢è¿™ä¸ªå‡½æ•°è®¡ç®—ä¸¤ä¸ªçŸ¢é‡çš„å’Œï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">vectorAdd</span>(<span class="params">v1, v2</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [v1[<span class="number">0</span>] + v2[<span class="number">0</span>], v1[<span class="number">1</span>] + v2[<span class="number">1</span>]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">vectorAdd</span>([<span class="number">1</span>,<span class="number">2</span>], [<span class="number">3</span>,<span class="number">4</span>])  <span class="comment">// =&gt; [4,6]</span></span><br></pre></td></tr></table></figure>
<p>The code would be easier to understand if we destructured the two vector arguments into more clearly named parameters:</p>
<blockquote>
<p>å¦‚æœä¸‹é¢è¿™ç§æ–¹å¼è§£æ„è¿™ä¸¤ä¸ªçŸ¢é‡å®å‚ï¼Œè¿™æ®µä»£ç å°†æ›´å®¹æ˜“ç†è§£ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">vectorAdd</span>(<span class="params">[x1,y1], [x2,y2]</span>) &#123; <span class="comment">// Unpack 2 arguments into 4 parameters</span></span><br><span class="line">    <span class="keyword">return</span> [x1 + x2, y1 + y2];</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">vectorAdd</span>([<span class="number">1</span>,<span class="number">2</span>], [<span class="number">3</span>,<span class="number">4</span>])  <span class="comment">// =&gt; [4,6]</span></span><br></pre></td></tr></table></figure>
<p>Similarly, if you are defining a function that expects an object argument, you can destructure parameters of that object. Letâ€™s use a vector example again, except this time, letâ€™s suppose that we represent vectors as objects with x and y parameters:</p>
<blockquote>
<p>åŒæ ·ï¼Œå¦‚æœå®šä¹‰ä¸€ä¸ªå‡½æ•°æ—¶éœ€è¦å¯¹è±¡å®å‚ï¼Œä½ èƒ½å¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œå‚æ•°è§£æ„ã€‚å†æ¬¡å®ç”¨çŸ¢é‡çš„ä¾‹å­ï¼Œè¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬ç”¨ x å’Œ y å‚æ•°åŒ…è£…æˆå¯¹è±¡æ¥æè¿°çŸ¢é‡ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Multiply the vector &#123;x,y&#125; by a scalar value</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">vectorMultiply</span>(<span class="params">&#123;x, y&#125;, scalar</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">x</span>: x*scalar, <span class="attr">y</span>: y*scalar &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">vectorMultiply</span>(&#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>&#125;, <span class="number">2</span>)  <span class="comment">// =&gt; &#123;x: 2, y: 4&#125;</span></span><br></pre></td></tr></table></figure>
<p>This example of destructuring a single object argument into two parameters is a fairly clear one because the parameter names we use match the property names of the incoming object. The syntax is more verbose and more confusing when you need to destructure properties with one name into parameters with different names. Hereâ€™s the vector addition example, implemented for object-based vectors:</p>
<blockquote>
<p>è¿™ä¸ªä¾‹å­å°†ä¸€ä¸ªç®€å•çš„å¯¹è±¡å®å‚è§£æ„æˆä¸¤ä¸ªå‚æ•°æ˜¯å¾ˆç®€å•çš„ï¼Œå› ä¸ºå‚æ•°çš„åå­—å’Œæˆ‘ä»¬åœ¨å¯¹è±¡ä¸­ä½¿ç”¨çš„å±æ€§åæ˜¯åŒ¹é…çš„ã€‚å½“æ‚¨éœ€è¦å°†åŒä¸€ä¸ªåç§°çš„å±æ€§è§£æ„ä¸ºå…·æœ‰ä¸åŒåç§°çš„å‚æ•°æ—¶ï¼Œè¯­æ³•æ›´åŠ å†—é•¿å’Œéš¾æ‡‚ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªçŸ¢é‡åŠ æ³•çš„ä¾‹å­ï¼ŒåŸºäºå¯¹è±¡çŸ¢é‡çš„å®ç°ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">vectorAdd</span>(<span class="params"></span></span><br><span class="line"><span class="params">    &#123;x: x1, y: y1&#125;, <span class="comment">// Unpack 1st object into x1 and y1 params</span></span></span><br><span class="line"><span class="params">    &#123;x: x2, y: y2&#125;  <span class="comment">// Unpack 2nd object into x2 and y2 params</span></span></span><br><span class="line"><span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">x</span>: x1 + x2, <span class="attr">y</span>: y1 + y2 &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">vectorAdd</span>(&#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">4</span>&#125;)  <span class="comment">// =&gt; &#123;x: 4, y: 6&#125;</span></span><br></pre></td></tr></table></figure>
<p>The tricky thing about destructuring syntax like {x:x1, y:y1} is remembering which are the property names and which are the parameter names. The rule to keep in mind for destructuring assignment and destructuring function calls is that the variables or parameters being declared go in the spots where youâ€™d expect values to go in an object literal. So property names are always on the lefthand side of the colon, and the parameter (or variable) names are on the right.</p>
<blockquote>
<p>åƒ {x:x1, y:y1} çš„è§£æ„è¯­æ³•æ£˜æ‰‹çš„æ˜¯è®°ä½å“ªä¸€ä¸ªæ˜¯å±æ€§åå“ªä¸€ä¸ªæ˜¯å‚æ•°åã€‚ç‰¢è®°è§£æ„èµ‹å€¼å’Œè§£æ„å‡½æ•°è°ƒç”¨çš„è§„åˆ™ï¼Œå£°æ˜çš„å˜é‡æˆ–å‚æ•°åœ¨å¯¹è±¡å­—é¢é‡ä¸­çš„ä½ç½®å›ºå®šã€‚å±æ€§åæ€»æ˜¯åœ¨å†’å·çš„å·¦è¾¹ï¼Œå‚æ•°ï¼ˆæˆ–å˜é‡ï¼‰ååœ¨å³è¾¹ã€‚</p>
</blockquote>
<p>You can define parameter defaults with destructured parameters. Hereâ€™s vector multiplication that works with 2D or 3D vectors:</p>
<blockquote>
<p>å¯ä»¥ä½¿ç”¨è§£æ„å‚æ•°å®šä¹‰å‚æ•°é»˜è®¤å€¼ã€‚ä¸‹é¢æ˜¯é€‚ç”¨äº 2D æˆ– 3D çŸ¢é‡çš„çŸ¢é‡ä¹˜æ³•ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Multiply the vector &#123;x,y&#125; or &#123;x,y,z&#125; by a scalar value</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">vectorMultiply</span>(<span class="params">&#123;x, y, z=<span class="number">0</span>&#125;, scalar</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">x</span>: x*scalar, <span class="attr">y</span>: y*scalar, <span class="attr">z</span>: z*scalar &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">vectorMultiply</span>(&#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>&#125;, <span class="number">2</span>)  <span class="comment">// =&gt; &#123;x: 2, y: 4, z: 0&#125;</span></span><br></pre></td></tr></table></figure>
<p>Some languages (like Python) allow the caller of a function to invoke a function with arguments specified in name&#x3D;value form, which is convenient when there are many optional arguments or when the parameter list is long enough that it is hard to remember the correct order. JavaScript does not allow this directly, but you can approximate it by destructuring an object argument into your function parameters. Consider a function that copies a specified number of elements from one array into another array with optionally specified starting offsets for each array. Since there are five possible parameters, some of which have defaults, and it would be hard for a caller to remember which order to pass the arguments in, we can define and invoke the arraycopy() function like this:</p>
<blockquote>
<p>ä¸€äº›è¯­è¨€ï¼ˆåƒ Pythonï¼‰å…è®¸å‡½æ•°çš„è°ƒç”¨è€…ä»¥ name&#x3D;value å‹å¼æŒ‡å®šå®å‚ï¼Œè¿™åœ¨æœ‰å¾ˆå¤šå¯é€‰å®å‚æˆ–è€…å‚æ•°åˆ—è¡¨é•¿åˆ°éš¾ä»¥è®°ä½æ­£ç¡®çš„é¡ºåºæ—¶æ˜¯éå¸¸æ–¹ä¾¿çš„ã€‚JavaScript ä¸å…è®¸ç›´æ¥è¿™æ ·åšï¼Œä½†å¯ä»¥é€šè¿‡è§£æ„å¯¹è±¡å®å‚åˆ°å‡½æ•°å‚æ•°ä¸­ã€‚æ„æ€ä¸€ä¸ªå‡½æ•°å°†æŒ‡å®šæ•°é‡çš„å…ƒç´ ä»ä¸€ä¸ªæ•°ç»„å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¯ä»¥éšæ„åœ°ä¸ºæ¯ä¸ªæ•°ç»„æŒ‡å®šèµ·å§‹åç§»é‡ã€‚å¦‚ä¸‹æœ‰äº”ä¸ªå¯ä¼ å…¥å‚æ•°ï¼Œå…¶ä¸­ä¸€äº›æœ‰é»˜è®¤å€¼ï¼Œå¹¶ä¸”è°ƒç”¨è€…å¾ˆéš¾è®°ä½å‚æ•°çš„é¡ºåºæ¥ä¼ é€’å®å‚ï¼Œå¯ä»¥åƒè¿™æ ·å®šä¹‰å’Œè°ƒç”¨ arraycopy() æ–¹æ³•ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">arraycopy</span>(<span class="params">&#123;<span class="keyword">from</span>, to=<span class="keyword">from</span>, n=<span class="keyword">from</span>.length, fromIndex=<span class="number">0</span>, toIndex=<span class="number">0</span>&#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> valuesToCopy = <span class="keyword">from</span>.<span class="title function_">slice</span>(fromIndex, fromIndex + n);</span><br><span class="line">    to.<span class="title function_">splice</span>(toIndex, <span class="number">0</span>, ...valuesToCopy);</span><br><span class="line">    <span class="keyword">return</span> to;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], b = [<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">5</span>];</span><br><span class="line"><span class="title function_">arraycopy</span>(&#123;<span class="attr">from</span>: a, <span class="attr">n</span>: <span class="number">3</span>, <span class="attr">to</span>: b, <span class="attr">toIndex</span>: <span class="number">4</span>&#125;) <span class="comment">// =&gt; [9,8,7,6,1,2,3,5]</span></span><br></pre></td></tr></table></figure>
<p>When you destructure an array, you can define a rest parameter for extra values within the array that is being unpacked. That rest parameter within the square brackets is completely different than the true rest parameter for the function:</p>
<blockquote>
<p>å½“è§£æ„ä¸€ä¸ªæ•°ç»„ï¼Œåœ¨å…¶è¢«æ‹†åŒ…æ—¶ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªå‰©ä½™å‚æ•°å°†å…¶ä½™å€¼æ”¾åœ¨æ•°ç»„ä¸­ã€‚ åœ¨æ–¹æ‹¬å·ä¸­çš„å‰©ä½™å‚æ•°å’ŒçœŸæ­£çš„å‡½æ•°ä¸­çš„å‰©ä½™å‚æ•°æ˜¯å®Œå…¨ä¸åŒçš„ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This function expects an array argument. The first two elements of that</span></span><br><span class="line"><span class="comment">// array are unpacked into the x and y parameters. Any remaining elements</span></span><br><span class="line"><span class="comment">// are stored in the coords array. And any arguments after the first array</span></span><br><span class="line"><span class="comment">// are packed into the rest array.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">[x, y, ...coords], ...rest</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [x+y, ...rest, ...coords];  <span class="comment">// Note: spread operator here</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">f</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="number">5</span>, <span class="number">6</span>)   <span class="comment">// =&gt; [3, 5, 6, 3, 4]</span></span><br></pre></td></tr></table></figure>
<p>In ES2018, you can also use a rest parameter when you destructure an object. The value of that rest parameter will be an object that has any properties that did not get destructured. Object rest parameters are often useful with the object spread operator, which is also a new feature of ES2018:</p>
<blockquote>
<p>åœ¨ ES2018ï¼Œä¹Ÿå¯ä»¥ç”¨å‰©ä½™å‚æ•°è§£æ„å¯¹è±¡ã€‚å‰©ä½™å‚æ•°æ˜¯ä¸€ä¸ªæ²¡æœ‰è§£æ„çš„å±æ€§çš„å¯¹è±¡ã€‚å¯¹è±¡å‰©ä½™å‚æ•°ç»å¸¸ä¸å¯¹è±¡å±•å¼€è¿ç®—ç¬¦è¿ç”¨ï¼Œè¿™æ˜¯ ES2018 çš„æ–°ç‰¹æ€§ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Multiply the vector &#123;x,y&#125; or &#123;x,y,z&#125; by a scalar value, retain other props</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">vectorMultiply</span>(<span class="params">&#123;x, y, z=<span class="number">0</span>, ...props&#125;, scalar</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">x</span>: x*scalar, <span class="attr">y</span>: y*scalar, <span class="attr">z</span>: z*scalar, ...props &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">vectorMultiply</span>(&#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">w</span>: -<span class="number">1</span>&#125;, <span class="number">2</span>)  <span class="comment">// =&gt; &#123;x: 2, y: 4, z: 0, w: -1&#125;</span></span><br></pre></td></tr></table></figure>
<p>Finally, keep in mind that, in addition to destructuring argument objects and arrays, you can also destructure arrays of objects, objects that have array properties, and objects that have object properties, to essentially any depth. Consider graphics code that represents circles as objects with x, y, radius, and color properties, where the color property is an array of red, green, and blue color components. You might define a function that expects a single circle object to be passed to it but destructures that circle object into six separate parameters:</p>
<blockquote>
<p>æœ€åï¼Œè¯·è®°ä½ï¼Œé™¤äº†å¯ä»¥è§£æ„å®å‚å¯¹è±¡å’Œæ•°ç»„ï¼Œä¹Ÿå¯ä»¥è§£æ„æ•°ç»„å¯¹è±¡ï¼Œå¯¹è±¡æœ‰æ•°ç»„å±æ€§ï¼Œå¹¶ä¸”å¯¹è±¡è¿˜æœ‰å¯¹è±¡çš„å±æ€§ã€‚æ„æ€ä¸€ä¸ªå°†åœ†è¡¨ç¤ºä¸ºå…·æœ‰ xã€yã€åŠå¾„å’Œé¢œè‰²å±æ€§çš„å¯¹è±¡çš„å›¾å½¢ä»£ç ï¼Œé¢œè‰²å±æ€§æ˜¯ä¸€ä¸ªæ•°ç»„ç”± RGB ç»„æˆã€‚ä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å¸Œæœ›å°†å•ä¸ªåœ†å¯¹è±¡ä¼ é€’ç»™å®ƒï¼Œä½†å…¶è§£æ„ä¸ºå…­ä¸ªå•ç‹¬çš„å‚æ•°ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">drawCircle</span>(<span class="params">&#123;x, y, radius, color: [r, g, b]&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// Not yet implemented</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If function argument destructuring is any more complicated than this, I find that the code becomes harder to read, rather than simpler. Sometimes, it is clearer to be explicit about your object property access and array indexing.</p>
<blockquote>
<p>å¦‚æœå‡½æ•°å®å‚è§£æ„æ¯”è¿™æ›´å¤æ‚ï¼Œä»£ç ä¼šå˜å¾—æ›´éš¾è¯»ï¼Œè€Œä¸æ˜¯æ›´ç®€å•ã€‚æœ‰æ—¶ï¼Œæ˜¾ç¤ºåœ°å¯¹å¯¹è±¡å±æ€§è®¿é—®å’Œæ•°ç»„ç´¢å¼•ä¼šè®©ä»£ç æ›´æ¸…æ™°ã€‚</p>
</blockquote>
<h3 id="8-3-6-Argument-Types"><a href="#8-3-6-Argument-Types" class="headerlink" title="8.3.6 Argument Types"></a>8.3.6 Argument Types</h3><p>JavaScript method parameters have no declared types, and no type checking is performed on the values you pass to a function. You can help make your code self-documenting by choosing descriptive names for function arguments and by documenting them carefully in the comments for each function. (Alternatively, see Â§17.8 for a language extension that allows you to layer type checking on top of regular JavaScript.)</p>
<blockquote>
<p>JavaScript æ–¹æ³•çš„å½¢å‚å¹¶æœªå£°æ˜ç±»å‹ï¼Œåœ¨å½¢å‚ä¼ å…¥å‡½æ•°ä½“ä¹‹å‰ä¹Ÿæœªåšä»»ä½•ç±»å‹æ£€æŸ¥ã€‚å¯ä»¥é‡‡ç”¨è¯­ä¹‰åŒ–çš„å•è¯æ¥ç»™å‡½æ•°å®å‚å‘½åï¼Œå¹¶åœ¨å‡½æ•°æ³¨é‡Šç»™æ¯ä¸€ä¸ªå®å‚è¯¦ç»†æè¿°ï¼Œä»¥æ­¤ä½¿ä»£ç è‡ªæ–‡æœ¬åŒ–ã€‚</p>
</blockquote>
<p>As described in Â§3.9, JavaScript performs liberal type conversion as needed. So if you write a function that expects a string argument and then call that function with a value of some other type, the value you passed will simply be converted to a string when the function tries to use it as a string. All primitive types can be converted to strings, and all objects have toString() methods (if not necessarily useful ones), so an error never occurs in this case.</p>
<blockquote>
<p>Â§3.9 å·²ç»æåˆ°ï¼ŒJavaScript åœ¨å¿…è¦æ—¶ä¼šè¿›è¡Œç±»å‹è½¬æ¢ã€‚å› æ­¤å¦‚æœå‡½æ•°æœŸ æœ›æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²å®å‚ï¼Œè€Œè°ƒç”¨å‡½æ•°æ—¶ä¼ å…¥å…¶ä»–ç±»å‹çš„å€¼ï¼Œæ‰€ä¼ å…¥çš„å€¼ä¼šåœ¨å‡½æ•°ä½“å†…å°†å…¶ç”¨åšå­—ç¬¦ä¸²çš„åœ°æ–¹è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹ã€‚æ‰€æœ‰çš„åŸå§‹ç±»å‹éƒ½å¯ä»¥è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½åŒ…å« toString() æ–¹æ³•ï¼ˆå°½ç®¡ä¸ä¸€å®šæœ‰ç”¨ï¼‰ï¼Œæ‰€ä»¥è¿™ç§åœºæ™¯ä¸‹æ˜¯ä¸ä¼šæœ‰ä»»ä½•é”™è¯¯çš„ã€‚</p>
</blockquote>
<p>This is not always true, however. Consider again the arraycopy() method shown earlier. It expects one or two array arguments and will fail if these arguments are of the wrong type. Unless you are writing a private function that will only be called from nearby parts of your code, it may be worth adding code to check the types of arguments like this. It is better for a function to fail immediately and predictably when passed bad values than to begin executing and fail later with an error message that is likely to be unclear. Here is an example function that performs type-checking:</p>
<blockquote>
<p>ç„¶è€Œäº‹æƒ…ä¸æ€»æ˜¯è¿™æ ·ï¼Œå›å¤´çœ‹ä¸€ä¸‹åˆšæ‰æåˆ°çš„ arraycopy() æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æœŸæœ›è·å¾—ä¸€ä¸ªæˆ–ä¸¤ä¸ªå®å‚ï¼Œå¹¶ä¸”è¿™äº›å®å‚çš„ç±»å‹é”™è¯¯ä¼šå¯¼è‡´å‡½æ•°æ‰§è¡Œå¤±è´¥ã€‚é™¤éæ‰€å†™çš„ç§æœ‰å‡½æ•°åªä¼šè¢«é™„è¿‘çš„ä»£ç è°ƒç”¨ï¼Œä½ åº”å½“æ·»åŠ ç±»ä¼¼çš„å®å‚ç±»å‹æ£€æŸ¥é€»è¾‘ã€‚å› ä¸ºå®æ„¿ç¨‹åºåœ¨ä¼ å…¥éæ³•å€¼æ—¶æŠ¥é”™ï¼Œä¹Ÿä¸æ„¿éæ³•å€¼å¯¼è‡´ç¨‹åºåœ¨æ‰§è¡Œæ—¶æŠ¥é”™ï¼Œç›¸æ¯”è€Œè¨€ï¼Œé€»è¾‘æ‰§è¡Œæ—¶çš„æŠ¥é”™æ¶ˆæ¯ä¸ç”šæ¸…æ™°ä¸”æ›´éš¾å¤„ç†ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­çš„å‡½æ•°å°±åšäº†è¿™ç§ç±»å‹æ£€æŸ¥ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Return the sum of the elements an iterable object a.</span></span><br><span class="line"><span class="comment">// The elements of a must all be numbers.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> total = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> element <span class="keyword">of</span> a) &#123; <span class="comment">// Throws TypeError if a is not iterable</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> element !== <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&quot;sum(): elements must be numbers&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        total += element;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">sum</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])    <span class="comment">// =&gt; 6</span></span><br><span class="line"><span class="title function_">sum</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);   <span class="comment">// !TypeError: 1 is not iterable</span></span><br><span class="line"><span class="title function_">sum</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="string">&quot;3&quot;</span>]); <span class="comment">// !TypeError: element 2 is not a number</span></span><br></pre></td></tr></table></figure>
<h2 id="8-4-Functions-as-Values"><a href="#8-4-Functions-as-Values" class="headerlink" title="8.4 Functions as Values"></a>8.4 Functions as Values</h2><p>The most important features of functions are that they can be defined and invoked. Function definition and invocation are syntactic features of JavaScript and of most other programming languages. In JavaScript, however, functions are not only syntax but also values, which means they can be assigned to variables, stored in the properties of objects or the elements of arrays, passed as arguments to functions, and so on.3</p>
<blockquote>
<p>å‡½æ•°å¯ä»¥å®šä¹‰ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨ï¼Œè¿™æ˜¯å‡½æ•°æœ€é‡è¦çš„ç‰¹æ€§ã€‚å‡½æ•°å®šä¹‰å’Œè°ƒç”¨æ˜¯  JavaScript çš„è¯æ³•ç‰¹æ€§ï¼Œå¯¹äºå…¶ä»–å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€æ¥è¯´äº¦æ˜¯å¦‚æ­¤ã€‚ç„¶è€Œåœ¨ JavaScript ä¸­ï¼Œå‡½æ•°ä¸ä»…æ˜¯ä¸€ç§è¯­æ³•ï¼Œä¹Ÿæ˜¯å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥å°†å‡½æ•°èµ‹å€¼ç»™å˜é‡ï¼Œå­˜å‚¨åœ¨å¯¹è±¡çš„å±æ€§æˆ–æ•°ç»„çš„å…ƒç´ ä¸­ï¼Œä½œä¸ºå‚æ•°ä¼ å…¥å¦å¤–ä¸€ä¸ªå‡½æ•°ç­‰ã€‚3</p>
</blockquote>
<p>To understand how functions can be JavaScript data as well as JavaScript syntax, consider this function definition:</p>
<blockquote>
<p>ä¸ºäº†ä¾¿äºç†è§£ JavaScript ä¸­çš„å‡½æ•°æ˜¯å¦‚ä½•ç”¨åš Javascript æ•°æ®ä»¥åŠ JavaScript è¯­æ³•çš„ï¼Œæ¥çœ‹ä¸€ä¸‹è¿™æ ·ä¸€ä¸ªå‡½æ•°å®šä¹‰ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">square</span>(<span class="params">x</span>) &#123; <span class="keyword">return</span> x*x; &#125;</span><br></pre></td></tr></table></figure>
<p>This definition creates a new function object and assigns it to the variable square. The name of a function is really immaterial; it is simply the name of a variable that refers to the function object. The function can be assigned to another variable and still work the same way:</p>
<blockquote>
<p>è¿™ä¸ªå®šä¹‰åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°å¯¹è±¡ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™å˜é‡ squareã€‚å‡½æ•°çš„åå­—å®é™…ä¸Šæ˜¯æ— å½¢çš„ï¼Œå®ƒï¼ˆsquareï¼‰ä»…ä»…æ˜¯å˜é‡çš„åç§°ï¼Œè¿™ä¸ªå˜é‡æ˜¯å‡½æ•°å¯¹è±¡çš„å¼•ç”¨ã€‚å‡½æ•°è¿˜å¯ä»¥èµ‹å€¼ç»™å…¶ä»–çš„å˜é‡ï¼Œå¹¶ä¸”ä»å¯ä»¥æ­£å¸¸å·¥ä½œï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = square;  <span class="comment">// Now s refers to the same function that square does</span></span><br><span class="line"><span class="title function_">square</span>(<span class="number">4</span>)        <span class="comment">// =&gt; 16</span></span><br><span class="line"><span class="title function_">s</span>(<span class="number">4</span>)             <span class="comment">// =&gt; 16</span></span><br></pre></td></tr></table></figure>
<p>Functions can also be assigned to object properties rather than variables. As weâ€™ve already discussed, we call the functions â€œmethodsâ€ when we do this:</p>
<blockquote>
<p>é™¤äº†å¯ä»¥å°†å‡½æ•°èµ‹å€¼ç»™å˜é‡ï¼ŒåŒæ ·å¯ä»¥å°†å‡½æ•°èµ‹å€¼ç»™å¯¹è±¡çš„å±æ€§ã€‚å½“å‡½æ•°ä½œä¸ºå¯¹è±¡çš„å±æ€§è°ƒç”¨æ—¶ï¼Œå‡½æ•°å°±ç§°ä¸ºâ€œæ–¹æ³•â€ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;<span class="attr">square</span>: <span class="keyword">function</span>(<span class="params">x</span>) &#123; <span class="keyword">return</span> x*x; &#125;&#125;; <span class="comment">// An object literal</span></span><br><span class="line"><span class="keyword">let</span> y = o.<span class="title function_">square</span>(<span class="number">16</span>);                          <span class="comment">// y == 256</span></span><br></pre></td></tr></table></figure>
<p>Functions donâ€™t even require names at all, as when theyâ€™re assigned to array elements:</p>
<blockquote>
<p>å‡½æ•°ç”šè‡³ä¸éœ€è¦å¸¦åå­—ï¼Œå°±åƒæŠŠå®ƒä»¬èµ‹å€¼ç»™æ•°ç»„å…ƒç´ ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="function"><span class="params">x</span> =&gt;</span> x*x, <span class="number">20</span>]; <span class="comment">// An array literal</span></span><br><span class="line">a[<span class="number">0</span>](a[<span class="number">1</span>])              <span class="comment">// =&gt; 400</span></span><br></pre></td></tr></table></figure>
<p>The syntax of this last example looks strange, but it is still a legal function invocation expression!</p>
<blockquote>
<p>ä¸Šé¢çš„ä¾‹å­çœ‹èµ·æ¥å¾ˆå¥‡æ€ªï¼Œä½†çš„ç¡®æ˜¯åˆæ³•çš„å‡½æ•°è°ƒç”¨è¡¨è¾¾å¼ï¼</p>
</blockquote>
<p>As an example of how useful it is to treat functions as values, consider the Array.sort() method. This method sorts the elements of an array. Because there are many possible orders to sort by (numerical order, alphabetical order, date order, ascending, descending, and so on), the sort() method optionally takes a function as an argument to tell it how to perform the sort. This function has a simple job: for any two values it is passed, it returns a value that specifies which element would come first in a sorted array. This function argument makes Array.sort() perfectly general and infinitely flexible; it can sort any type of data into any conceivable order. Examples are shown in Â§7.8.6.</p>
<blockquote>
<p>ä¸¾ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜å°†å‡½æ•°å½“ä½œå€¼æ¥å¯¹å¾…çš„ç›Šå¤„ï¼Œè€ƒè™‘ä¸‹ Array.sort() æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ç”¨æ¥å¯¹æ•°ç»„å…ƒç´ è¿›è¡Œæ’åºã€‚å› ä¸ºæ’åºçš„è§„åˆ™æœ‰å¾ˆå¤šï¼ˆåŸºäºæ•°å€¼å¤§å°ã€å­—æ¯è¡¨é¡ºåºã€æ—¥æœŸå¤§å°ã€ä»å°åˆ°å¤§ã€ä»å¤§åˆ°å°ç­‰ï¼‰ï¼Œsort() æ–¹æ³•å¯ä»¥æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç”¨æ¥å¤„ç†å…·ä½“çš„æ’åºæ“ä½œã€‚è¿™ä¸ªå‡½æ•°çš„ä½œç”¨éå¸¸ç®€å•ï¼šå¯¹äºä»»æ„ä¸¤ä¸ªå€¼éƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œä»¥æŒ‡å®šå®ƒä»¬åœ¨æ’åºåçš„æ•°ç»„ä¸­çš„å…ˆåé¡ºåºã€‚è¿™ä¸ªå‡½æ•°å‚æ•°ä½¿å¾— Array.sort() å…·æœ‰æ›´å®Œç¾çš„é€šç”¨æ€§å’Œæ— é™å¯æ‰©å±•æ€§ï¼Œå®ƒå¯ä»¥å¯¹ä»»ä½•ç±»å‹çš„æ•°æ®è¿›è¡Œä»»æ„æ’åºã€‚Â§7.8.6 æœ‰ç¤ºä¾‹ä»£ç ã€‚</p>
</blockquote>
<p>Example 8-1 demonstrates the kinds of things that can be done when functions are used as values. This example may be a little tricky, but the comments explain what is going on.</p>
<blockquote>
<p>ç¤ºä¾‹ 8-1 å±•ç¤ºäº†å°†å‡½æ•°ç”¨åšå€¼æ—¶çš„ä¸€äº›ä¾‹å­ï¼Œè¿™æ®µä»£ç å¯èƒ½ä¼šéš¾è¯»ä¸€äº›ï¼Œä½†æ³¨é‡Šè§£é‡Šäº†ä»£ç çš„å…·ä½“å«ä¹‰ï¼š</p>
</blockquote>
<p>Example 8-1. Using functions as data</p>
<blockquote>
<p>ç¤ºä¾‹ 8-1ï¼šç”¨å‡½æ•°åšå€¼</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// We define some simple functions here</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">x,y</span>) &#123; <span class="keyword">return</span> x + y; &#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">subtract</span>(<span class="params">x,y</span>) &#123; <span class="keyword">return</span> x - y; &#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">multiply</span>(<span class="params">x,y</span>) &#123; <span class="keyword">return</span> x * y; &#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">divide</span>(<span class="params">x,y</span>) &#123; <span class="keyword">return</span> x / y; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Here&#x27;s a function that takes one of the preceding functions</span></span><br><span class="line"><span class="comment">// as an argument and invokes it on two operands</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">operate</span>(<span class="params">operator, operand1, operand2</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">operator</span>(operand1, operand2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// We could invoke this function like this to compute the value (2+3) + (4*5):</span></span><br><span class="line"><span class="keyword">let</span> i = <span class="title function_">operate</span>(add, <span class="title function_">operate</span>(add, <span class="number">2</span>, <span class="number">3</span>), <span class="title function_">operate</span>(multiply, <span class="number">4</span>, <span class="number">5</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// For the sake of the example, we implement the simple functions again,</span></span><br><span class="line"><span class="comment">// this time within an object literal;</span></span><br><span class="line"><span class="keyword">const</span> operators = &#123;</span><br><span class="line">    <span class="attr">add</span>:      <span class="function">(<span class="params">x,y</span>) =&gt;</span> x+y,</span><br><span class="line">    <span class="attr">subtract</span>: <span class="function">(<span class="params">x,y</span>) =&gt;</span> x-y,</span><br><span class="line">    <span class="attr">multiply</span>: <span class="function">(<span class="params">x,y</span>) =&gt;</span> x*y,</span><br><span class="line">    <span class="attr">divide</span>:   <span class="function">(<span class="params">x,y</span>) =&gt;</span> x/y,</span><br><span class="line">    <span class="attr">pow</span>:      <span class="title class_">Math</span>.<span class="property">pow</span>  <span class="comment">// This works for predefined functions too</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This function takes the name of an operator, looks up that operator</span></span><br><span class="line"><span class="comment">// in the object, and then invokes it on the supplied operands. Note</span></span><br><span class="line"><span class="comment">// the syntax used to invoke the operator function.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">operate2</span>(<span class="params">operation, operand1, operand2</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> operators[operation] === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> operators[operation](operand1, operand2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">throw</span> <span class="string">&quot;unknown operator&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">operate2</span>(<span class="string">&quot;add&quot;</span>, <span class="string">&quot;hello&quot;</span>, <span class="title function_">operate2</span>(<span class="string">&quot;add&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;world&quot;</span>)) <span class="comment">// =&gt; &quot;hello world&quot;</span></span><br><span class="line"><span class="title function_">operate2</span>(<span class="string">&quot;pow&quot;</span>, <span class="number">10</span>, <span class="number">2</span>)  <span class="comment">// =&gt; 100</span></span><br></pre></td></tr></table></figure>
<h3 id="8-4-1-Defining-Your-Own-Function-Properties"><a href="#8-4-1-Defining-Your-Own-Function-Properties" class="headerlink" title="8.4.1 Defining Your Own Function Properties"></a>8.4.1 Defining Your Own Function Properties</h3><p>Functions are not primitive values in JavaScript, but a specialized kind of object, which means that functions can have properties. When a function needs a â€œstaticâ€ variable whose value persists across invocations, it is often convenient to use a property of the function itself. For example, suppose you want to write a function that returns a unique integer whenever it is invoked. The function must never return the same value twice. In order to manage this, the function needs to keep track of the values it has already returned, and this information must persist across function invocations. You could store this information in a global variable, but that is unnecessary, because the information is used only by the function itself. It is better to store the information in a property of the Function object. Here is an example that returns a unique integer whenever it is called:</p>
<blockquote>
<p>JavaScript ä¸­çš„å‡½æ•°å¹¶ä¸æ˜¯åŸå§‹å€¼ï¼Œè€Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‡½æ•°å¯ä»¥æ‹¥æœ‰å±æ€§ã€‚å½“å‡½æ•°éœ€è¦ä¸€ä¸ªâ€œé™æ€â€å˜é‡æ¥åœ¨è°ƒç”¨æ—¶ä¿æŒæŸä¸ªå€¼ä¸å˜ï¼Œæœ€æ–¹ä¾¿çš„æ–¹å¼å°±æ˜¯ç»™å‡½æ•°å®šä¹‰å±æ€§ï¼Œè€Œä¸æ˜¯å®šä¹‰å…¨å±€å˜é‡ï¼Œæ˜¾ç„¶å®šä¹‰å…¨å±€å˜é‡ä¼šè®©å‘½åç©ºé—´å˜å¾—æ›´åŠ æ‚ä¹±æ— ç« ã€‚æ¯”å¦‚ï¼Œå‡è®¾ä½ æƒ³å†™ä¸€ä¸ªè¿”å›ä¸€ä¸ªå”¯ä¸€æ•´æ•°çš„å‡½æ•°ï¼Œä¸ç®¡åœ¨å“ªé‡Œè°ƒç”¨å‡½æ•°éƒ½ä¼šè¿”å›è¿™ä¸ªæ•´æ•°ã€‚è€Œå‡½æ•°ä¸èƒ½ä¸¤æ¬¡è¿”å›åŒä¸€ä¸ªå€¼ï¼Œä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œå‡½æ•°å¿…é¡»èƒ½å¤Ÿè·Ÿè¸ªå®ƒæ¯æ¬¡è¿”å›çš„å€¼ï¼Œè€Œä¸”è¿™äº›å€¼çš„ä¿¡æ¯éœ€è¦åœ¨ä¸åŒçš„å‡½æ•°è°ƒè¿‡ç¨‹ä¸­æŒä¹…åŒ–ã€‚å¯ä»¥å°†è¿™äº›ä¿¡æ¯å­˜æ”¾åˆ°å…¨å±€å˜é‡ä¸­ï¼Œä½†è¿™å¹¶ä¸æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºè¿™ä¸ªä¿¡æ¯ä»…ä»…æ˜¯å‡½æ•°æœ¬èº«ç”¨åˆ°çš„ã€‚æœ€å¥½å°†è¿™ä¸ªä¿¡æ¯ä¿å­˜åˆ°å‡½æ•°å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ä¸­ï¼Œä¸‹é¢è¿™ä¸ªä¾‹å­å°±å®ç°äº†è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨å‡½æ•°éƒ½ä¼šè¿”å›ä¸€ä¸ªå”¯ä¸€çš„æ•´æ•°ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Initialize the counter property of the function object.</span></span><br><span class="line"><span class="comment">// Function declarations are hoisted so we really can</span></span><br><span class="line"><span class="comment">// do this assignment before the function declaration.</span></span><br><span class="line">uniqueInteger.<span class="property">counter</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This function returns a different integer each time it is called.</span></span><br><span class="line"><span class="comment">// It uses a property of itself to remember the next value to be returned.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">uniqueInteger</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> uniqueInteger.<span class="property">counter</span>++;  <span class="comment">// Return and increment counter property</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">uniqueInteger</span>()  <span class="comment">// =&gt; 0</span></span><br><span class="line"><span class="title function_">uniqueInteger</span>()  <span class="comment">// =&gt; 1</span></span><br></pre></td></tr></table></figure>
<p>As another example, consider the following factorial() function that uses properties of itself (treating itself as an array) to cache previously computed results:</p>
<blockquote>
<p>æ¥çœ‹å¦å¤–ä¸€ä¸ªä¾‹å­ï¼Œä¸‹é¢è¿™ä¸ªå‡½æ•° factorial() ä½¿ç”¨äº†è‡ªèº«çš„å±æ€§ï¼ˆå°†è‡ªèº«å½“åšæ•°ç»„æ¥å¯¹å¾…ï¼‰æ¥ç¼“å­˜ä¸Šä¸€æ¬¡çš„è®¡ç®—ç»“æœï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Compute factorials and cache results as properties of the function itself.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">factorial</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Number</span>.<span class="title function_">isInteger</span>(n) &amp;&amp; n &gt; <span class="number">0</span>) &#123;           <span class="comment">// Positive integers only</span></span><br><span class="line">        <span class="keyword">if</span> (!(n <span class="keyword">in</span> factorial)) &#123;                  <span class="comment">// If no cached result</span></span><br><span class="line">            factorial[n] = n * <span class="title function_">factorial</span>(n-<span class="number">1</span>);    <span class="comment">// Compute and cache it</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> factorial[n];                      <span class="comment">// Return the cached result</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">NaN</span>;                               <span class="comment">// If input was bad</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">factorial[<span class="number">1</span>] = <span class="number">1</span>;  <span class="comment">// Initialize the cache to hold this base case.</span></span><br><span class="line"><span class="title function_">factorial</span>(<span class="number">6</span>)  <span class="comment">// =&gt; 720</span></span><br><span class="line">factorial[<span class="number">5</span>]  <span class="comment">// =&gt; 120; the call above caches this value</span></span><br></pre></td></tr></table></figure>
<h2 id="8-5-Functions-as-Namespaces"><a href="#8-5-Functions-as-Namespaces" class="headerlink" title="8.5 Functions as Namespaces"></a>8.5 Functions as Namespaces</h2><p>Variables declared within a function are not visible outside of the function. For this reason, it is sometimes useful to define a function simply to act as a temporary namespace in which you can define variables without cluttering the global namespace.</p>
<blockquote>
<p>å˜é‡å£°æ˜åœ¨å‡½æ•°å†…å¯¹äºå‡½æ•°ä½“å¤–æ˜¯ä¸å¯è§çš„ã€‚å› æ­¤ï¼Œæœ‰æ—¶å®šä¹‰å‡½æ•°ä½œä¸ºä¸´æ—¶å‘½åç©ºé—´éå¸¸æœ‰ç”¨ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­å®šä¹‰å˜é‡è€Œä¸å¼„ä¹±å…¨å±€å‘½åç©ºé—´ã€‚</p>
</blockquote>
<p>Suppose, for example, you have a chunk of JavaScript code that you want to use in a number of different JavaScript programs (or, for client-side JavaScript, on a number of different web pages). Assume that this code, like most code, defines variables to store the intermediate results of its computation. The problem is that since this chunk of code will be used in many different programs, you donâ€™t know whether the variables it creates will conflict with variables created by the programs that use it. The solution is to put the chunk of code into a function and then invoke the function. This way, variables that would have been global become local to the function:</p>
<blockquote>
<p>æ¯”å¦‚ï¼Œå‡è®¾ä½ å†™äº†ä¸€æ®µ JavaScript æ¨¡å—ä»£ç ï¼Œè¿™æ®µä»£ç å°†è¦ç”¨åœ¨ä¸åŒçš„ JavaScript ç¨‹åºä¸­ï¼ˆå¯¹äºå®¢æˆ·ç«¯ JavaScript æ¥è®²é€šå¸¸æ˜¯ç”¨åœ¨å„ç§å„æ ·çš„ç½‘é¡µä¸­ï¼‰ã€‚å’Œå¤§å¤šæ•°ä»£ç ä¸€æ ·ï¼Œå‡å®šè¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªç”¨ä»¥å­˜å‚¨ä¸­é—´è®¡ç®—ç»“æœçš„å˜é‡ã€‚è¿™æ ·é—®é¢˜å°±æ¥äº†ï¼Œå½“æ¨¡å—ä»£ç æ”¾åˆ°ä¸åŒçš„ç¨‹åºä¸­è¿è¡Œæ—¶ï¼Œä½ æ— æ³•å¾—çŸ¥è¿™ä¸ªå˜é‡æ˜¯å¦å·²ç»åˆ›å»ºäº†ï¼Œå¦‚æœå·²ç»å­˜åœ¨è¿™ä¸ªå˜é‡ï¼Œé‚£ä¹ˆå°†ä¼šå’Œä»£ç å‘ç”Ÿå†²çªã€‚è§£å†³åŠæ³•å½“ç„¶æ˜¯å°†ä»£ç æ”¾å…¥ä¸€ä¸ªå‡½æ•°å†…ï¼Œç„¶åè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚è¿™æ ·å…¨å±€å˜é‡å°±å˜æˆäº†å‡½æ•°å†…çš„å±€éƒ¨å˜é‡ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">chunkNamespace</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// Chunk of code goes here</span></span><br><span class="line">    <span class="comment">// Any variables defined in the chunk are local to this function</span></span><br><span class="line">    <span class="comment">// instead of cluttering up the global namespace.</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">chunkNamespace</span>();  <span class="comment">// But don&#x27;t forget to invoke the function!</span></span><br></pre></td></tr></table></figure>
<p>This code defines only a single global variable: the function name chunkNamespace. If defining even a single property is too much, you can define and invoke an anonymous function in a single expression:</p>
<blockquote>
<p>è¿™æ®µä»£ç ä»…ä»…å®šä¹‰äº†ä¸€ä¸ªå•ç‹¬çš„å…¨å±€å˜é‡ï¼šåä¸º chunkNamespace çš„å‡½æ•°ã€‚å¦‚æœè¿˜æ˜¯å¤ªéº»çƒ¦ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªå•ç‹¬çš„è¡¨è¾¾å¼å®šä¹‰ä¸€ä¸ªåŒ¿åå‡½æ•°å¹¶è°ƒç”¨å®ƒï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;  <span class="comment">// chunkNamespace() function rewritten as an unnamed expression.</span></span><br><span class="line">    <span class="comment">// Chunk of code goes here</span></span><br><span class="line">&#125;());          <span class="comment">// End the function literal and invoke it now.</span></span><br></pre></td></tr></table></figure>
<p>This technique of defining and invoking a function in a single expression is used frequently enough that it has become idiomatic and has been given the name â€œimmediately invoked function expression.â€ Note the use of parentheses in the previous code example. The open parenthesis before function is required because without it, the JavaScript interpreter tries to parse the function keyword as a function declaration statement. With the parenthesis, the interpreter correctly recognizes this as a function definition expression. The leading parenthesis also helps human readers recognize when a function is being defined to be immediately invoked instead of defined for later use.</p>
<blockquote>
<p>è¿™ç§å®šä¹‰åŒ¿åå‡½æ•°å¹¶ç«‹å³åœ¨å•ä¸ªè¡¨è¾¾å¼ä¸­è°ƒç”¨å®ƒçš„å†™æ³•éå¸¸å¸¸è§ï¼Œå¹¶ç»™å®ƒèµ·äº†ä¸ªåå­—â€œåŒ¿åè°ƒç”¨å‡½æ•°è¡¨è¾¾å¼â€ã€‚æ³¨æ„ä¸Šé¢ä»£ç çš„åœ†æ‹¬å·çš„ç”¨æ³•ï¼Œfunction ä¹‹å‰çš„å·¦åœ†æ‹¬å·æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºå¦‚æœä¸å†™è¿™ä¸ªå·¦åœ†æ‹¬å·ï¼ŒJavaScript è§£é‡Šå™¨ä¼šè¯•å›¾å°†å…³é”®å­— function è§£æä¸ºå‡½æ•°å£°æ˜è¯­å¥ã€‚ä½¿ç”¨åœ†æ‹¬å· JavaScript è§£é‡Šå™¨æ‰ä¼šæ­£ç¡®åœ°å°†å…¶è§£æä¸ºå‡½æ•°å®šä¹‰è¡¨è¾¾å¼ã€‚ä½¿ç”¨å‰å¯¼æ‹¬å·ä¹Ÿæœ‰åŠ©äºäººç±»é˜…è¯»æ—¶åŒºåˆ†å‡½æ•°å®šä¹‰æ˜¯ç«‹å³æ‰§è¡Œè¿˜æ˜¯ä¾›ä»¥åä½¿ç”¨ã€‚</p>
</blockquote>
<p>This use of functions as namespaces becomes really useful when we define one or more functions inside the namespace function using variables within that namesapce, but then pass them back out as the return value of the namespace function. Functions like this are known as closures, and theyâ€™re the topic of the next section.</p>
<blockquote>
<p>å‡½æ•°ç”¨ä½œå‘½åç©ºé—´å¾ˆå¸¸ç”¨ï¼Œåœ¨å‘½åç©ºé—´å‡½æ•°ä¸­å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªå‡½æ•°ä½¿ç”¨å…¶ä¸­çš„å˜é‡ï¼Œç„¶åå°†ä»–ä»¬ä½œä¸ºå‡½æ•°å‘½åç©ºé—´çš„è¿”å›å€¼ã€‚è¿™æ ·çš„å‡½æ•°ç§°ä¸ºé—­åŒ…ï¼Œå®ƒä»¬æ˜¯ä¸‹ä¸€èŠ‚çš„ä¸»é¢˜ã€‚</p>
</blockquote>
<h2 id="8-6-Closures"><a href="#8-6-Closures" class="headerlink" title="8.6 Closures"></a>8.6 Closures</h2><p>Like most modern programming languages, JavaScript uses lexical scoping. This means that functions are executed using the variable scope that was in effect when they were defined, not the variable scope that is in effect when they are invoked. In order to implement lexical scoping, the internal state of a JavaScript function object must include not only the code of the function but also a reference to the scope in which the function definition appears. This combination of a function object and a scope (a set of variable bindings) in which the functionâ€™s variables are resolved is called a closure in the computer science literature.</p>
<blockquote>
<p>å’Œå…¶ä»–å¤§å¤šæ•°ç°ä»£ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼ŒJavaScript ä¹Ÿé‡‡ç”¨è¯æ³•ä½œç”¨åŸŸã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡½æ•°çš„æ‰§è¡Œä¾èµ–äºå˜é‡ä½œç”¨åŸŸï¼Œè¿™ä¸ªä½œç”¨åŸŸæ˜¯åœ¨å‡½æ•°å®šä¹‰æ—¶å†³å®šçš„ï¼Œè€Œä¸æ˜¯å‡½æ•°è°ƒç”¨æ—¶å†³å®šçš„ã€‚ä¸ºäº†å®ç°è¿™ç§è¯æ³•ä½œç”¨åŸŸï¼ŒJavaScript å‡½æ•°å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ä¸ä»…åŒ…å«å‡½æ•°çš„ä»£ç é€»è¾‘ï¼Œè¿˜å¿…é¡»åŒ…æ‹¬å¯¹å‡½æ•°å®šä¹‰å‡ºç°çš„ä½œç”¨åŸŸçš„å¼•ç”¨ã€‚å°†å‡½æ•°å¯¹è±¡å¯å’Œä½œç”¨åŸŸç›¸äº’å…³è”èµ·æ¥ï¼ˆä¸€å¯¹å˜é‡çš„ç»‘å®šï¼‰ï¼Œå‡½æ•°ä½“å†…éƒ¨çš„å˜é‡éƒ½å¯ä»¥ä¿å­˜åœ¨å‡½æ•°ä½œç”¨åŸŸå†…ï¼Œè¿™ç§ç‰¹æ€§åœ¨è®¡ç®—æœºç§‘å­¦æ–‡çŒ®ä¸­ç§°ä¸ºé—­åŒ…ã€‚</p>
</blockquote>
<p>Technically, all JavaScript functions are closures, but because most functions are invoked from the same scope that they were defined in, it normally doesnâ€™t really matter that there is a closure involved. Closures become interesting when they are invoked from a different scope than the one they were defined in. This happens most commonly when a nested function object is returned from the function within which it was defined. There are a number of powerful programming techniques that involve this kind of nested function closures, and their use has become relatively common in JavaScript programming. Closures may seem confusing when you first encounter them, but it is important that you understand them well enough to use them comfortably.</p>
<blockquote>
<p>ä»æŠ€æœ¯çš„è§’åº¦è®²ï¼Œæ‰€æœ‰çš„ JavaScript å‡½æ•°éƒ½æ˜¯é—­åŒ…ï¼Œä½†æ˜¯å¤§å¤šæ•°å‡½æ•°è°ƒç”¨å’Œå®šä¹‰åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸå†…ï¼Œé€šå¸¸ä¸ä¼šæ³¨æ„è¿™é‡Œæœ‰æ¶‰åŠåˆ°é—­åŒ…ã€‚å½“è°ƒç”¨å‡½æ•°ä¸å’Œå…¶å®šä¹‰å¤„äºåŒä¸€ä½œç”¨åŸŸå†…æ—¶ï¼Œäº‹æƒ…å°±å˜å¾—éå¸¸å¾®å¦™ã€‚å½“ä¸€ä¸ªå‡½æ•°åµŒå¥—äº†å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œå¤–éƒ¨å‡½æ•°å°†åµŒå¥—çš„å‡½æ•°å¯¹è±¡ä½œä¸ºè¿”å›å€¼è¿”å›çš„æ—¶å€™å¾€å¾€ä¼šå‘ç”Ÿè¿™ç§äº‹æƒ…ã€‚æœ‰å¾ˆå¤šå¼ºå¤§çš„ç¼–ç¨‹æŠ€æœ¯éƒ½åˆ©ç”¨åˆ°äº†è¿™ç±»åµŒå¥—çš„å‡½æ•°é—­åŒ…ï¼Œä»¥è‡³äºè¿™ç§ç¼–ç¨‹æ¨¡å¼åœ¨ JavaScript ä¸­éå¸¸å¸¸è§ã€‚å½“ä½ ç¬¬ä¸€æ¬¡ç¢°åˆ°é—­åŒ…æ—¶å¯èƒ½ä¼šè§‰å¾—éå¸¸è®©äººè´¹è§£ï¼Œä¸€æ—¦ä½ ç†è§£æŒæ¡äº†é—­åŒ…ä¹‹åï¼Œå°±èƒ½éå¸¸è‡ªå¦‚åœ°ä½¿ç”¨å®ƒäº†ï¼Œäº†è§£è¿™ä¸€ç‚¹è‡³å…³é‡è¦ã€‚</p>
</blockquote>
<p>The first step to understanding closures is to review the lexical scoping rules for nested functions. Consider the following code:</p>
<blockquote>
<p>ç†è§£é—­åŒ…é¦–å…ˆè¦äº†è§£åµŒå¥—å‡½æ•°çš„è¯æ³•ä½œç”¨åŸŸè§„åˆ™ã€‚çœ‹ä¸€ä¸‹è¿™æ®µä»£ç ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> scope = <span class="string">&quot;global scope&quot;</span>;          <span class="comment">// A global variable</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkscope</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> scope = <span class="string">&quot;local scope&quot;</span>;       <span class="comment">// A local variable</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> scope; &#125;   <span class="comment">// Return the value in scope here</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">f</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">checkscope</span>()                         <span class="comment">// =&gt; &quot;local scope&quot;</span></span><br></pre></td></tr></table></figure>
<p>The checkscope() function declares a local variable and then defines and invokes a function that returns the value of that variable. It should be clear to you why the call to checkscope() returns â€œlocal scopeâ€. Now, letâ€™s change the code just slightly. Can you tell what this code will return?</p>
<blockquote>
<p>checkscope() å‡½æ•°å£°æ˜äº†ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œç„¶åå®šä¹‰å¹¶æ‰§è¡Œäº†ä¸€ä¸ªå‡½æ•° f() ï¼Œå‡½æ•° f() è¿”å›äº†è¿™ä¸ªå˜é‡çš„å€¼ï¼Œæœ€åå°†å‡½æ•° f() çš„æ‰§è¡Œç»“æœè¿”å›ã€‚ä½ åº”å½“éå¸¸æ¸…æ¥šä¸ºä»€ä¹ˆè°ƒç”¨ checkscope() ä¼šè¿”å› local scopeã€‚ç°åœ¨æˆ‘ä»¬å¯¹è¿™æ®µä»£ç åšä¸€ç‚¹æ”¹åŠ¨ã€‚ä½ çŸ¥é“è¿™æ®µä»£ç è¿”å›ä»€ä¹ˆå—ï¼Ÿ</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> scope = <span class="string">&quot;global scope&quot;</span>;          <span class="comment">// A global variable</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkscope</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> scope = <span class="string">&quot;local scope&quot;</span>;       <span class="comment">// A local variable</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> scope; &#125;   <span class="comment">// Return the value in scope here</span></span><br><span class="line">    <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> s = <span class="title function_">checkscope</span>()();              <span class="comment">// What does this return?</span></span><br></pre></td></tr></table></figure>
<p>In this code, a pair of parentheses has moved from inside checkscope() to outside of it. Instead of invoking the nested function and returning its result, checkscope() now just returns the nested function object itself. What happens when we invoke that nested function (with the second pair of parentheses in the last line of code) outside of the function in which it was defined?</p>
<blockquote>
<p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†å‡½æ•°å†…çš„ä¸€å¯¹åœ†æ‹¬å·ç§»åŠ¨åˆ°äº† checkscope() ä¹‹åã€‚checkscope() ç°åœ¨ä»…ä»…è¿”å›å‡½æ•°å†…åµŒå¥—çš„ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›ç»“æœã€‚åœ¨å®šä¹‰å‡½æ•°çš„ä½œç”¨åŸŸå¤–é¢ï¼Œè°ƒç”¨è¿™ä¸ªåµŒå¥—çš„å‡½æ•°ï¼ˆåŒ…å«æœ€åä¸€è¡Œä»£ç çš„æœ€åä¸€å¯¹åœ†æ‹¬å·ï¼‰ä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…å‘¢ï¼Ÿ</p>
</blockquote>
<p>Remember the fundamental rule of lexical scoping: JavaScript functions are executed using the scope they were defined in. The nested function f() was defined in a scope where the variable scope was bound to the value â€œlocal scopeâ€. That binding is still in effect when f is executed, no matter where it is executed from. So the last line of the preceding code example returns â€œlocal scopeâ€, not â€œglobal scopeâ€. This, in a nutshell, is the surprising and powerful nature of closures: they capture the local variable (and parameter) bindings of the outer function within which they are defined.</p>
<blockquote>
<p>å›æƒ³ä¸€ä¸‹è¯æ³•ä½œç”¨åŸŸçš„åŸºæœ¬è§„åˆ™ï¼šJavaScript å‡½æ•°çš„æ‰§è¡Œç”¨åˆ°äº†ä½œç”¨åŸŸï¼Œè¿™ä¸ªä½œç”¨åŸŸæ˜¯å‡½æ•°å®šä¹‰çš„æ—¶å€™åˆ›å»ºçš„ã€‚åµŒå¥—çš„å‡½æ•° f() å®šä¹‰åœ¨å˜é‡ scope ç»‘å®šçš„å€¼æ˜¯â€œlocal scopeâ€çš„ä½œç”¨åŸŸé‡Œï¼Œè¿™ä¸ªç»‘å®šæ— è®º f å‡½æ•°åœ¨ä½•å¤„è°ƒç”¨éƒ½ä¾ç„¶æœ‰æ•ˆã€‚å› æ­¤æœ€åä¸€è¡Œä»£ç è¿”å›â€œlocal scopeâ€ï¼Œè€Œä¸æ˜¯â€œglobal scopeâ€ã€‚ç®€è¨€ä¹‹ï¼Œé—­åŒ…çš„è¿™ä¸ªç‰¹æ€§å¼ºå¤§åˆ°è®©äººåƒæƒŠï¼šå®ƒä»¬å¯ä»¥æ•æ‰åˆ°å®ƒä»¬çš„å¤–éƒ¨å‡½æ•°æ‰€ç»‘å®šçš„å±€éƒ¨å˜é‡ï¼ˆå’Œå‚æ•°ï¼‰ã€‚</p>
</blockquote>
<p>In Â§8.4.1, we defined a uniqueInteger() function that used a property of the function itself to keep track of the next value to be returned. A shortcoming of that approach is that buggy or malicious code could reset the counter or set it to a noninteger, causing the uniqueInteger() function to violate the â€œuniqueâ€ or the â€œintegerâ€ part of its contract. Closures capture the local variables of a single function invocation and can use those variables as private state. Here is how we could rewrite the uniqueInteger() using an immediately invoked function expression to define a namespace and a closure that uses that namespace to keep its state private:</p>
<blockquote>
<p>åœ¨ Â§8.4.1 ä¸­å®šä¹‰äº† uniqueInteger() å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä½¿ç”¨è‡ªèº«çš„ä¸€ä¸ªå±æ€§æ¥ä¿å­˜æ¯æ¬¡è¿”å›çš„å€¼ï¼Œä»¥ä¾¿æ¯æ¬¡è°ƒç”¨éƒ½èƒ½è·Ÿè¸ªä¸Šæ¬¡çš„è¿”å›å€¼ã€‚ä½†è¿™ç§åšæ³•æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ¶æ„ä»£ç å¯èƒ½å°†è®¡æ•°å™¨é‡ç½®æˆ–è€…æŠŠä¸€ä¸ªéæ•´æ•°èµ‹å€¼ç»™å®ƒï¼Œå¯¼è‡´ uniquenterger() å‡½æ•°ä¸ä¸€å®šèƒ½äº§ç”Ÿâ€œå”¯ä¸€â€çš„â€œæ•´æ•°â€ã€‚è€Œé—­åŒ…å¯ä»¥æ•æ‰åˆ°å•ä¸ªå‡½æ•°è°ƒç”¨çš„å±€éƒ¨å˜é‡ï¼Œå¹¶å°†è¿™äº›å±€éƒ¨å˜é‡ç”¨åšç§æœ‰çŠ¶æ€ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ç”¨ç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼é‡å†™ uniqueInteger() æ¥å®šä¹‰å‘½åç©ºé—´å’Œé—­åŒ…æ¥ä¿æŒå…¶çŠ¶æ€ç§æœ‰åŒ–ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> uniqueInteger = (<span class="keyword">function</span>(<span class="params"></span>) &#123;  <span class="comment">// Define and invoke</span></span><br><span class="line">    <span class="keyword">let</span> counter = <span class="number">0</span>;               <span class="comment">// Private state of function below</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> counter++; &#125;;</span><br><span class="line">&#125;());</span><br><span class="line"><span class="title function_">uniqueInteger</span>()  <span class="comment">// =&gt; 0</span></span><br><span class="line"><span class="title function_">uniqueInteger</span>()  <span class="comment">// =&gt; 1</span></span><br></pre></td></tr></table></figure>
<p>In order to understand this code, you have to read it carefully. At first glance, the first line of code looks like it is assigning a function to the variable uniqueInteger. In fact, the code is defining and invoking (as hinted by the open parenthesis on the first line) a function, so it is the return value of the function that is being assigned to uniqueInteger. Now, if we study the body of the function, we see that its return value is another function. It is this nested function object that gets assigned to uniqueInteger. The nested function has access to the variables in its scope and can use the counter variable defined in the outer function. Once that outer function returns, no other code can see the counter variable: the inner function has exclusive access to it.</p>
<blockquote>
<p>ä½ éœ€è¦ä»”ç»†é˜…è¯»è¿™æ®µä»£ç æ‰èƒ½ç†è§£å…¶å«ä¹‰ã€‚ç²—ç•¥æ¥çœ‹ï¼Œç¬¬ä¸€è¡Œä»£ç çœ‹èµ·æ¥åƒå°†å‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ uniqueIntegerï¼Œå®é™…ä¸Šï¼Œè¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªç«‹å³è°ƒç”¨çš„å‡½æ•°ï¼ˆå‡½æ•°çš„å¼€å§‹å¸¦æœ‰å·¦åœ†æ‹¬å·ï¼‰ï¼Œå› æ­¤æ˜¯è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼èµ‹å€¼ç»™å˜é‡ uniqueIntegerã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹å‡½æ•°ä½“ï¼Œè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯å¦å¤–ä¸€ä¸ªå‡½æ•°ã€‚è¿™æ˜¯ä¸€ä¸ªåµŒå¥—çš„å‡½æ•°ï¼Œæˆ‘ä»¬å°†å®ƒèµ‹å€¼ç»™å˜é‡ uniqueIntegerã€‚åµŒå¥—çš„å‡½æ•°æ˜¯å¯ä»¥è®¿é—®ä½œç”¨åŸŸå†…çš„å˜é‡çš„ï¼Œè€Œä¸”å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°ä¸­å®šä¹‰çš„ counter å˜é‡ã€‚å½“å¤–éƒ¨å‡½æ•°è¿”å›ä¹‹åï¼Œå…¶ä»–ä»»ä½•ä»£ç éƒ½æ— æ³•è®¿é—® counter å˜é‡ï¼šåªæœ‰å†…éƒ¨çš„å‡½æ•°æ‰èƒ½è®¿é—®åˆ°å®ƒã€‚</p>
</blockquote>
<p>Private variables like counter need not be exclusive to a single closure: it is perfectly possible for two or more nested functions to be defined within the same outer function and share the same scope. Consider the following code:</p>
<blockquote>
<p>åƒ counter ä¸€æ ·çš„ç§æœ‰å˜é‡ä¸æ˜¯åªèƒ½ç”¨åœ¨ä¸€ä¸ªå•ç‹¬çš„é—­åŒ…å†…ï¼Œåœ¨åŒä¸€ä¸ªå¤–éƒ¨å‡½æ•°å†…å®šä¹‰çš„å¤šä¸ªåµŒå¥—å‡½æ•°ä¹Ÿå¯ä»¥è®¿é—®å®ƒï¼Œè¿™å¤šä¸ªåµŒå¥—å‡½æ•°éƒ½å…±äº«ä¸€ä¸ªä½œç”¨åŸŸï¼Œçœ‹ä¸€ä¸‹è¿™æ®µä»£ç ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> n = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> n++; &#125;,</span><br><span class="line">        <span class="attr">reset</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123; n = <span class="number">0</span>; &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> c = <span class="title function_">counter</span>(), d = <span class="title function_">counter</span>();   <span class="comment">// Create two counters</span></span><br><span class="line">c.<span class="title function_">count</span>()                           <span class="comment">// =&gt; 0</span></span><br><span class="line">d.<span class="title function_">count</span>()                           <span class="comment">// =&gt; 0: they count independently</span></span><br><span class="line">c.<span class="title function_">reset</span>();                          <span class="comment">// reset() and count() methods share state</span></span><br><span class="line">c.<span class="title function_">count</span>()                           <span class="comment">// =&gt; 0: because we reset c</span></span><br><span class="line">d.<span class="title function_">count</span>()                           <span class="comment">// =&gt; 1: d was not reset</span></span><br></pre></td></tr></table></figure>
<p>The counter() function returns a â€œcounterâ€ object. This object has two methods: count() returns the next integer, and reset() resets the internal state. The first thing to understand is that the two methods share access to the private variable n. The second thing to understand is that each invocation of counter() creates a new scopeâ€”independent of the scopes used by previous invocationsâ€”and a new private variable within that scope. So if you call counter() twice, you get two counter objects with different private variables. Calling count() or reset() on one counter object has no effect on the other.</p>
<blockquote>
<p>counter() å‡½æ•°è¿”å›äº†ä¸€ä¸ªâ€œè®¡æ•°å™¨â€å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«ä¸¤ä¸ªæ–¹æ³•ï¼šcount() è¿”å›ä¸‹ä¸€ä¸ªæ•´æ•°ï¼Œreset() é‡ç½®å†…éƒ¨çŠ¶æ€ã€‚é¦–å…ˆè¦ç†è§£ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥è®¿é—®ç§æœ‰å˜é‡nã€‚å†è€…ï¼Œæ¯æ¬¡è°ƒç”¨ counter() éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸé“¾å’Œä¸€ä¸ªæ–°çš„ç§æœ‰å˜é‡ã€‚å› æ­¤ï¼Œå¦‚æœè°ƒç”¨ counter() ä¸¤æ¬¡ï¼Œåˆ™ä¼šå¾—åˆ°ä¸¤ä¸ªè®¡æ•°å™¨å¯¹è±¡ï¼Œè€Œä¸”å½¼æ­¤åŒ…å«ä¸åŒçš„ç§æœ‰å˜é‡ï¼Œè°ƒç”¨å…¶ä¸­ä¸€ä¸ªè®¡æ•°å™¨å¯¹è±¡çš„ count() æˆ– reset() ä¸ä¼šå½±å“åˆ°å¦å¤–ä¸€ä¸ªå¯¹è±¡ã€‚</p>
</blockquote>
<p>It is worth noting here that you can combine this closure technique with property getters and setters. The following version of the counter() function is a variation on code that appeared in Â§6.10.6, but it uses closures for private state rather than relying on a regular object property:</p>
<blockquote>
<p>ä»æŠ€æœ¯è§’åº¦çœ‹ï¼Œå…¶å®å¯ä»¥å°†è¿™ä¸ªé—­åŒ…åˆå¹¶ä¸ºå±æ€§å­˜å–å™¨æ–¹æ³• getter å’Œ setterã€‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºçš„ counter() å‡½æ•°çš„ç‰ˆæœ¬æ˜¯ Â§6.10.6 ä¸­ä»£ç çš„å˜ç§ï¼Œæ‰€ä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œç§æœ‰çŠ¶æ€çš„å®ç°æ˜¯åˆ©ç”¨äº†é—­åŒ…ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ™®é€šçš„å¯¹è±¡å±æ€§æ¥å®ç°ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">counter</span>(<span class="params">n</span>) &#123;  <span class="comment">// Function argument n is the private variable</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="comment">// Property getter method returns and increments private counter var.</span></span><br><span class="line">        <span class="keyword">get</span> <span class="title function_">count</span>() &#123; <span class="keyword">return</span> n++; &#125;,</span><br><span class="line">        <span class="comment">// Property setter doesn&#x27;t allow the value of n to decrease</span></span><br><span class="line">        <span class="keyword">set</span> <span class="title function_">count</span>(<span class="params">m</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (m &gt; n) n = m;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">throw</span> <span class="title class_">Error</span>(<span class="string">&quot;count can only be set to a larger value&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> c = <span class="title function_">counter</span>(<span class="number">1000</span>);</span><br><span class="line">c.<span class="property">count</span>            <span class="comment">// =&gt; 1000</span></span><br><span class="line">c.<span class="property">count</span>            <span class="comment">// =&gt; 1001</span></span><br><span class="line">c.<span class="property">count</span> = <span class="number">2000</span>;</span><br><span class="line">c.<span class="property">count</span>            <span class="comment">// =&gt; 2000</span></span><br><span class="line">c.<span class="property">count</span> = <span class="number">2000</span>;    <span class="comment">// !Error: count can only be set to a larger value</span></span><br></pre></td></tr></table></figure>
<p>Note that this version of the counter() function does not declare a local variable but just uses its parameter n to hold the private state shared by the property accessor methods. This allows the caller of counter() to specify the initial value of the private variable.</p>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªç‰ˆæœ¬çš„ counter() å‡½æ•°å¹¶æœªå£°æ˜å±€éƒ¨å˜é‡ï¼Œè€Œåªæ˜¯ä½¿ç”¨å‚æ•° n æ¥ä¿å­˜ç§æœ‰çŠ¶æ€å¹¶ä¸å±æ€§å­˜å–å™¨æ–¹æ³•å…±äº«ã€‚è¿™æ ·çš„è¯ï¼Œè°ƒç”¨ counter() çš„å‡½æ•°å°±å¯ä»¥æŒ‡å®šç§æœ‰å˜é‡çš„åˆå§‹å€¼äº†ã€‚</p>
</blockquote>
<p>Example 8-2 is a generalization of the shared private state through the closures technique weâ€™ve been demonstrating here. This example defines an addPrivateProperty() function that defines a private variable and two nested functions to get and set the value of that variable. It adds these nested functions as methods of the object you specify.</p>
<blockquote>
<p>ç¤ºä¾‹ 8-2æ˜¯è¿™ç§ä½¿ç”¨é—­åŒ…æŠ€æœ¯æ¥å…±äº«çš„ç§æœ‰çŠ¶æ€çš„é€šç”¨åšæ³•ã€‚è¿™ä¸ªä¾‹å­å®šä¹‰äº† addPrivateProperty() å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å®šä¹‰äº†ä¸€ä¸ªç§æœ‰å˜é‡ï¼Œä»¥åŠä¸¤ä¸ªåµŒå¥—çš„å‡½æ•°ç”¨æ¥è·å–å’Œè®¾ç½®è¿™ä¸ªç§æœ‰å˜é‡çš„å€¼ã€‚å®ƒå°†è¿™äº›åµŒå¥—å‡½æ•°æ·»åŠ ä¸ºæ‰€æŒ‡å®šå¯¹è±¡çš„æ–¹æ³•ï¼š</p>
</blockquote>
<p>Example 8-2. Private property accessor methods using closures</p>
<blockquote>
<p>ç¤ºä¾‹ 8-2ï¼šåˆ©ç”¨é—­åŒ…å®ç°çš„ç§æœ‰å±æ€§å­˜å–å™¨æ–¹æ³•</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This function adds property accessor methods for a property with</span></span><br><span class="line"><span class="comment">// the specified name to the object o. The methods are named get&lt;name&gt;</span></span><br><span class="line"><span class="comment">// and set&lt;name&gt;. If a predicate function is supplied, the setter</span></span><br><span class="line"><span class="comment">// method uses it to test its argument for validity before storing it.</span></span><br><span class="line"><span class="comment">// If the predicate returns false, the setter method throws an exception.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// The unusual thing about this function is that the property value</span></span><br><span class="line"><span class="comment">// that is manipulated by the getter and setter methods is not stored in</span></span><br><span class="line"><span class="comment">// the object o. Instead, the value is stored only in a local variable</span></span><br><span class="line"><span class="comment">// in this function. The getter and setter methods are also defined</span></span><br><span class="line"><span class="comment">// locally to this function and therefore have access to this local variable.</span></span><br><span class="line"><span class="comment">// This means that the value is private to the two accessor methods, and it</span></span><br><span class="line"><span class="comment">// cannot be set or modified except through the setter method.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addPrivateProperty</span>(<span class="params">o, name, predicate</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> value;  <span class="comment">// This is the property value</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// The getter method simply returns the value.</span></span><br><span class="line">    o[<span class="string">`get<span class="subst">$&#123;name&#125;</span>`</span>] = <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> value; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The setter method stores the value or throws an exception if</span></span><br><span class="line">    <span class="comment">// the predicate rejects the value.</span></span><br><span class="line">    o[<span class="string">`set<span class="subst">$&#123;name&#125;</span>`</span>] = <span class="keyword">function</span>(<span class="params">v</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (predicate &amp;&amp; !<span class="title function_">predicate</span>(v)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">`set<span class="subst">$&#123;name&#125;</span>: invalid value <span class="subst">$&#123;v&#125;</span>`</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            value = v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The following code demonstrates the addPrivateProperty() method.</span></span><br><span class="line"><span class="keyword">let</span> o = &#123;&#125;;  <span class="comment">// Here is an empty object</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Add property accessor methods getName and setName()</span></span><br><span class="line"><span class="comment">// Ensure that only string values are allowed</span></span><br><span class="line"><span class="title function_">addPrivateProperty</span>(o, <span class="string">&quot;Name&quot;</span>, <span class="function"><span class="params">x</span> =&gt;</span> <span class="keyword">typeof</span> x === <span class="string">&quot;string&quot;</span>);</span><br><span class="line"></span><br><span class="line">o.<span class="title function_">setName</span>(<span class="string">&quot;Frank&quot;</span>);       <span class="comment">// Set the property value</span></span><br><span class="line">o.<span class="title function_">getName</span>()               <span class="comment">// =&gt; &quot;Frank&quot;</span></span><br><span class="line">o.<span class="title function_">setName</span>(<span class="number">0</span>);             <span class="comment">// !TypeError: try to set a value of the wrong type</span></span><br></pre></td></tr></table></figure>
<p>Weâ€™ve now seen a number of examples in which two closures are defined in the same scope and share access to the same private variable or variables. This is an important technique, but it is just as important to recognize when closures inadvertently share access to a variable that they should not share. Consider the following code:</p>
<blockquote>
<p>æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¾ˆå¤šä¾‹å­ï¼Œåœ¨åŒä¸€ä¸ªä½œç”¨åŸŸä¸­å®šä¹‰ä¸¤ä¸ªé—­åŒ…ï¼Œè¿™ä¸¤ä¸ªé—­åŒ…å…±äº«åŒæ ·çš„ç§æœ‰å˜é‡æˆ–å˜é‡ã€‚è¿™æ˜¯ä¸€ç§éå¸¸é‡è¦çš„æŠ€æœ¯ï¼Œä½†è¿˜æ˜¯è¦ç‰¹åˆ«å°å¿ƒé‚£äº›ä¸å¸Œæœ›å…±äº«çš„å˜é‡å¾€å¾€ä¸ç»æ„é—´å…±äº«ç»™äº†å…¶ä»–çš„é—­åŒ…ï¼Œäº†è§£è¿™ä¸€ç‚¹ä¹Ÿå¾ˆé‡è¦ã€‚çœ‹ä¸€ä¸‹ä¸‹é¢è¿™æ®µä»£ç ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This function returns a function that always returns v</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">constfunc</span>(<span class="params">v</span>) &#123; <span class="keyword">return</span> <span class="function">() =&gt;</span> v; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create an array of constant functions:</span></span><br><span class="line"><span class="keyword">let</span> funcs = [];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) funcs[i] = <span class="title function_">constfunc</span>(i);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The function at array element 5 returns the value 5.</span></span><br><span class="line">funcs[<span class="number">5</span>]()    <span class="comment">// =&gt; 5</span></span><br></pre></td></tr></table></figure>
<p>When working with code like this that creates multiple closures using a loop, it is a common error to try to move the loop within the function that defines the closures. Think about the following code, for example:</p>
<blockquote>
<p>è¿™æ®µä»£ç åˆ©ç”¨å¾ªç¯åˆ›å»ºäº†å¾ˆå¤šä¸ªé—­åŒ…ï¼Œå½“å†™ç±»ä¼¼è¿™ç§ä»£ç çš„æ—¶å€™å¾€å¾€ä¼šçŠ¯ä¸€ä¸ªé”™è¯¯ï¼šé‚£å°±æ˜¯è¯•å›¾å°†å¾ªç¯ä»£ç ç§»å…¥å®šä¹‰è¿™ä¸ªé—­åŒ…çš„å‡½æ•°ä¹‹å†…ï¼Œçœ‹ä¸€ä¸‹è¿™æ®µä»£ç ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Return an array of functions that return the values 0-9</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">constfuncs</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> funcs = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        funcs[i] = <span class="function">() =&gt;</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> funcs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> funcs = <span class="title function_">constfuncs</span>();</span><br><span class="line">funcs[<span class="number">5</span>]()    <span class="comment">// =&gt; 10; Why doesn&#x27;t this return 5?</span></span><br></pre></td></tr></table></figure>
<p>This code creates 10 closures and stores them in an array. The closures are all defined within the same invocation of the function, so they share access to the variable i. When constfuncs() returns, the value of the variable i is 10, and all 10 closures share this value. Therefore, all the functions in the returned array of functions return the same value, which is not what we wanted at all. It is important to remember that the scope associated with a closure is â€œlive.â€ Nested functions do not make private copies of the scope or make static snapshots of the variable bindings. Fundamentally, the problem here is that variables declared with var are defined throughout the function. Our for loop declares the loop variable with var i, so the variable i is defined throughout the function rather than being more narrowly scoped to the body of the loop. The code demonstrates a common category of bugs in ES5 and before, but the introduction of block-scoped variables in ES6 addresses the issue. If we just replace the var with a let or a const, then the problem goes away. Because let and const are block scoped, each iteration of the loop defines a scope that is independent of the scopes for all other iterations, and each of these scopes has its own independent binding of i.</p>
<blockquote>
<p>ä¸Šé¢è¿™æ®µä»£ç åˆ›å»ºäº†10ä¸ªé—­åŒ…ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ã€‚è¿™äº›é—­åŒ…éƒ½æ˜¯åœ¨åŒä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¸­å®šä¹‰çš„ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥å…±äº«å˜é‡ iã€‚å½“ constfuncs() è¿”å›æ—¶ï¼Œå˜é‡ i çš„å€¼æ˜¯10ï¼Œæ‰€æœ‰çš„é—­åŒ…éƒ½å…±äº«è¿™ä¸€ä¸ªå€¼ï¼Œå› æ­¤ï¼Œæ•°ç»„ä¸­çš„å‡½æ•°çš„è¿”å›å€¼éƒ½æ˜¯åŒä¸€ä¸ªå€¼ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚å…³è”åˆ°é—­åŒ…çš„ä½œç”¨åŸŸéƒ½æ˜¯â€œæ´»åŠ¨çš„â€ï¼Œè®°ä½è¿™ä¸€ç‚¹éå¸¸é‡è¦ã€‚åµŒå¥—çš„å‡½æ•°ä¸ä¼šå°†ä½œç”¨åŸŸå†…çš„ç§æœ‰æˆå‘˜å¤åˆ¶ä¸€ä»½ï¼Œä¹Ÿä¸ä¼šå¯¹æ‰€ç»‘å®šçš„å˜é‡ç”Ÿæˆé™æ€å¿«ç…§ã€‚ä»æ ¹æœ¬ä¸Šè®²ï¼Œè¿™é‡Œçš„é—®é¢˜æ˜¯ï¼Œä½¿ç”¨ var å£°æ˜çš„å˜é‡ï¼Œå®ƒçš„å®šä¹‰è´¯ç©¿æ•´ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬çš„ for å¾ªç¯ä½¿ç”¨ var i å£°æ˜å¾ªç¯å˜é‡ï¼Œå› æ­¤å˜é‡ i åœ¨æ•´ä¸ªå‡½æ•°ä¸­éƒ½æœ‰å®šä¹‰ï¼Œè€Œä¸æ˜¯æ›´ç‹­ä¹‰åœ°ä½œç”¨äºå¾ªç¯çš„ä¸»ä½“ã€‚è¯¥ä»£ç æ¼”ç¤ºäº† ES6 ä¹‹å‰çš„å¸¸è§ Bug ç±»åˆ«ï¼Œä½†åœ¨ ES6 ä¸­å¼•å…¥å—çº§å˜é‡ä½œç”¨åŸŸè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬åªæ˜¯ç”¨ let æˆ– const æ›¿æ¢ varï¼Œ é‚£ä¹ˆé—®é¢˜å°±æ¶ˆå¤±äº†ã€‚ç”±äº let å’Œ const æ˜¯å—çº§ä½œç”¨åŸŸï¼Œå› æ­¤å¾ªç¯çš„æ¯ä¸ªè¿­ä»£éƒ½å®šä¹‰äº†ä¸€ä¸ªç‹¬ç«‹äºæ‰€æœ‰å…¶ä»–è¿­ä»£çš„ä½œç”¨åŸŸï¼Œå¹¶ä¸”æ¯ä¸ªä½œç”¨åŸŸéƒ½æœ‰å…¶è‡ªå·±çš„ç‹¬ç«‹ç»‘å®š iã€‚</p>
</blockquote>
<p>Another thing to remember when writing closures is that this is a JavaScript keyword, not a variable. As discussed earlier, arrow functions inherit the this value of the function that contains them, but functions defined with the function keyword do not. So if youâ€™re writing a closure that needs to use the this value of its containing function, you should use an arrow function, or call bind(), on the closure before returning it, or assign the outer this value to a variable that your closure will inherit:</p>
<blockquote>
<p>ä¹¦å†™é—­åŒ…çš„æ—¶å€™è¿˜éœ€æ³¨æ„ä¸€ä»¶äº‹æƒ…ï¼Œthis æ˜¯ JavaScript çš„å…³é”®å­—ï¼Œè€Œä¸æ˜¯å˜é‡ã€‚æ­£å¦‚ä¹‹å‰è®¨è®ºçš„ï¼Œç®­å¤´å‡½æ•°ä»åŒ…å«å®ƒä»¬çš„å‡½æ•°ä¸­ç»§æ‰¿ this å€¼ï¼Œä½†æ˜¯ç”¨ function å…³é”®å­—å®šä¹‰çš„å‡½æ•°ä¸æ˜¯ã€‚æ‰€ä»¥å¦‚æœå†™ä¸€ä¸ªé—­åŒ…éœ€è¦ä½¿ç”¨åŒ…å«å®ƒçš„å‡½æ•°çš„ this å€¼ï¼Œè¦åœ¨é—­åŒ…è¿”å›ä¹‹å‰ä½¿ç”¨ç®­å¤´å‡½æ•°æˆ–è€…ç”¨è°ƒç”¨ bind()ï¼Œæˆ–è€…å°† this å€¼èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œè¿™æ ·ä½ çš„é—­åŒ…ä¼šç»§æ‰¿å®ƒï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> self = <span class="variable language_">this</span>;  <span class="comment">// Make the this value available to nested functions</span></span><br></pre></td></tr></table></figure>
<h2 id="8-7-Function-Properties-Methods-and-Constructor"><a href="#8-7-Function-Properties-Methods-and-Constructor" class="headerlink" title="8.7 Function Properties, Methods, and Constructor"></a>8.7 Function Properties, Methods, and Constructor</h2><p>Weâ€™ve seen that functions are values in JavaScript programs. The typeof operator returns the string â€œfunctionâ€ when applied to a function, but functions are really a specialized kind of JavaScript object. Since functions are objects, they can have properties and methods, just like any other object. There is even a Function() constructor to create new function objects. The subsections that follow document the length, name, and prototype properties; the call(), apply(), bind(), and toString() methods; and the Function() constructor.</p>
<blockquote>
<p>æˆ‘ä»¬çœ‹åˆ°åœ¨ JavaScript ç¨‹åºä¸­ï¼Œå‡½æ•°æ˜¯å€¼ã€‚å¯¹å‡½æ•°æ‰§è¡Œ typeof è¿ç®—ä¼šè¿”å›å­—ç¬¦ä¸²â€œfunctionâ€ï¼Œä½†æ˜¯å‡½æ•°æ˜¯ JavaScript ä¸­ç‰¹æ®Šçš„å¯¹è±¡ã€‚å› ä¸ºå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œå®ƒä»¬ä¹Ÿå¯ä»¥æ‹¥æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œå°±åƒæ™®é€šçš„å¯¹è±¡å¯ä»¥æ‹¥æœ‰å±æ€§å’Œæ–¹æ³•ä¸€æ ·ã€‚ç”šè‡³å¯ä»¥ç”¨ Function() æ„é€ å‡½æ•°æ¥åˆ›å»ºæ–°çš„å‡½æ•°å¯¹è±¡ã€‚æ¥ä¸‹æ¥å‡ èŠ‚å°±ä¼šç€é‡ä»‹ç»å‡½æ•° lengthã€name å’Œ prototype å±æ€§ï¼›call()ã€ apply()ã€ bind() å’Œ toString() æ–¹æ³•ï¼›ä»¥åŠ Function() æ„é€ å‡½æ•°ã€‚</p>
</blockquote>
<h3 id="8-7-1-The-length-Property"><a href="#8-7-1-The-length-Property" class="headerlink" title="8.7.1 The length Property"></a>8.7.1 The length Property</h3><p>The read-only length property of a function specifies the arity of the functionâ€”the number of parameters it declares in its parameter list, which is usually the number of arguments that the function expects. If a function has a rest parameter, that parameter is not counted for the purposes of this length property.</p>
<blockquote>
<p>å‡½æ•°çš„åªè¯»å±æ€§ length æŒ‡å®šå‡½æ•°å‚æ•°ä¸ªæ•°â€“å£°æ˜åœ¨å…¶å‚æ•°åˆ—è¡¨ä¸­çš„å‚æ•°ä¸ªæ•°ï¼Œå¤§å¤šæ•°å‡½æ•°æœŸæœ›çš„å®å‚ä¸ªæ•°ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªå‰©ä½™å‡½æ•°ï¼Œå®ƒçš„å‚æ•°ä¸ªæ•°ä¸è¢«è®¡ç®—å…¥ length å±æ€§ã€‚ï¼ˆç»æµ‹è¯•ï¼Œå¯é€‰å‚æ•°ä¹Ÿä¸è®¡ç®— lengthã€‚ï¼‰</p>
</blockquote>
<h3 id="8-7-2-The-name-Property"><a href="#8-7-2-The-name-Property" class="headerlink" title="8.7.2 The name Property"></a>8.7.2 The name Property</h3><p>The read-only name property of a function specifies the name that was used when the function was defined, if it was defined with a name, or the name of the variable or property that an unnamed function expression was assigned to when it was first created. This property is primarily useful when writing debugging or error messages.</p>
<blockquote>
<p>å¦‚æœä½¿ç”¨åç§°å®šä¹‰å‡½æ•°ï¼Œåªè¯»å±æ€§ name æŒ‡å®šå‡½æ•°å®šä¹‰æ—¶ç”¨çš„åç§°ï¼Œæˆ–æœªå‘½åå‡½æ•°è¡¨è¾¾å¼åœ¨é¦–æ¬¡åˆ›å»ºæ—¶åˆ†é…ç»™çš„å˜é‡æˆ–å±æ€§çš„åç§°ã€‚æ­¤å±æ€§åœ¨ç¼–å†™è°ƒè¯•æˆ–é”™è¯¯æ¶ˆæ¯æ—¶å¾ˆæœ‰ç”¨ã€‚</p>
</blockquote>
<h3 id="8-7-3-The-prototype-Property"><a href="#8-7-3-The-prototype-Property" class="headerlink" title="8.7.3 The prototype Property"></a>8.7.3 The prototype Property</h3><p>All functions, except arrow functions, have a prototype property that refers to an object known as the prototype object. Every function has a different prototype object. When a function is used as a constructor, the newly created object inherits properties from the prototype object. Prototypes and the prototype property were discussed in Â§6.2.3 and will be covered again in Chapter 9.</p>
<blockquote>
<p>æ‰€æœ‰å‡½æ•°éƒ½åŒ…å«ä¸€ä¸ª prototype å±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯æŒ‡å‘ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œè¿™ä¸ªå¯¹è±¡ç§°åšåŸå‹å¯¹è±¡ã€‚æ¯ä¸€ä¸ªå‡½æ•°éƒ½åŒ…å«ä¸åŒçš„åŸå‹å¯¹è±¡ã€‚å½“å°†å‡½æ•°ç”¨ä½œæ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œæ–°åˆ›å»ºçš„å¯¹è±¡ä¼šä»åŸå‹å¯¹è±¡ä¸Šç»§æ‰¿å±æ€§ã€‚Â§6.2.3 è®¨è®ºäº†åŸå‹å’Œ prototype å±æ€§ï¼Œåœ¨ç¬¬ 9 ç« é‡Œä¼šæœ‰è¿›ä¸€æ­¥è®¨è®ºã€‚</p>
</blockquote>
<h3 id="8-7-4-The-call-and-apply-Methods"><a href="#8-7-4-The-call-and-apply-Methods" class="headerlink" title="8.7.4 The call() and apply() Methods"></a>8.7.4 The call() and apply() Methods</h3><p>call() and apply() allow you to indirectly invoke (Â§8.2.4) a function as if it were a method of some other object. The first argument to both call() and apply() is the object on which the function is to be invoked; this argument is the invocation context and becomes the value of the this keyword within the body of the function. To invoke the function f() as a method of the object o (passing no arguments), you could use either call() or apply():</p>
<blockquote>
<p>æˆ‘ä»¬å¯ä»¥å°† call() å’Œ apply () çœ‹åšæ˜¯æŸä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œé€šè¿‡è°ƒç”¨æ–¹æ³•çš„å½¢å¼æ¥é—´æ¥è°ƒç”¨ï¼ˆè§ Â§8.2.4ï¼‰å‡½æ•°ã€‚call() å’Œ apply() çš„ç¬¬ä¸€ä¸ªå®å‚æ˜¯è¦è°ƒç”¨å‡½æ•°çš„æ¯å¯¹è±¡ï¼Œå®ƒæ˜¯è°ƒç”¨ä¸Šä¸‹æ–‡ï¼Œåœ¨å‡½æ•°ä½“å†…å˜æˆ this å…³é”®å­—çš„å€¼ã€‚è¦æƒ³ä»¥å¯¹è±¡ o çš„æ–¹æ³•æ¥è°ƒç”¨å‡½æ•° f()ï¼ˆæ²¡æœ‰å®å‚ä¼ é€’ï¼‰ï¼Œå¯ä»¥è¿™æ ·ä½¿ç”¨ call() å’Œ apply()ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f.<span class="title function_">call</span>(o);</span><br><span class="line">f.<span class="title function_">apply</span>(o);</span><br></pre></td></tr></table></figure>
<p>Either of these lines of code are similar to the following (which assume that o does not already have a property named m):</p>
<blockquote>
<p>æ¯è¡Œä»£ç å’Œä¸‹é¢ä»£ç çš„åŠŸèƒ½ç±»ä¼¼ï¼ˆå‡è®¾å¯¹è±¡ o ä¸­é¢„å…ˆä¸å­˜åœ¨åä¸º m çš„å±æ€§ï¼‰:</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">o.<span class="property">m</span> = f;     <span class="comment">// Make f a temporary method of o.</span></span><br><span class="line">o.<span class="title function_">m</span>();       <span class="comment">// Invoke it, passing no arguments.</span></span><br><span class="line"><span class="keyword">delete</span> o.<span class="property">m</span>;  <span class="comment">// Remove the temporary method.</span></span><br></pre></td></tr></table></figure>
<p>Remember that arrow functions inherit the this value of the context where they are defined. This cannot be overridden with the call() and apply() methods. If you call either of those methods on an arrow function, the first argument is effectively ignored.</p>
<blockquote>
<p>ä¸è¦å¿˜äº†ï¼Œç®­å¤´å‡½æ•°ä»å®ƒå®šä¹‰çš„ä½ç½®çš„ä¸Šä¸‹æ–‡ç»§æ‰¿ this å€¼ã€‚è¿™ä¸èƒ½è¢« call() å’Œ apply() æ–¹æ³•é‡å†™ã€‚å¦‚æœé€šè¿‡ç®­å¤´å‡½æ•°è°ƒç”¨å®ƒä¿©ä»»ä½•ä¸€ä¸ªæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå®å‚å®é™…ä¸Šéƒ½è¢«å¿½ç•¥ã€‚</p>
</blockquote>
<p>Any arguments to call() after the first invocation context argument are the values that are passed to the function that is invoked (and these arguments are not ignored for arrow functions). For example, to pass two numbers to the function f() and invoke it as if it were a method of the object o, you could use code like this:</p>
<blockquote>
<p>å¯¹äº call() æ¥è¯´ï¼Œé™¤äº†ç¬¬ä¸€ä¸ªä½œä¸ºè°ƒç”¨ä¸Šä¸‹æ–‡å®å‚ï¼Œä¹‹åçš„æ‰€æœ‰å®å‚å°±æ˜¯è¦ä¼ å…¥å¾…è°ƒç”¨å‡½æ•°çš„å€¼ï¼ˆå¹¶ä¸”ï¼Œè¿™éƒ¨åˆ†å®å‚å¯¹äºç®­å¤´å‡½æ•°æ¥è¯´ä¸è¢«å¿½ç•¥ï¼‰ã€‚æ¯”å¦‚ï¼Œä»¥å¯¹è±¡ o çš„æ–¹æ³•çš„å½¢å¼è°ƒç”¨å‡½æ•° f()ï¼Œå¹¶ä¼ å…¥ä¸¤ä¸ªæ•°ï¼Œå¯ä»¥ä½¿ç”¨è¿™æ ·çš„ä»£ç ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f.<span class="title function_">call</span>(o, <span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>
<p>The apply() method is like the call() method, except that the arguments to be passed to the function are specified as an array:</p>
<blockquote>
<p>apply() æ–¹æ³•å’Œ call() ç±»ä¼¼ï¼Œä½†ä¼ å…¥å®å‚çš„å½¢å¼å’Œ call() æœ‰æ‰€ä¸åŒï¼Œå®ƒçš„å®å‚éƒ½æ”¾å…¥ä¸€ä¸ªæ•°ç»„ä¸­ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f.<span class="title function_">apply</span>(o, [<span class="number">1</span>,<span class="number">2</span>]);</span><br></pre></td></tr></table></figure>
<p>If a function is defined to accept an arbitrary number of arguments, the apply() method allows you to invoke that function on the contents of an array of arbitrary length. In ES6 and later, we can just use the spread operator, but you may see ES5 code that uses apply() instead. For example, to find the largest number in an array of numbers without using the spread operator, you could use the apply() method to pass the elements of the array to the Math.max() function:</p>
<blockquote>
<p>å¦‚æœä¸€ä¸ªå‡½æ•°çš„å®å‚å¯ä»¥æ˜¯ä»»æ„æ•°é‡ï¼Œç”¨ apply() æ–¹æ³•å…è®¸ä½ ä¼ å…¥çš„å‚æ•°æ•°ç»„å¯ä»¥æ˜¯ä»»æ„é•¿åº¦çš„ã€‚åœ¨ ES6 ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å±•å¼€è¿ç®—ç¬¦ï¼Œä½†æ˜¯åœ¨ ES5 çš„ä»£ç ä¸­ä½ å¯ä»¥çœ‹åˆ°è¿™ç§æƒ…å†µæ˜¯ç”¨ apply() æ¥æ›¿ä»£ã€‚æ¯”å¦‚ï¼Œä¸ç”¨å±•å¼€è¿ç®—ç¬¦æ‰¾å‡ºæ•°ç»„ä¸­æœ€å¤§çš„æ•°å€¼å…ƒç´ ï¼Œè°ƒç”¨ Math.max() æ–¹æ³•çš„æ—¶å€™å¯ä»¥ç»™  apply() ä¼ å…¥ä¸€ä¸ªåŒ…å«ä»»æ„ä¸ªå…ƒç´ çš„æ•°ç»„ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> biggest = <span class="title class_">Math</span>.<span class="property">max</span>.<span class="title function_">apply</span>(<span class="title class_">Math</span>, arrayOfNumbers);</span><br></pre></td></tr></table></figure>
<p>The trace() function defined in the following is similar to the timed() function defined in Â§8.3.4, but it works for methods instead of functions. It uses the apply() method instead of a spread operator, and by doing that, it is able to invoke the wrapped method with the same arguments and the same this value as the wrapper method:</p>
<blockquote>
<p>ä¸‹é¢å®šä¹‰çš„ trace() ä¸ Â§8.3.4 ä¸­å®šä¹‰çš„ timed() å‡½æ•°ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒå¯¹æ–¹æ³•æœ‰æ•ˆè€Œä¸æ˜¯å‡½æ•°ã€‚å®ƒä½¿ç”¨ apply() æ–¹æ³•è€Œä¸æ˜¯å±•å¼€è¿ç®—ç¬¦ï¼Œé€šè¿‡è¿™æ ·åšï¼Œå®ƒèƒ½å¤Ÿè°ƒç”¨å…·æœ‰ç›¸åŒå‚æ•°å’Œä¸è¢«åŒ…è£…æ–¹æ³•ç›¸åŒçš„ this å€¼çš„åŒ…è£…æ–¹æ³•ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Replace the method named m of the object o with a version that logs</span></span><br><span class="line"><span class="comment">// messages before and after invoking the original method.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">trace</span>(<span class="params">o, m</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> original = o[m];         <span class="comment">// Remember original method in the closure.</span></span><br><span class="line">    o[m] = <span class="keyword">function</span>(<span class="params">...args</span>) &#123;   <span class="comment">// Now define the new method.</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(), <span class="string">&quot;Entering:&quot;</span>, m);      <span class="comment">// Log message.</span></span><br><span class="line">        <span class="keyword">let</span> result = original.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);      <span class="comment">// Invoke original.</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(), <span class="string">&quot;Exiting:&quot;</span>, m);       <span class="comment">// Log message.</span></span><br><span class="line">        <span class="keyword">return</span> result;                                <span class="comment">// Return result.</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-7-5-The-bind-Method"><a href="#8-7-5-The-bind-Method" class="headerlink" title="8.7.5 The bind() Method"></a>8.7.5 The bind() Method</h3><p>The primary purpose of bind() is to bind a function to an object. When you invoke the bind() method on a function f and pass an object o, the method returns a new function. Invoking the new function (as a function) invokes the original function f as a method of o. Any arguments you pass to the new function are passed to the original function. For example:</p>
<blockquote>
<p>bind() æ–¹æ³•çš„ä¸»è¦ä½œç”¨å°±æ˜¯å°†å‡½æ•°ç»‘å®šè‡³æŸä¸ªå¯¹è±¡ã€‚å½“åœ¨å‡½æ•° f() ä¸Šè°ƒç”¨ bind() æ–¹æ³•å¹¶ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ o ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªæ–¹æ³•å°†è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚ï¼ˆä»¥å‡½æ•°è°ƒç”¨çš„æ–¹å¼ï¼‰è°ƒç”¨æ–°çš„å‡½æ•°å°†ä¼šæŠŠåŸå§‹çš„å‡½æ•° f() å½“åš o çš„æ–¹æ³•æ¥è°ƒç”¨ã€‚ä¼ å…¥æ–°å‡½æ•°çš„ä»»ä½•å®å‚éƒ½å°†ä¼ å…¥åŸå§‹å‡½æ•°ï¼Œæ¯”å¦‚ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">y</span>) &#123; <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">x</span> + y; &#125; <span class="comment">// This function needs to be bound</span></span><br><span class="line"><span class="keyword">let</span> o = &#123; <span class="attr">x</span>: <span class="number">1</span> &#125;;                    <span class="comment">// An object we&#x27;ll bind to</span></span><br><span class="line"><span class="keyword">let</span> g = f.<span class="title function_">bind</span>(o);                   <span class="comment">// Calling g(x) invokes f() on o</span></span><br><span class="line"><span class="title function_">g</span>(<span class="number">2</span>)                                 <span class="comment">// =&gt; 3</span></span><br><span class="line"><span class="keyword">let</span> p = &#123; <span class="attr">x</span>: <span class="number">10</span>, g &#125;;                <span class="comment">// Invoke g() as a method of this object</span></span><br><span class="line">p.<span class="title function_">g</span>(<span class="number">2</span>)                               <span class="comment">// =&gt; 3: g is still bound to o, not p.</span></span><br></pre></td></tr></table></figure>
<p>Arrow functions inherit their this value from the environment in which they are defined, and that value cannot be overridden with bind(), so if the function f() in the preceding code was defined as an arrow function, the binding would not work. The most common use case for calling bind() is to make non-arrow functions behave like arrow functions, however, so this limitation on binding arrow functions is not a problem in practice.</p>
<blockquote>
<p>ç®­å¤´å‡½æ•°ä»å®ƒä»¬å®šä¹‰çš„ä¸Šä¸‹æ–‡ä¸­ç»§æ‰¿ this å€¼ï¼Œå¹¶ä¸”å…¶ä¸å¯è¢« bind() æ–¹æ³•é‡å†™ï¼Œæ‰€ä»¥å¦‚æœä¸Šé¢çš„ä»£ç ç”¨ç®­å¤´å‡½æ•°å®šä¹‰å‡½æ•° f()ï¼Œè¿™ä¸ªç»‘å®šä¸ä¼šç”Ÿæ•ˆã€‚è°ƒç”¨ bind() æ–¹æ³•çš„æœ€å¸¸ç”¨åœºæ™¯æ˜¯è®©ä¸å¸¦ç®­å¤´çš„å‡½æ•°çš„è¡Œä¸ºåƒç®­å¤´å‡½æ•°ä¸€æ ·ï¼Œæ‰€ä»¥å®é™…ä¸Šç»‘å®šç®­å¤´å‡½æ•°çš„ this å±€é™æ€§å¹¶ä¸æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚</p>
</blockquote>
<p>The bind() method does more than just bind a function to an object, however. It can also perform partial application: any arguments you pass to bind() after the first are bound along with the this value. This partial application feature of bind() does work with arrow functions. Partial application is a common technique in functional programming and is sometimes called currying. Here are some examples of the bind() method used for partial application:</p>
<blockquote>
<p>ä½†æ˜¯ bind() æ–¹æ³•ä¸ä»…ä»…æ˜¯å°†å‡½æ•°ç»‘å®šè‡³ä¸€ä¸ªå¯¹è±¡ã€‚å®ƒè¿˜é™„å¸¦ä¸€äº›å…¶ä»–åº”ç”¨ï¼šé™¤äº†ç¬¬ä¸€ä¸ªå®å‚ä¹‹å¤–ï¼Œä¼ å…¥ bind() çš„å®å‚ä¹Ÿä¼šç»‘å®šè‡³ this å€¼ã€‚è¿™ä¸ªé™„å¸¦çš„åº”ç”¨åœ¨ç®­å¤´å‡½æ•°ä¸Šä¹ŸåŒæ ·ç”Ÿæ•ˆã€‚æ˜¯ä¸€ç§å¸¸è§çš„å‡½æ•°å¼ç¼–ç¨‹æŠ€æœ¯ï¼Œæœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºâ€œæŸ¯é‡ŒåŒ–â€ã€‚å‚ç…§ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­çš„ bind() æ–¹æ³•çš„å®ç°ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title function_">sum</span> = (<span class="params">x,y</span>) =&gt; x + y;      <span class="comment">// Return the sum of 2 args</span></span><br><span class="line"><span class="keyword">let</span> succ = sum.<span class="title function_">bind</span>(<span class="literal">null</span>, <span class="number">1</span>);  <span class="comment">// Bind the first argument to 1</span></span><br><span class="line"><span class="title function_">succ</span>(<span class="number">2</span>)  <span class="comment">// =&gt; 3: x is bound to 1, and we pass 2 for the y argument</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">y,z</span>) &#123; <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">x</span> + y + z; &#125;</span><br><span class="line"><span class="keyword">let</span> g = f.<span class="title function_">bind</span>(&#123;<span class="attr">x</span>: <span class="number">1</span>&#125;, <span class="number">2</span>);     <span class="comment">// Bind this and y</span></span><br><span class="line"><span class="title function_">g</span>(<span class="number">3</span>)     <span class="comment">// =&gt; 6: this.x is bound to 1, y is bound to 2 and z is 3</span></span><br></pre></td></tr></table></figure>
<p>The name property of the function returned by bind() is the name property of the function that bind() was called on, prefixed with the word â€œboundâ€.</p>
<blockquote>
<p>bind() è¿”å›å‡½æ•°çš„åç§°å±æ€§æ˜¯è°ƒç”¨ bind() çš„å‡½æ•°çš„åç§°å±æ€§å‰é¢åŠ ä¸Šå‰ç¼€ä¸ºå•è¯â€boundâ€ã€‚</p>
</blockquote>
<h3 id="8-7-6-The-toString-Method"><a href="#8-7-6-The-toString-Method" class="headerlink" title="8.7.6 The toString() Method"></a>8.7.6 The toString() Method</h3><p>Like all JavaScript objects, functions have a toString() method. The ECMAScript spec requires this method to return a string that follows the syntax of the function declaration statement. In practice, most (but not all) implementations of this toString() method return the complete source code for the function. Built-in functions typically return a string that includes something like â€œ[native code]â€ as the function body.</p>
<blockquote>
<p>å’Œæ‰€æœ‰çš„ JavaScript å¯¹è±¡ä¸€æ ·ï¼Œå‡½æ•°ä¹Ÿæœ‰ toString() æ–¹æ³•ï¼ŒECMAScript è§„èŒƒè§„å®šè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å’Œå‡½æ•°å£°æ˜è¯­å¥çš„è¯­æ³•ç›¸å…³ã€‚å®é™…ä¸Šï¼Œå¤§å¤šæ•°ï¼ˆéå…¨éƒ¨ï¼‰çš„ toString() æ–¹æ³•çš„å®ç°éƒ½è¿”å›å‡½æ•°çš„å®Œæ•´æºç ã€‚å†…ç½®å‡½æ•°å¾€å¾€è¿”å›ä¸€ä¸ªç±»ä¼¼â€[native code]â€çš„å­—ç¬¦ä¸²ä½œä¸ºå‡½æ•°ä½“ã€‚</p>
</blockquote>
<h3 id="8-7-7-The-Function-Constructor"><a href="#8-7-7-The-Function-Constructor" class="headerlink" title="8.7.7 The Function() Constructor"></a>8.7.7 The Function() Constructor</h3><p>Because functions are objects, there is a Function() constructor that can be used to create new functions:</p>
<blockquote>
<p>å› ä¸ºå‡½æ•°æ˜¯å¯¹è±¡ï¼Œæœ‰ä¸€ä¸ª Function() æ„é€ å‡½æ•°å¯ä»¥ç”¨æ¥åˆ›å»ºæ–°çš„å‡½æ•°ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="keyword">new</span> <span class="title class_">Function</span>(<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;return x*y;&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>This line of code creates a new function that is more or less equivalent to a function defined with the familiar syntax:</p>
<blockquote>
<p>è¿™ä¸€è¡Œä»£ç åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å’Œé€šè¿‡ä¸‹é¢ä»£ç å®šä¹‰çš„å‡½æ•°å‡ ä¹ç­‰ä»·ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="keyword">function</span>(<span class="params">x, y</span>) &#123; <span class="keyword">return</span> x*y; &#125;;</span><br></pre></td></tr></table></figure>
<p>The Function() constructor expects any number of string arguments. The last argument is the text of the function body; it can contain arbitrary JavaScript statements, separated from each other by semicolons. All other arguments to the constructor are strings that specify the parameter names for the function. If you are defining a function that takes no arguments, you would simply pass a single stringâ€”the function bodyâ€”to the constructor.</p>
<blockquote>
<p>Function() æ„é€ å‡½æ•°å¯ä»¥ä¼ å…¥ä»»æ„æ•°é‡çš„å­—ç¬¦ä¸²å®å‚ï¼Œæœ€åä¸€ä¸ªå®å‚æ‰€è¡¨ç¤ºçš„æ–‡æœ¬å°±æ˜¯å‡½æ•°ä½“ï¼›å®ƒå¯ä»¥åŒ…å«ä»»æ„çš„ JavaScript è¯­å¥ï¼Œæ¯ä¸¤æ¡è¯­å¥ä¹‹é—´ç”¨åˆ†å·åˆ†éš”ã€‚ä¼ å…¥æ„é€ å‡½æ•°çš„å…¶ä»–æ‰€æœ‰çš„å®å‚å­—ç¬¦ä¸²æ˜¯æŒ‡å®šå‡½æ•°çš„å½¢å‚åå­—çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå®šä¹‰çš„å‡½æ•°ä¸åŒ…å«ä»»ä½•å‚æ•°ï¼Œåªé¡»ç»™æ„é€ å‡½æ•°ç®€å•åœ°ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²â€”â€”å‡½æ•°ä½“â€”â€”å³å¯ã€‚</p>
</blockquote>
<p>Notice that the Function() constructor is not passed any argument that specifies a name for the function it creates. Like function literals, the Function() constructor creates anonymous functions.</p>
<blockquote>
<p>æ³¨æ„ï¼ŒFunction() æ„é€ å‡½æ•°å¹¶ä¸éœ€è¦é€šè¿‡ä¼ å…¥å®å‚ä»¥æŒ‡å®šå‡½æ•°åã€‚å°±åƒå‡½æ•°å­—é¢é‡ä¸€æ ·ï¼ŒFunction() æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ã€‚</p>
</blockquote>
<p>There are a few points that are important to understand about the Function() constructor:</p>
<blockquote>
<p>å…³äº Function() æ„é€ å‡½æ•°æœ‰å‡ ç‚¹éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š</p>
</blockquote>
<p>The Function() constructor allows JavaScript functions to be dynamically created and compiled at runtime.</p>
<blockquote>
<p>Function() æ„é€ å‡½æ•°å…è®¸ JavaScript åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°åˆ›å»ºå¹¶ç¼–è¯‘å‡½æ•°ã€‚</p>
</blockquote>
<p>The Function() constructor parses the function body and creates a new function object each time it is called. If the call to the constructor appears within a loop or within a frequently called function, this process can be inefficient. By contrast, nested functions and function expressions that appear within loops are not recompiled each time they are encountered.</p>
<blockquote>
<p>æ¯æ¬¡è°ƒç”¨ Function() æ„é€ å‡½æ•°éƒ½ä¼šè§£æå‡½æ•°ä½“ï¼Œå¹¶åˆ›å»ºæ–°çš„å‡½æ•°å¯¹è±¡ã€‚å¦‚æœæ˜¯åœ¨ä¸€ä¸ªå¾ªç¯æˆ–è€…å¤šæ¬¡è°ƒç”¨çš„å‡½æ•°ä¸­æ‰§è¡Œè¿™ä¸ªæ„é€ å‡½æ•°ï¼Œæ‰§è¡Œæ•ˆç‡ä¼šå—å½±å“ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¾ªç¯ä¸­çš„åµŒå¥—å‡½æ•°å’Œå‡½æ•°å®šä¹‰è¡¨è¾¾å¼åˆ™ä¸ä¼šæ¯æ¬¡æ‰§è¡Œæ—¶éƒ½é‡æ–°ç¼–è¯‘ã€‚</p>
</blockquote>
<p>A last, very important point about the Function() constructor is that the functions it creates do not use lexical scoping; instead, they are always compiled as if they were top-level functions, as the following code demonstrates:</p>
<blockquote>
<p>æœ€åä¸€ç‚¹ï¼Œä¹Ÿæ˜¯å…³äº Function() æ„é€ å‡½æ•°éå¸¸é‡è¦çš„ä¸€ç‚¹ï¼Œå°±æ˜¯å®ƒæ‰€åˆ›å»ºçš„å‡½æ•°å¹¶ä¸æ˜¯ä½¿ç”¨è¯æ³•ä½œç”¨åŸŸï¼Œç›¸åï¼Œå‡½æ•°ä½“ä»£ç çš„ç¼–è¯‘ç±»ä¼¼é¡¶å±‚å‡½æ•°ï¼Œå¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> scope = <span class="string">&quot;global&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">constructFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> scope = <span class="string">&quot;local&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Function</span>(<span class="string">&quot;return scope&quot;</span>);  <span class="comment">// Doesn&#x27;t capture local scope!</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// This line returns &quot;global&quot; because the function returned by the</span></span><br><span class="line"><span class="comment">// Function() constructor does not use the local scope.</span></span><br><span class="line"><span class="title function_">constructFunction</span>()()  <span class="comment">// =&gt; &quot;global&quot;</span></span><br></pre></td></tr></table></figure>
<p>The Function() constructor is best thought of as a globally scoped version of eval() (see Â§4.12.2) that defines new variables and functions in its own private scope. You will probably never need to use this constructor in your code.</p>
<blockquote>
<p>æˆ‘ä»¬å¯ä»¥å°† Function() æ„é€ å‡½æ•°è®¤ä¸ºæ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸä¸­æ‰§è¡Œçš„ eval()ï¼ˆè§  Â§4.12.2ï¼‰ï¼Œeval() å¯ä»¥åœ¨è‡ªå·±çš„ç§æœ‰ä½œç”¨åŸŸå†…å®šä¹‰æ–°å˜é‡å’Œå‡½æ•°ï¼ŒFunction() æ„é€ å‡½æ•°åœ¨å®é™…ç¼–ç¨‹è¿‡ç¨‹ä¸­å¾ˆå°‘ä¼šç”¨åˆ°ã€‚</p>
</blockquote>
<h2 id="8-8-Functional-Programming"><a href="#8-8-Functional-Programming" class="headerlink" title="8.8 Functional Programming"></a>8.8 Functional Programming</h2><p>JavaScript is not a functional programming language like Lisp or Haskell, but the fact that JavaScript can manipulate functions as objects means that we can use functional programming techniques in JavaScript. Array methods such as map() and reduce() lend themselves particularly well to a functional programming style. The sections that follow demonstrate techniques for functional programming in JavaScript. They are intended as a mind-expanding exploration of the power of JavaScriptâ€™s functions, not as a prescription for good programming style.</p>
<blockquote>
<p>å’Œ Lispã€Haskell ä¸åŒï¼ŒJavaScript å¹¶éå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œä½†åœ¨ JavaScript ä¸­å¯ä»¥åƒæ“æ§å¯¹è±¡ä¸€æ ·æ“æ§å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥åœ¨ JavaScript ä¸­åº”ç”¨å‡½æ•°å¼ç¼–ç¨‹æŠ€æœ¯ã€‚æ•°ç»„æ–¹æ³•è¯¸å¦‚ map() å’Œ reduce() å°±å¯ä»¥éå¸¸é€‚åˆç”¨äºå‡½æ•°å¼ç¼–ç¨‹é£æ ¼ã€‚æ¥ä¸‹æ¥çš„å‡ èŠ‚å°†ä¼šç€é‡ä»‹ç» JavaScript ä¸­çš„å‡½æ•°å¼ç¼–ç¨‹æŠ€æœ¯ã€‚å‡½æ•°å¼ç¼–ç¨‹æ—¨åœ¨æ‰©å±•å¯¹ JavaScript å‡½æ•°åŠŸèƒ½åŠŸèƒ½çš„æ¢ç´¢ï¼Œè€Œä¸æ˜¯ä¸ºäº†è‰¯å¥½çš„ç¼–ç¨‹é£æ ¼ã€‚</p>
</blockquote>
<h3 id="8-8-1-Processing-Arrays-with-Functions"><a href="#8-8-1-Processing-Arrays-with-Functions" class="headerlink" title="8.8.1 Processing Arrays with Functions"></a>8.8.1 Processing Arrays with Functions</h3><p>Suppose we have an array of numbers and we want to compute the mean and standard deviation of those values. We might do that in nonfunctional style like this:</p>
<blockquote>
<p>å‡è®¾æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„å…ƒç´ éƒ½æ˜¯æ•°å­—ï¼Œæˆ‘ä»¬æƒ³è¦è®¡ç®—è¿™äº›å…ƒç´ çš„å¹³å‡å€¼å’Œæ ‡å‡†å·®ã€‚è‹¥ä½¿ç”¨éå‡½æ•°å¼ç¼–ç¨‹é£æ ¼çš„è¯ï¼Œä»£ç ä¼šæ˜¯è¿™æ ·ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> data = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">5</span>];  <span class="comment">// This is our array of numbers</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The mean is the sum of the elements divided by the number of elements</span></span><br><span class="line"><span class="keyword">let</span> total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) total += data[i];</span><br><span class="line"><span class="keyword">let</span> mean = total/data.<span class="property">length</span>;  <span class="comment">// mean == 3; The mean of our data is 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// To compute the standard deviation, we first sum the squares of</span></span><br><span class="line"><span class="comment">// the deviation of each element from the mean.</span></span><br><span class="line">total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> deviation = data[i] - mean;</span><br><span class="line">    total += deviation * deviation;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> stddev = <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(total/(data.<span class="property">length</span>-<span class="number">1</span>));  <span class="comment">// stddev == 2</span></span><br></pre></td></tr></table></figure>
<p>We can perform these same computations in concise functional style using the array methods map() and reduce() like this (see Â§7.8.1 to review these methods):</p>
<blockquote>
<p>å¯ä»¥ä½¿ç”¨æ•°ç»„æ–¹æ³• map() å’Œ reduce() æ¥å®ç°åŒæ ·çš„è®¡ç®—ï¼Œè¿™ç§å®ç°æå…¶ç®€æ´ï¼ˆå‚ç…§ Â§7.8.1 æ¥æŸ¥çœ‹è¿™äº›æ–¹æ³•ï¼‰ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// First, define two simple functions</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">sum</span> = (<span class="params">x,y</span>) =&gt; x+y;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">square</span> = x =&gt; x*x;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Then use those functions with Array methods to compute mean and stddev</span></span><br><span class="line"><span class="keyword">let</span> data = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> mean = data.<span class="title function_">reduce</span>(sum)/data.<span class="property">length</span>;  <span class="comment">// mean == 3</span></span><br><span class="line"><span class="keyword">let</span> deviations = data.<span class="title function_">map</span>(<span class="function"><span class="params">x</span> =&gt;</span> x-mean);</span><br><span class="line"><span class="keyword">let</span> stddev = <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(deviations.<span class="title function_">map</span>(square).<span class="title function_">reduce</span>(sum)/(data.<span class="property">length</span>-<span class="number">1</span>));</span><br><span class="line">stddev  <span class="comment">// =&gt; 2</span></span><br></pre></td></tr></table></figure>
<p>This new version of the code looks quite different than the first one, but it is still invoking methods on objects, so it has some object-oriented conventions remaining. Letâ€™s write functional versions of the map() and reduce() methods:</p>
<blockquote>
<p>è¿™ä¸ªæ–°ç‰ˆæœ¬çš„ä»£ç çœ‹èµ·æ¥è·Ÿç¬¬ä¸€ç‰ˆæœ‰å¾ˆå¤§ä¸åŒï¼Œä½†æ˜¯å®ƒä»ç„¶è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼Œæ‰€ä»¥å®ƒè¿˜æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚æ¥ä¸‹æ¥ç”¨å‡½æ•°ç‰ˆæœ¬çš„ map() å’Œ reduce() æ–¹æ³•ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">function</span>(<span class="params">a, ...args</span>) &#123; <span class="keyword">return</span> a.<span class="title function_">map</span>(...args); &#125;;</span><br><span class="line"><span class="keyword">const</span> reduce = <span class="keyword">function</span>(<span class="params">a, ...args</span>) &#123; <span class="keyword">return</span> a.<span class="title function_">reduce</span>(...args); &#125;;</span><br></pre></td></tr></table></figure>
<p>With these map() and reduce() functions defined, our code to compute the mean and standard deviation now looks like this:</p>
<blockquote>
<p>ç”¨è¿™ä¸¤ä¸ªå‡½æ•°å®šä¹‰äº† map() å’Œ reduce()ï¼Œæˆ‘ä»¬è®¡ç®—å¹³å‡å€¼å’Œæ ‡å‡†å·®å˜æˆè¿™æ ·ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">sum</span> = (<span class="params">x,y</span>) =&gt; x+y;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">square</span> = x =&gt; x*x;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> data = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> mean = <span class="title function_">reduce</span>(data, sum)/data.<span class="property">length</span>;</span><br><span class="line"><span class="keyword">let</span> deviations = <span class="title function_">map</span>(data, <span class="function"><span class="params">x</span> =&gt;</span> x-mean);</span><br><span class="line"><span class="keyword">let</span> stddev = <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(<span class="title function_">reduce</span>(<span class="title function_">map</span>(deviations, square), sum)/(data.<span class="property">length</span>-<span class="number">1</span>));</span><br><span class="line">stddev  <span class="comment">// =&gt; 2</span></span><br></pre></td></tr></table></figure>
<h3 id="8-8-2-Higher-Order-Functions"><a href="#8-8-2-Higher-Order-Functions" class="headerlink" title="8.8.2 Higher-Order Functions"></a>8.8.2 Higher-Order Functions</h3><p>A higher-order function is a function that operates on functions, taking one or more functions as arguments and returning a new function. Here is an example:</p>
<blockquote>
<p>æ‰€è°“é«˜é˜¶å‡½æ•°å°±æ˜¯æ“ä½œå‡½æ•°çš„å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæˆ–å¤šä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ã€‚æ¥çœ‹è¿™ä¸ªä¾‹å­ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This higher-order function returns a new function that passes its</span></span><br><span class="line"><span class="comment">// arguments to f and returns the logical negation of f&#x27;s return value;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">not</span>(<span class="params">f</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>) &#123;             <span class="comment">// Return a new function</span></span><br><span class="line">        <span class="keyword">let</span> result = f.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);  <span class="comment">// that calls f</span></span><br><span class="line">        <span class="keyword">return</span> !result;                    <span class="comment">// and negates its result.</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">even</span> = x =&gt; x % <span class="number">2</span> === <span class="number">0</span>; <span class="comment">// A function to determine if a number is even</span></span><br><span class="line"><span class="keyword">const</span> odd = <span class="title function_">not</span>(even);         <span class="comment">// A new function that does the opposite</span></span><br><span class="line">[<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">5</span>].<span class="title function_">every</span>(odd)         <span class="comment">// =&gt; true: every element of the array is odd</span></span><br></pre></td></tr></table></figure>
<p>This not() function is a higher-order function because it takes a function argument and returns a new function. As another example, consider the mapper() function that follows. It takes a function argument and returns a new function that maps one array to another using that function. This function uses the map() function defined earlier, and it is important that you understand how the two functions are different:</p>
<blockquote>
<p>ä¸Šé¢çš„ not() å‡½æ•°å°±æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œå› ä¸ºå®ƒæ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ã€‚å¦å¤–ä¸€ä¸ªä¾‹å­ï¼Œæ¥çœ‹ä¸‹é¢çš„ mapper() å‡½æ•°ï¼Œå®ƒä¹Ÿæ˜¯æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå®å‚ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œè¿™ä¸ªæ–°å‡½æ•°å°†ä¸€ä¸ªæ•°ç»„æ˜ å°„åˆ°å¦ä¸€ä¸ªä½¿ç”¨è¿™ä¸ªå‡½æ•°çš„æ•°ç»„ä¸Šã€‚è¿™ä¸ªå‡½æ•°ä½¿ç”¨äº†ä¹‹å‰å®šä¹‰çš„ map() å‡½æ•°ï¼Œä½†è¦é¦–å…ˆç†è§£è¿™ä¸¤ä¸ªå‡½æ•°æœ‰å“ªé‡Œä¸ åŒï¼Œç†è§£è¿™ä¸€ç‚¹è‡³å…³é‡è¦ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Return a function that expects an array argument and applies f to</span></span><br><span class="line"><span class="comment">// each element, returning the array of return values.</span></span><br><span class="line"><span class="comment">// Contrast this with the map() function from earlier.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mapper</span>(<span class="params">f</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">a</span> =&gt;</span> <span class="title function_">map</span>(a, f);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">increment</span> = x =&gt; x+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> incrementAll = <span class="title function_">mapper</span>(increment);</span><br><span class="line"><span class="title function_">incrementAll</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])  <span class="comment">// =&gt; [2,3,4]</span></span><br></pre></td></tr></table></figure>
<p>Here is another, more general, example that takes two functions, f and g, and returns a new function that computes f(g()):</p>
<blockquote>
<p>è¿™é‡Œæ˜¯ä¸€ä¸ªæ›´å¸¸è§çš„ä¾‹å­ï¼Œå®ƒæ¥æ”¶ä¸¤ä¸ªå‡½æ•° f() å’Œ g()ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ç”¨ä»¥è®¡ç®— f(g())ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Return a new function that computes f(g(...)).</span></span><br><span class="line"><span class="comment">// The returned function h passes all of its arguments to g, then passes</span></span><br><span class="line"><span class="comment">// the return value of g to f, then returns the return value of f.</span></span><br><span class="line"><span class="comment">// Both f and g are invoked with the same this value as h was invoked with.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">compose</span>(<span class="params">f, g</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">        <span class="comment">// We use call for f because we&#x27;re passing a single value and</span></span><br><span class="line">        <span class="comment">// apply for g because we&#x27;re passing an array of values.</span></span><br><span class="line">        <span class="keyword">return</span> f.<span class="title function_">call</span>(<span class="variable language_">this</span>, g.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args));</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">sum</span> = (<span class="params">x,y</span>) =&gt; x+y;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">square</span> = x =&gt; x*x;</span><br><span class="line"><span class="title function_">compose</span>(square, sum)(<span class="number">2</span>,<span class="number">3</span>)  <span class="comment">// =&gt; 25; the square of the sum</span></span><br></pre></td></tr></table></figure>
<p>The partial() and memoize() functions defined in the sections that follow are two more important higher-order functions.</p>
<blockquote>
<p>æœ¬ç« åç»­å‡ èŠ‚ä¸­å®šä¹‰äº† partial() å’Œ memoize() å‡½æ•°ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°æ˜¯éå¸¸é‡è¦çš„é«˜é˜¶å‡½æ•°ã€‚</p>
</blockquote>
<h3 id="8-8-3-Partial-Application-of-Functions"><a href="#8-8-3-Partial-Application-of-Functions" class="headerlink" title="8.8.3 Partial Application of Functions"></a>8.8.3 Partial Application of Functions</h3><p>The bind() method of a function f (see Â§8.7.5) returns a new function that invokes f in a specified context and with a specified set of arguments. We say that it binds the function to an object and partially applies the arguments. The bind() method partially applies arguments on the leftâ€”that is, the arguments you pass to bind() are placed at the start of the argument list that is passed to the original function. But it is also possible to partially apply arguments on the right:</p>
<blockquote>
<p>å‡½æ•° f()ï¼ˆè§ Â§8.7.5ï¼‰çš„ bind() æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œç»™æ–°å‡½æ•°ä¼ å…¥ç‰¹å®šçš„ä¸Šä¸‹æ–‡å’Œä¸€ç»„æŒ‡å®šçš„å‚æ•°ï¼Œç„¶åè°ƒç”¨å‡½æ•° f()ã€‚æˆ‘ä»¬è¯´å®ƒæŠŠå‡½æ•°â€œç»‘å®šè‡³â€å¯¹è±¡å¹¶ä¼ å…¥ä¸€éƒ¨åˆ†å‚æ•°ã€‚bind() æ–¹æ³•åªæ˜¯å°†å®å‚æ”¾åœ¨ï¼ˆå®Œæ•´å®å‚åˆ—è¡¨çš„ï¼‰å·¦ä¾§ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼ å…¥ bind() çš„å®å‚éƒ½æ˜¯æ”¾åœ¨ä¼ å…¥åŸå§‹å‡½æ•°çš„å®å‚åˆ—è¡¨å¼€å§‹çš„ä½ç½®ï¼Œä½†æœ‰æ—¶æˆ‘ä»¬æœŸæœ›å°†ä¼ å…¥ bind() çš„å®å‚æ”¾åœ¨ï¼ˆå®Œæ•´å®å‚åˆ—è¡¨çš„ï¼‰å³ä¾§ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The arguments to this function are passed on the left</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">partialLeft</span>(<span class="params">f, ...outerArgs</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...innerArgs</span>) &#123; <span class="comment">// Return this function</span></span><br><span class="line">        <span class="keyword">let</span> args = [...outerArgs, ...innerArgs]; <span class="comment">// Build the argument list</span></span><br><span class="line">        <span class="keyword">return</span> f.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);              <span class="comment">// Then invoke f with it</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The arguments to this function are passed on the right</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">partialRight</span>(<span class="params">f, ...outerArgs</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...innerArgs</span>) &#123;  <span class="comment">// Return this function</span></span><br><span class="line">        <span class="keyword">let</span> args = [...innerArgs, ...outerArgs]; <span class="comment">// Build the argument list</span></span><br><span class="line">        <span class="keyword">return</span> f.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);              <span class="comment">// Then invoke f with it</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The arguments to this function serve as a template. Undefined values</span></span><br><span class="line"><span class="comment">// in the argument list are filled in with values from the inner set.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">partial</span>(<span class="params">f, ...outerArgs</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...innerArgs</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> args = [...outerArgs]; <span class="comment">// local copy of outer args template</span></span><br><span class="line">        <span class="keyword">let</span> innerIndex=<span class="number">0</span>;          <span class="comment">// which inner arg is next</span></span><br><span class="line">        <span class="comment">// Loop through the args, filling in undefined values from inner args</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; args.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (args[i] === <span class="literal">undefined</span>) args[i] = innerArgs[innerIndex++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Now append any remaining inner arguments</span></span><br><span class="line">        args.<span class="title function_">push</span>(...innerArgs.<span class="title function_">slice</span>(innerIndex));</span><br><span class="line">        <span class="keyword">return</span> f.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Here is a function with three arguments</span></span><br><span class="line"><span class="keyword">const</span> f = <span class="keyword">function</span>(<span class="params">x,y,z</span>) &#123; <span class="keyword">return</span> x * (y - z); &#125;;</span><br><span class="line"><span class="comment">// Notice how these three partial applications differ</span></span><br><span class="line"><span class="title function_">partialLeft</span>(f, <span class="number">2</span>)(<span class="number">3</span>,<span class="number">4</span>)         <span class="comment">// =&gt; -2: Bind first argument: 2 * (3 - 4)</span></span><br><span class="line"><span class="title function_">partialRight</span>(f, <span class="number">2</span>)(<span class="number">3</span>,<span class="number">4</span>)        <span class="comment">// =&gt;  6: Bind last argument: 3 * (4 - 2)</span></span><br><span class="line"><span class="title function_">partial</span>(f, <span class="literal">undefined</span>, <span class="number">2</span>)(<span class="number">3</span>,<span class="number">4</span>)  <span class="comment">// =&gt; -6: Bind middle argument: 3 * (2 - 4)</span></span><br></pre></td></tr></table></figure>
<p>These partial application functions allow us to easily define interesting functions out of functions we already have defined. Here are some examples:</p>
<blockquote>
<p>åˆ©ç”¨è¿™ç§ä¸å®Œå…¨å‡½æ•°çš„ç¼–ç¨‹æŠ€å·§ï¼Œå¯ä»¥ç¼–å†™ä¸€äº›æœ‰æ„æ€çš„ä»£ç ï¼Œåˆ©ç”¨å·²æœ‰çš„å‡½æ•°æ¥å®šä¹‰æ–°çš„å‡½æ•°ï¼Œå‚ç…§ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> increment = <span class="title function_">partialLeft</span>(sum, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">const</span> cuberoot = <span class="title function_">partialRight</span>(<span class="title class_">Math</span>.<span class="property">pow</span>, <span class="number">1</span>/<span class="number">3</span>);</span><br><span class="line"><span class="title function_">cuberoot</span>(<span class="title function_">increment</span>(<span class="number">26</span>))  <span class="comment">// =&gt; 3</span></span><br></pre></td></tr></table></figure>
<p>Partial application becomes even more interesting when we combine it with other higher-order functions. Here, for example, is a way to define the preceding not() function just shown using composition and partial application:</p>
<blockquote>
<p>å½“å°†ä¸å®Œå…¨è°ƒç”¨å’Œå…¶ä»–é«˜é˜¶å‡½æ•°æ•´åˆåœ¨ä¸€èµ·çš„æ—¶å€™ï¼Œäº‹æƒ…å°±å˜å¾—æ ¼å¤–æœ‰è¶£äº†ã€‚æ¯”å¦‚ï¼Œè¿™é‡Œçš„ä¾‹å­å®šä¹‰äº† not() å‡½æ•°ï¼Œå®ƒç”¨åˆ°äº†åˆšæ‰æåˆ°çš„ä¸å®Œå…¨è°ƒç”¨ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> not = <span class="title function_">partialLeft</span>(compose, <span class="function"><span class="params">x</span> =&gt;</span> !x);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">even</span> = x =&gt; x % <span class="number">2</span> === <span class="number">0</span>;</span><br><span class="line"><span class="keyword">const</span> odd = <span class="title function_">not</span>(even);</span><br><span class="line"><span class="keyword">const</span> isNumber = <span class="title function_">not</span>(<span class="built_in">isNaN</span>);</span><br><span class="line"><span class="title function_">odd</span>(<span class="number">3</span>) &amp;&amp; <span class="title function_">isNumber</span>(<span class="number">2</span>)  <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure>
<p>We can also use composition and partial application to redo our mean and standard deviation calculations in extreme functional style:</p>
<blockquote>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸å®Œå…¨è°ƒç”¨çš„ç»„åˆæ¥é‡æ–°ç»„ç»‡æ±‚å¹³å‡æ•°å’Œæ ‡å‡†å·®çš„ä»£ç ï¼Œè¿™ç§ç¼–ç é£æ ¼æ˜¯éå¸¸çº¯ç²¹çš„å‡½æ•°å¼ç¼–ç¨‹ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// sum() and square() functions are defined above. Here are some more:</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">product</span> = (<span class="params">x,y</span>) =&gt; x*y;</span><br><span class="line"><span class="keyword">const</span> neg = <span class="title function_">partial</span>(product, -<span class="number">1</span>);</span><br><span class="line"><span class="keyword">const</span> sqrt = <span class="title function_">partial</span>(<span class="title class_">Math</span>.<span class="property">pow</span>, <span class="literal">undefined</span>, <span class="number">.5</span>);</span><br><span class="line"><span class="keyword">const</span> reciprocal = <span class="title function_">partial</span>(<span class="title class_">Math</span>.<span class="property">pow</span>, <span class="literal">undefined</span>, <span class="title function_">neg</span>(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Now compute the mean and standard deviation.</span></span><br><span class="line"><span class="keyword">let</span> data = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">5</span>];   <span class="comment">// Our data</span></span><br><span class="line"><span class="keyword">let</span> mean = <span class="title function_">product</span>(<span class="title function_">reduce</span>(data, sum), <span class="title function_">reciprocal</span>(data.<span class="property">length</span>));</span><br><span class="line"><span class="keyword">let</span> stddev = <span class="title function_">sqrt</span>(<span class="title function_">product</span>(<span class="title function_">reduce</span>(<span class="title function_">map</span>(data,</span><br><span class="line">                                     <span class="title function_">compose</span>(square,</span><br><span class="line">                                             <span class="title function_">partial</span>(sum, <span class="title function_">neg</span>(mean)))),</span><br><span class="line">                                 sum),</span><br><span class="line">                          <span class="title function_">reciprocal</span>(<span class="title function_">sum</span>(data.<span class="property">length</span>,<span class="title function_">neg</span>(<span class="number">1</span>)))));</span><br><span class="line">[mean, stddev]  <span class="comment">// =&gt; [3, 2]</span></span><br></pre></td></tr></table></figure>
<p>Notice that this code to compute mean and standard deviation is entirely function invocations; there are no operators involved, and the number of parentheses has grown so large that this JavaScript is beginning to look like Lisp code. Again, this is not a style that I advocate for JavaScript programming, but it is an interesting exercise to see how deeply functional JavaScript code can be.</p>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™æ®µä»£ç è®¡ç®—å¹³å‡å€¼å’Œæ ‡å‡†å·®å®Œå…¨æ˜¯å‡½æ•°è°ƒç”¨;æ²¡æœ‰æ¶‰åŠè¿ç®—ç¬¦ï¼Œå¹¶ä¸”æ‹¬å·çš„æ•°é‡å¢é•¿å¦‚æ­¤ä¹‹å¤§è®© JavaScript å¼€å§‹çœ‹èµ·æ¥åƒ Lisp ä»£ç ã€‚åŒæ ·ï¼Œè¿™ä¸æ˜¯æˆ‘æå€¡çš„ JavaScript ç¼–ç¨‹é£æ ¼ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªæœ‰è¶£çš„ç»ƒä¹ ï¼Œçœ‹çœ‹ JavaScript ä»£ç çš„åŠŸèƒ½æœ‰å¤šæ·±ã€‚</p>
</blockquote>
<h3 id="8-8-4-Memoization"><a href="#8-8-4-Memoization" class="headerlink" title="8.8.4 Memoization"></a>8.8.4 Memoization</h3><p>In Â§8.4.1, we defined a factorial function that cached its previously computed results. In functional programming, this kind of caching is called memoization. The code that follows shows a higher-order function, memoize(), that accepts a function as its argument and returns a memoized version of the function:</p>
<blockquote>
<p>åœ¨ Â§8.4.1 ä¸­å®šä¹‰äº†ä¸€ä¸ªé˜¶ä¹˜å‡½æ•°ï¼Œå®ƒå¯ä»¥å°†ä¸Šæ¬¡çš„è®¡ç®—ç»“æœç¼“å­˜èµ·æ¥ã€‚åœ¨å‡½æ•°å¼ç¼–ç¨‹å½“ä¸­ï¼Œè¿™ç§ç¼“å­˜æŠ€å·§å«åšâ€œè®°å¿†â€ï¼ˆmemorizationï¼‰ã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œmemorize() æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå®å‚ï¼Œå¹¶è¿”å›å¸¦æœ‰è®°å¿†èƒ½åŠ›çš„å‡½æ•°:</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Return a memoized version of f.</span></span><br><span class="line"><span class="comment">// It only works if arguments to f all have distinct string representations.</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">memoize</span>(<span class="params">f</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> cache = <span class="keyword">new</span> <span class="title class_">Map</span>();  <span class="comment">// Value cache stored in the closure.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">        <span class="comment">// Create a string version of the arguments to use as a cache key.</span></span><br><span class="line">        <span class="keyword">let</span> key = args.<span class="property">length</span> + args.<span class="title function_">join</span>(<span class="string">&quot;+&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (cache.<span class="title function_">has</span>(key)) &#123;</span><br><span class="line">            <span class="keyword">return</span> cache.<span class="title function_">get</span>(key);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> result = f.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">            cache.<span class="title function_">set</span>(key, result);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The memoize() function creates a new object to use as the cache and assigns this object to a local variable so that it is private to (in the closure of) the returned function. The returned function converts its arguments array to a string and uses that string as a property name for the cache object. If a value exists in the cache, it returns it directly. Otherwise, it calls the specified function to compute the value for these arguments, caches that value, and returns it. Here is how we might use memoize():</p>
<blockquote>
<p>memorize() å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡è¢«å½“åšç¼“å­˜ï¼ˆçš„å®¿ä¸»ï¼‰å¹¶èµ‹å€¼ç»™ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå› æ­¤å¯¹äºè¿”å›çš„å‡½æ•°æ¥è¯´å®ƒæ˜¯ç§æœ‰çš„ï¼ˆåœ¨é—­åŒ…ä¸­ï¼‰ã€‚æ‰€è¿”å›çš„å‡½æ•°å°†å®ƒçš„å®å‚æ•°ç»„è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå¹¶å°†å­—ç¬¦ä¸²ç”¨åšç¼“å­˜å¯¹è±¡çš„å±æ€§åã€‚å¦‚æœåœ¨ç¼“å­˜ä¸­å­˜åœ¨è¿™ä¸ªå€¼ï¼Œåˆ™ç›´æ¥è¿”å›å®ƒã€‚å¦åˆ™ï¼Œå°±è°ƒç”¨æ—¢å®šçš„å‡½æ•°å¯¹å®å‚è¿›è¡Œè®¡ç®—ï¼Œå°†è®¡ç®—ç»“æœç¼“å­˜èµ·æ¥å¹¶è¿”å›ï¼Œä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ memorize()ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Return the Greatest Common Divisor of two integers using the Euclidian</span></span><br><span class="line"><span class="comment">// algorithm: http://en.wikipedia.org/wiki/Euclidean_algorithm</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">gcd</span>(<span class="params">a,b</span>) &#123;  <span class="comment">// Type checking for a and b has been omitted</span></span><br><span class="line">    <span class="keyword">if</span> (a &lt; b) &#123;           <span class="comment">// Ensure that a &gt;= b when we start</span></span><br><span class="line">        [a, b] = [b, a];   <span class="comment">// Destructuring assignment to swap variables</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(b !== <span class="number">0</span>) &#123;       <span class="comment">// This is Euclid&#x27;s algorithm for GCD</span></span><br><span class="line">        [a, b] = [b, a%b];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> gcdmemo = <span class="title function_">memoize</span>(gcd);</span><br><span class="line"><span class="title function_">gcdmemo</span>(<span class="number">85</span>, <span class="number">187</span>)  <span class="comment">// =&gt; 17</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Note that when we write a recursive function that we will be memoizing,</span></span><br><span class="line"><span class="comment">// we typically want to recurse to the memoized version, not the original.</span></span><br><span class="line"><span class="keyword">const</span> factorial = <span class="title function_">memoize</span>(<span class="keyword">function</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (n &lt;= <span class="number">1</span>) ? <span class="number">1</span> : n * <span class="title function_">factorial</span>(n-<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">factorial</span>(<span class="number">5</span>)      <span class="comment">// =&gt; 120: also caches values for 4, 3, 2 and 1.</span></span><br></pre></td></tr></table></figure>
<h2 id="8-9-Summary"><a href="#8-9-Summary" class="headerlink" title="8.9 Summary"></a>8.9 Summary</h2><p>Some key points to remember about this chapter are as follows:</p>
<p>You can define functions with the function keyword and with the ES6 &#x3D;&gt; arrow syntax.</p>
<p>You can invoke functions, which can be used as methods and constructors.</p>
<p>Some ES6 features allow you to define default values for optional function parameters, to gather multiple arguments into an array using a rest parameter, and to destructure object and array arguments into function parameters.</p>
<p>You can use the â€¦ spread operator to pass the elements of an array or other iterable object as arguments in a function invocation.</p>
<p>A function defined inside of and returned by an enclosing function retains access to its lexical scope and can therefore read and write the variables defined inside the outer function. Functions used in this way are called closures, and this is a technique that is worth understanding.</p>
<p>Functions are objects that can be manipulated by JavaScript, and this enables a functional style of programming.</p>
<blockquote>
<p>æœ¬ç« å…³é”®ç‚¹æ€»ç»“å¦‚ä¸‹ï¼š</p>
<p>å¯ä»¥ç”¨å‡½æ•°å…³é”®å­—å’Œ ES6 &#x3D;&gt; ç®­å¤´å‡½æ•°æ¥å®šä¹‰å‡½æ•°ã€‚</p>
<p>å¯ä»¥ä»¥æ–¹æ³•å’Œæ„é€ å‡½æ•°çš„æ–¹å¼è°ƒç”¨å‡½æ•°ã€‚</p>
<p>ä¸€äº› ES6 ç‰¹æ€§ï¼Œå…è®¸å‚æ•°è®¾å®šé»˜è®¤å€¼ï¼Œå¯ä»¥ç”¨å‰©ä½™å‚æ•°å°†å¤šä¸ªå‚æ•°æœé›†åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¯ä»¥è§£æ„å¯¹è±¡å’Œæ•°ç»„å®å‚åˆ°å‡½æ•°å‚æ•°ä¸­ã€‚</p>
<p>å¯ä»¥ç”¨ â€¦ å±•å¼€è¿ç®—ç¬¦ä¼ é€’æ•°ç»„å…ƒç´ æˆ–è€…å…¶ä»–å¯è¿­ä»£å¯¹è±¡åˆ°å‡½æ•°è°ƒç”¨ã€‚</p>
<p>å°é—­å‡½æ•°å†…éƒ¨å®šä¹‰å¹¶è¿”å›çš„å‡½æ•°ä¿ç•™å¯¹å…¶è¯æ³•ä½œç”¨åŸŸçš„è®¿é—®ï¼Œå› æ­¤å¯ä»¥è¯»å–å’Œå†™å…¥å¤–éƒ¨å‡½æ•°å†…å®šä¹‰çš„å˜é‡ã€‚ç”¨è¿™ç§æ–¹å¼ä½¿ç”¨çš„å‡½æ•°ç§°ä¸ºé—­åŒ…ï¼Œè¿™æ˜¯ä¸€ç§å€¼å¾—ç†è§£çš„æŠ€æœ¯ã€‚</p>
<p>å‡½æ•°æ˜¯å¯ç”± JavaScript æ“ä½œçš„å¯¹è±¡ï¼Œè¿™ä½¿ JavaScript æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹ã€‚</p>
</blockquote>
<hr>
<ol>
<li>The term was coined by Martin Fowler. See <a target="_blank" rel="noopener" href="http://martinfowler.com/dslCatalog/methodChaining.html">http://martinfowler.com/dslCatalog/methodChaining.html</a>.</li>
<li>If you are familiar with Python, note that this is different than Python, in which every invocation shares the same default value.</li>
<li>This may not seem like a particularly interesting point unless you are familiar with more static languages, in which functions are part of a program but cannot be manipulated by the program.</li>
</ol>
<blockquote>
<ol>
<li>è¿™ä¸ªæœ¯è¯­æœ€åˆæ˜¯ç”± Martin Fowler æå‡ºçš„ï¼Œå‚è§<a target="_blank" rel="noopener" href="http://martinfowler.com/dslwip/MethodChaining.html%E3%80%82">http://martinfowler.com/dslwip/MethodChaining.htmlã€‚</a></li>
<li>è¿™çœ‹èµ·æ¥ä¸è¶³ä¸ºå¥‡ï¼Œä½†å¦‚æœä½ å¯¹ Python å¾ˆç†Ÿæ‚‰ï¼Œä½ ä¼šå‘ç° Python ä¸­çš„å‡½æ•°æ˜¯ç¨‹åºçš„ä¸€ éƒ¨åˆ†ï¼Œä½†æ— æ³•è¢«ç¨‹åºæ“ä½œã€‚</li>
<li>è¿™ä¼¼ä¹å¹¶ä¸æ˜¯ä¸€ä¸ªç‰¹åˆ«æœ‰è¶£çš„ç‚¹ï¼Œé™¤éä½ ç†Ÿæ‚‰æ›´å¤šçš„é™æ€è¯­è¨€ï¼Œå…¶ä¸­å‡½æ•°æ˜¯ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œä½†ä¸èƒ½ç”±ç¨‹åºæ“ä½œã€‚</li>
</ol>
</blockquote>
</article><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="èµèµä½œè€…"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>æ‰“èµä½œè€…</div><div class="reward-main"><div class="reward-all"><span class="reward-title">æ„Ÿè°¢ä½ èµäºˆæˆ‘å‰è¿›çš„åŠ›é‡</span><ul class="reward-group"><li class="reward-item"><a href="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul><a class="reward-main-btn" href="/about/" target="_blank"><div class="reward-text">èµèµè€…åå•</div><div class="reward-dec">å› ä¸ºä½ ä»¬çš„æ”¯æŒè®©æˆ‘æ„è¯†åˆ°å†™æ–‡ç« çš„ä»·å€¼ğŸ™</div></a></div></div></div><div class="reward-link mode"><a class="reward-link-button" href="/wechat/" data-pjax-state=""><i class="anzhiyufont anzhiyu-icon-plant-fill"></i>è¿è¥æ¨¡å¼ä¸è´£ä»»</a></div><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="ä½¿ç”¨æ‰‹æœºè®¿é—®è¿™ç¯‡æ–‡ç« "><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://www.houyanbin.com/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch8/"></div><div class="reward-dec">ä½¿ç”¨æ‰‹æœºè®¿é—®è¿™ç¯‡æ–‡ç« </div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=ç¬¬8ç«  å‡½æ•°&amp;url=http://www.houyanbin.com/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch8/&amp;pic=https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover8.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="å¤åˆ¶é“¾æ¥" onclick="rm.copyPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>ã€ŠJavaScriptæƒå¨æŒ‡å—ã€‹<span class="tagsPageCount">17</span></a><a class="post-meta__box__tags" href="/tags/JavaScript/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>JavaScript<span class="tagsPageCount">17</span></a></div></div></div></div></div><div class="post-copyright"><i class="anzhiyufont anzhiyu-icon-copyright"></i><div class="post-copyright__author"><a class="post-copyright__original" title="è¯¥æ–‡ç« ä¸ºåŸåˆ›æ–‡ç« ï¼Œæ³¨æ„ç‰ˆæƒåè®®" href="http://www.houyanbin.com/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch8/">åŸåˆ›</a><a class="post-copyright-title"><span>ç¬¬8ç«  å‡½æ•°</span></a></div><div class="post-copyright-info-box"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"></span><a class="link" href="http://www.houyanbin.com">Jack hou</a></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a class="link" href="http://www.houyanbin.com/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch8/">http://www.houyanbin.com/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch8/</a></span><span class="copy-button" onclick="rm.copyPageUrl()"><i class="anzhiyufont anzhiyu-icon-copy"></i></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://www.houyanbin.com" target="_blank">Jackhou Blog</a>ï¼</span></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch9/"><img class="prev-cover" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover9.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ç¬¬9ç«  ç±»</div></div></a></div><div class="next-post pull-right"><a href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch7/"><img class="next-cover" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover7.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">ç¬¬7ç«  æ•°ç»„</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch1/" title="ç¬¬1ç«  JavaScript æ¦‚è¿°"><img class="cover" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-26</div><div class="title">ç¬¬1ç«  JavaScript æ¦‚è¿°</div></div></a></div><div><a href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch12/" title="ç¬¬12ç«  è¿­ä»£å™¨å’Œç”Ÿæˆå™¨"><img class="cover" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-26</div><div class="title">ç¬¬12ç«  è¿­ä»£å™¨å’Œç”Ÿæˆå™¨</div></div></a></div><div><a href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch10/" title="ç¬¬10ç«  æ¨¡å—"><img class="cover" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover10.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-26</div><div class="title">ç¬¬10ç«  æ¨¡å—</div></div></a></div><div><a href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch17/" title="ç¬¬17ç«  JavaScript å·¥å…·å’Œæ‰©å±•"><img class="cover" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover7.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-26</div><div class="title">ç¬¬17ç«  JavaScript å·¥å…·å’Œæ‰©å±•</div></div></a></div><div><a href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch14/" title="ç¬¬14ç«  å…ƒç¼–ç¨‹"><img class="cover" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-26</div><div class="title">ç¬¬14ç«  å…ƒç¼–ç¨‹</div></div></a></div><div><a href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch2/" title="ç¬¬2ç«  è¯æ³•ç»“æ„"><img class="cover" src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-26</div><div class="title">ç¬¬2ç«  è¯æ³•ç»“æ„</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> è¯„è®º</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">åŒ¿åè¯„è®º</a></div><div class="comment-tips" id="comment-tips"><span>ä½ æ— éœ€åˆ é™¤ç©ºè¡Œï¼Œç›´æ¥è¯„è®ºä»¥è·å–æœ€ä½³å±•ç¤ºæ•ˆæœ</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div><div class="comment-barrage"></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="author-info-top"> <div class="card-info-avatar"></div></div><div class="author-info__sayhi" id="author-info__sayhi"></div><h1 class="author-info__name">Jack hou</h1><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">Hiï¼Œè¿™æ˜¯æˆ‘çš„åšå®¢ç½‘ç«™ï¼Œæ¬¢è¿ä½ èƒ½åˆ°è®¿~</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">æˆ‘ä¼šåœ¨è¿™é‡Œåˆ†äº«æˆ‘çš„<b style="color:#fff">æŠ€æœ¯çŸ¥è¯†</b>ã€<b style="color:#fff">æ—¥å¸¸ç”Ÿæ´»</b>å’Œ<b style="color:#fff">äººç”Ÿç»éªŒã€‚</b></div></div><div class="banner-button-group"><a class="banner-button" onclick="pjax.loadUrl(&quot;/about/&quot;)"><span class="banner-button-text">äº†è§£æ›´å¤š</span><i class="anzhiyufont anzhiyu-icon-arrow-circle-right" style="font-size: 1.5rem"></i></a></div><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/Hou-yanbin" target="_blank" title="Github"><i class="fab fa-github faa-tada"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/478589474" target="_blank" title="BiliBili"><i class="fa-brands fa-bilibili faa-tada"></i></a><a class="social-icon faa-parent animated-hover" href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=jackhou921@qq.com" target="_blank" title="Email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/wxgzh1.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://img02.anzhiy.cn/adminuploads/1/2022/09/11/631ddeb0900b7.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-Defining-Functions"><span class="toc-text">8.1 Defining Functions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-1-Function-Declarations"><span class="toc-text">8.1.1 Function Declarations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-2-Function-Expressions"><span class="toc-text">8.1.2 Function Expressions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-3-Arrow-Functions"><span class="toc-text">8.1.3 Arrow Functions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-4-Nested-Functions"><span class="toc-text">8.1.4 Nested Functions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-Invoking-Functions"><span class="toc-text">8.2 Invoking Functions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-1-Function-Invocation"><span class="toc-text">8.2.1 Function Invocation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CONDITIONAL-INVOCATION"><span class="toc-text">CONDITIONAL INVOCATION</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RECURSIVE-FUNCTIONS-AND-THE-STACK"><span class="toc-text">RECURSIVE FUNCTIONS AND THE STACK</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-2-Method-Invocation"><span class="toc-text">8.2.2 Method Invocation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#METHOD-CHAINING"><span class="toc-text">METHOD CHAINING</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-3-Constructor-Invocation"><span class="toc-text">8.2.3 Constructor Invocation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-4-Indirect-Invocation"><span class="toc-text">8.2.4 Indirect Invocation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-5-Implicit-Function-Invocation"><span class="toc-text">8.2.5 Implicit Function Invocation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3-Function-Arguments-and-Parameters"><span class="toc-text">8.3 Function Arguments and Parameters</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-1-Optional-Parameters-and-Defaults"><span class="toc-text">8.3.1 Optional Parameters and Defaults</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-2-Rest-Parameters-and-Variable-Length-Argument-Lists"><span class="toc-text">8.3.2 Rest Parameters and Variable-Length Argument Lists</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-3-The-Arguments-Object"><span class="toc-text">8.3.3 The Arguments Object</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-4-The-Spread-Operator-for-Function-Calls"><span class="toc-text">8.3.4 The Spread Operator for Function Calls</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-5-Destructuring-Function-Arguments-into-Parameters"><span class="toc-text">8.3.5 Destructuring Function Arguments into Parameters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-6-Argument-Types"><span class="toc-text">8.3.6 Argument Types</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-4-Functions-as-Values"><span class="toc-text">8.4 Functions as Values</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-1-Defining-Your-Own-Function-Properties"><span class="toc-text">8.4.1 Defining Your Own Function Properties</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-5-Functions-as-Namespaces"><span class="toc-text">8.5 Functions as Namespaces</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-6-Closures"><span class="toc-text">8.6 Closures</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-7-Function-Properties-Methods-and-Constructor"><span class="toc-text">8.7 Function Properties, Methods, and Constructor</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-7-1-The-length-Property"><span class="toc-text">8.7.1 The length Property</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-7-2-The-name-Property"><span class="toc-text">8.7.2 The name Property</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-7-3-The-prototype-Property"><span class="toc-text">8.7.3 The prototype Property</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-7-4-The-call-and-apply-Methods"><span class="toc-text">8.7.4 The call() and apply() Methods</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-7-5-The-bind-Method"><span class="toc-text">8.7.5 The bind() Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-7-6-The-toString-Method"><span class="toc-text">8.7.6 The toString() Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-7-7-The-Function-Constructor"><span class="toc-text">8.7.7 The Function() Constructor</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-8-Functional-Programming"><span class="toc-text">8.8 Functional Programming</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-8-1-Processing-Arrays-with-Functions"><span class="toc-text">8.8.1 Processing Arrays with Functions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-8-2-Higher-Order-Functions"><span class="toc-text">8.8.2 Higher-Order Functions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-8-3-Partial-Application-of-Functions"><span class="toc-text">8.8.3 Partial Application of Functions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-8-4-Memoization"><span class="toc-text">8.8.4 Memoization</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-9-Summary"><span class="toc-text">8.9 Summary</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/05/04/Articles/APT%E7%BB%84%E7%BB%87/" title="APT ç»„ç»‡ä»‹ç»"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover9.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="APT ç»„ç»‡ä»‹ç»"/></a><div class="content"><a class="title" href="/2023/05/04/Articles/APT%E7%BB%84%E7%BB%87/" title="APT ç»„ç»‡ä»‹ç»">APT ç»„ç»‡ä»‹ç»</a><time datetime="2023-05-03T16:00:00.000Z" title="å‘è¡¨äº 2023-05-04 00:00:00">2023-05-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/03/Articles/%E9%BB%84%E9%87%91%E4%BA%A4%E6%98%93%E8%AE%B0%E5%BD%95/" title="é»„é‡‘äº¤æ˜“æ€»ç»“è®°å½•"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="é»„é‡‘äº¤æ˜“æ€»ç»“è®°å½•"/></a><div class="content"><a class="title" href="/2023/05/03/Articles/%E9%BB%84%E9%87%91%E4%BA%A4%E6%98%93%E8%AE%B0%E5%BD%95/" title="é»„é‡‘äº¤æ˜“æ€»ç»“è®°å½•">é»„é‡‘äº¤æ˜“æ€»ç»“è®°å½•</a><time datetime="2023-05-02T16:00:00.000Z" title="å‘è¡¨äº 2023-05-03 00:00:00">2023-05-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch1/" title="ç¬¬1ç«  JavaScript æ¦‚è¿°"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ç¬¬1ç«  JavaScript æ¦‚è¿°"/></a><div class="content"><a class="title" href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch1/" title="ç¬¬1ç«  JavaScript æ¦‚è¿°">ç¬¬1ç«  JavaScript æ¦‚è¿°</a><time datetime="2023-04-26T07:15:25.162Z" title="å‘è¡¨äº 2023-04-26 15:15:25">2023-04-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch2/" title="ç¬¬2ç«  è¯æ³•ç»“æ„"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ç¬¬2ç«  è¯æ³•ç»“æ„"/></a><div class="content"><a class="title" href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch2/" title="ç¬¬2ç«  è¯æ³•ç»“æ„">ç¬¬2ç«  è¯æ³•ç»“æ„</a><time datetime="2023-04-25T16:00:59.000Z" title="å‘è¡¨äº 2023-04-26 00:00:59">2023-04-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch3/" title="ç¬¬3ç«  ç±»å‹ã€å€¼å’Œå˜é‡"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/post/default_cover3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ç¬¬3ç«  ç±»å‹ã€å€¼å’Œå˜é‡"/></a><div class="content"><a class="title" href="/2023/04/26/Books/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/ch3/" title="ç¬¬3ç«  ç±»å‹ã€å€¼å’Œå˜é‡">ç¬¬3ç«  ç±»å‹ã€å€¼å’Œå˜é‡</a><time datetime="2023-04-25T16:00:58.000Z" title="å‘è¡¨äº 2023-04-26 00:00:58">2023-04-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 By Jack hou</div><div id="workboard"><img class="workSituationImg boardsign" src="https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/å®‰çŸ¥é±¼-ä¸Šç­æ‘¸é±¼ä¸­.svg" alt="è·ç¦»æœˆå…¥25kä¹Ÿå°±è¿˜å·®ä¸€ä¸ªå¤§ä½¬å¸¦æˆ‘~" title="è·ç¦»æœˆå…¥25kä¹Ÿå°±è¿˜å·®ä¸€ä¸ªå¤§ä½¬å¸¦æˆ‘~"/><div id="runtimeTextTip"></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="åšå®¢æ¡†æ¶ä¸ºHexo_v5.4.0" title="åšå®¢æ¡†æ¶ä¸ºHexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="åšå®¢æ¡†æ¶ä¸ºHexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://www.dogecloud.com/" style="margin-inline:5px" data-title="æœ¬ç«™ä½¿ç”¨å¤šå‰äº‘ä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ" title="æœ¬ç«™ä½¿ç”¨å¤šå‰äº‘ä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/CDN-å¤šå‰äº‘-3693F3.svg" alt="æœ¬ç«™ä½¿ç”¨å¤šå‰äº‘ä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡" title="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯" title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯" title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"/></a></p></div></footer><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" src="data:image/jpeg;base64,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"/><div class="loading-image-dot"></div><div id="loading-percentage">0%</div></div></div><script>const loadingPercentage = document.getElementById("loading-percentage");
let loadingPercentageTimer = setInterval(function() {
  var progressBar = document.querySelector(".pace-progress");
  if (!progressBar) return
  var currentValue = progressBar.getAttribute("data-progress-text");
  if (currentValue !== loadingPercentage.textContent) {
    loadingPercentage.textContent = currentValue;
    if (currentValue === "100%") {
      clearInterval(loadingPercentageTimer);
    }
  }
}, 100);
const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/progress_bar/progress_bar.css"/><script async="async" src="https://npm.elemecdn.com/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img02.anzhiy.cn/adminuploads/1/2022/09/15/63232b7d91d22.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">æ–‡ç« </div><div class="length-num">51</div></a><a href="/tags/" title="tag"><div class="headline">æ ‡ç­¾</div><div class="length-num">16</div></a><a href="/categories/" title="category"><div class="headline">åˆ†ç±»</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> æ–‡ç« </span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> éš§é“</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> å‹é“¾</span></a><ul class="menus_item_child" style="left:-31px;"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> å‹äººå¸</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> ç•™è¨€æ¿</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> æˆ‘çš„</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=8868465080&amp;server=tencent&amp;type=0"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> éŸ³ä¹é¦†</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> è¿½ç•ªé¡µ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> ç›¸å†Œé›†</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> å…³äº</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> å…³äºæœ¬äºº</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> é—²è¨€ç¢è¯­</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> éšä¾¿é€›é€›</span></a></li></ul></div></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch_commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="å¼€å…³å¼¹å¹•"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="center-console" type="button" title="ä¸­æ§å°"><i class="anzhiyufont anzhiyu-icon-fish"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><div id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()">æ’­æ”¾éŸ³ä¹</div><div id="console-music-bg"></div><meting-js id="8868465080" server="tencent" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="console"><div class="close-btn" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-xmark" style="font-size: 35px;"></i></div><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/wechat.jpg" target="_blank"><img class="post-qr-code-img" alt="wechat" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/wechat.jpg"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/alipay.jpg" target="_blank"><img class="post-qr-code-img" alt="alipay" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://imagesblog.oss-cn-hangzhou.aliyuncs.com/themes/index/alipay.jpg"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments" onclick="anzhiyu.hideConsole()"><div class="card-content"><div class="author-content-item-tips">äº’åŠ¨</div><span class="author-content-item-title"> <span>æœ€æ–°è¯„è®º</span></span></div><div class="aside-list"><span>æ­£åœ¨åŠ è½½ä¸­...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags" onclick="anzhiyu.hideConsole()"><div class="card-content"><div class="author-content-item-tips">å…´è¶£ç‚¹</div><span class="author-content-item-title">å¯»æ‰¾ä½ æ„Ÿå…´è¶£çš„é¢†åŸŸ</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Article/" style="font-size: 1.33em; color: rgb(169, 105, 35)">Article<sup>4</sup></a><a href="/tags/CSRF/" style="font-size: 1.15em; color: rgb(47, 100, 103)">CSRF<sup>1</sup></a><a href="/tags/Git/" style="font-size: 1.15em; color: rgb(91, 36, 166)">Git<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.27em; color: rgb(20, 87, 109)">Java<sup>3</sup></a><a href="/tags/JavaScript/" style="font-size: 1.45em; color: rgb(66, 71, 74)">JavaScript<sup>17</sup></a><a href="/tags/Linux/" style="font-size: 1.15em; color: rgb(107, 79, 168)">Linux<sup>1</sup></a><a href="/tags/Pikachu/" style="font-size: 1.15em; color: rgb(62, 189, 141)">Pikachu<sup>1</sup></a><a href="/tags/SQL/" style="font-size: 1.15em; color: rgb(68, 194, 135)">SQL<sup>1</sup></a><a href="/tags/XAUUSD/" style="font-size: 1.15em; color: rgb(128, 130, 150)">XAUUSD<sup>1</sup></a><a href="/tags/XSS/" style="font-size: 1.21em; color: rgb(0, 36, 71)">XSS<sup>2</sup></a><a href="/tags/%E3%80%8AJavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B/" style="font-size: 1.45em; color: rgb(16, 188, 174)">ã€ŠJavaScriptæƒå¨æŒ‡å—ã€‹<sup>17</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 1.39em; color: rgb(77, 67, 21)">åšå®¢<sup>10</sup></a><a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size: 1.45em; color: rgb(120, 125, 186)">å®‰å…¨<sup>17</sup></a><a href="/tags/%E6%94%AF%E4%BB%98/" style="font-size: 1.15em; color: rgb(67, 97, 47)">æ”¯ä»˜<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 1.33em; color: rgb(41, 55, 189)">è™šæ‹Ÿæœº<sup>4</sup></a><a href="/tags/%E8%B6%8A%E6%9D%83/" style="font-size: 1.21em; color: rgb(165, 29, 84)">è¶Šæƒ<sup>2</sup></a></div></div><hr/></div></div><div class="console-card history" onclick="anzhiyu.hideConsole()"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>æ–‡ç« </span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>å½’æ¡£</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">äº”æœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">å››æœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">37</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">ä¸‰æœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>ç¯‡</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" onclick="rm.switchDarkMode()" title="æ˜¾ç¤ºæ¨¡å¼åˆ‡æ¢" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="è¾¹æ æ˜¾ç¤ºæ§åˆ¶"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="çƒ­è¯„å¼€å…³"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="éŸ³ä¹å¼€å…³"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>å¤åˆ¶é€‰ä¸­æ–‡æœ¬</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>ç²˜è´´æ–‡æœ¬</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>å¼•ç”¨åˆ°è¯„è®º</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>å¤åˆ¶é“¾æ¥åœ°å€</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>å¤åˆ¶æ­¤å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>ä¸‹è½½æ­¤å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>æ–°çª—å£æ‰“å¼€å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>ç«™å†…æœç´¢</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>ç™¾åº¦æœç´¢</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>æ’­æ”¾éŸ³ä¹</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>åˆ‡æ¢åˆ°ä¸Šä¸€é¦–</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>åˆ‡æ¢åˆ°ä¸‹ä¸€é¦–</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8868465080&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>æŸ¥çœ‹æ‰€æœ‰æ­Œæ›²</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>å¤åˆ¶æ­Œå</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>éšä¾¿é€›é€›</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>åšå®¢åˆ†ç±»</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>æ–‡ç« æ ‡ç­¾</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>å¤åˆ¶åœ°å€</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">å…³é—­çƒ­è¯„</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">æ·±è‰²æ¨¡å¼</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>è½‰ç‚ºç¹é«”</span></a></div></div><div id="rightmenu-mask"></div><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script><div><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.1.8/source/js/utils.js"></script><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.1.8/source/js/main.js"></script><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.1.8/source/js/tw_cn.js"></script><script src="https://npm.elemecdn.com/@fancyapps/ui@4.0.31/dist/fancybox.umd.js"></script><script src="https://npm.elemecdn.com/instant.page@5.1.1/instantpage.js" type="module"></script><script src="https://npm.elemecdn.com/vanilla-lazyload@17.3.1/dist/lazyload.iife.min.js"></script><script src="https://npm.elemecdn.com/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// æ¶ˆé™¤æ§åˆ¶å°æ‰“å°
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  console.log(1)
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //åœ¨æ¢å¤å‰è¾“å‡ºæ—¥å¿—
  const grt = new Date("4/15/2023 00:00:00"); //æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `æ¬¢è¿ä½¿ç”¨å®‰çŸ¥é±¼!`,
    `ç”Ÿæ´»æ˜æœ—, ä¸‡ç‰©å¯çˆ±`,
    `
        
       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—
      â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
      â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ•”â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â•šâ–ˆâ–ˆâ•”â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
      â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
      â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•   â•šâ•â•    â•šâ•â•â•â•â•â•
        
        `,
    "å·²ä¸Šçº¿",
    dnum,
    "å¤©",
    "Â©2023 By å®‰çŸ¥é±¼",
  ];
  const ascll2 = [`NCC2-036`, `è°ƒç”¨å‰ç½®æ‘„åƒå¤´æ‹ç…§æˆåŠŸï¼Œè¯†åˆ«ä¸ºã€å°ç¬¨è›‹ã€‘.`, `Photo captured: `, `ğŸ¤ª`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c ä½ å¥½ï¼Œå°ç¬¨è›‹.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c âš¡ Powered by å®‰çŸ¥é±¼ %c ä½ æ­£åœ¨è®¿é—® Jack hou çš„åšå®¢.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c ä½ å·²æ‰“å¼€æ§åˆ¶å°.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c ä½ ç°åœ¨æ­£å¤„äºç›‘æ§ä¸­.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("4/15/2023 00:00:00"); //è®¾ç½®ç½‘ç«™ä¸Šçº¿æ—¶é—´
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // è®¡ç®—å¹¶æ›´æ–°å¤©æ•°ã€å°æ—¶æ•°ã€åˆ†é’Ÿæ•°å’Œç§’æ•°
  function updateTime() {
    now = new Date(); // æ›´æ–° now çš„å€¼
    nowHour = now.getHours(); // æ›´æ–° nowHour çš„å€¼
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // æ›´æ–°ç½‘é¡µä¸­æ˜¾ç¤ºçš„ç½‘ç«™è¿è¡Œæ—¶é—´
  function updateHtml() {
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // å¦‚æœæ˜¯ä¸Šç­æ—¶é—´ï¼Œé»˜è®¤å°±æ˜¯"å®‰çŸ¥é±¼-ä¸Šç­æ‘¸é±¼ä¸­.svg"å›¾ç‰‡ï¼Œä¸éœ€è¦æ›´æ”¹
      currentTimeHtml = `æœ¬ç«™å±…ç„¶è¿è¡Œäº† ${dnum} å¤©<span id='runtime'> ${hnum} å°æ—¶ ${mnum} åˆ† ${snum} ç§’ </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // å¦‚æœæ˜¯ä¸‹ç­æ—¶é—´ï¼Œæ’å…¥"å®‰çŸ¥é±¼-ä¸‹ç­å•¦.svg"å›¾ç‰‡
      let img = document.querySelector("#workboard .workSituationImg");
      img.src = "https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/å®‰çŸ¥é±¼-ä¸‹ç­å•¦.svg";
      img.title = "ä¸‹ç­äº†å°±è¯¥å¼€å¼€å¿ƒå¿ƒçš„ç©è€ï¼Œå˜¿å˜¿~";
      img.alt = "ä¸‹ç­äº†å°±è¯¥å¼€å¼€å¿ƒå¿ƒçš„ç©è€ï¼Œå˜¿å˜¿~";

      currentTimeHtml = `æœ¬ç«™å±…ç„¶è¿è¡Œäº† ${dnum} å¤©<span id='runtime'> ${hnum} å°æ—¶ ${mnum} åˆ† ${snum} ç§’ </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.1.8/source/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.houyanbin.com/',
      region: '',
      onCommentLoaded: function () {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.houyanbin.com/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://npm.elemecdn.com/twikoo@1.6.11/dist/twikoo.all.min.js').then(runFn)
  }
  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[å›¾ç‰‡]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[é“¾æ¥]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[ä»£ç ]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo.houyanbin.com/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://npm.elemecdn.com/twikoo@1.6.11/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick}</span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += 'æ²¡æœ‰è¯„è®º'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "visitor@anzhiy.cn";</script><script>//åŠ¨æ€æ ‡é¢˜
let leaveTitle = 'w(ï¾ŸĞ”ï¾Ÿ)w ä¸è¦èµ°ï¼å†çœ‹çœ‹å˜›ï¼';
let backTitle = 'â™ª(^âˆ‡^*)æ¬¢è¿è‚¥æ¥ï¼';
let OriginTitile = document.title
let titleTime
document.addEventListener('visibilitychange', function () {
  if (document.hidden) {
    //ç¦»å¼€å½“å‰é¡µé¢æ—¶æ ‡ç­¾æ˜¾ç¤ºå†…å®¹
    document.title = leaveTitle
    clearTimeout(titleTime)
  } else {
    //è¿”å›å½“å‰é¡µé¢æ—¶æ ‡ç­¾æ˜¾ç¤ºå†…å®¹
    document.title = backTitle + OriginTitile
    //ä¸¤ç§’åå˜å›æ­£å¸¸æ ‡é¢˜
    titleTime = setTimeout(function () {
      document.title = OriginTitile
    }, 2000)
  }
})</script><script data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/catalog-bar/catalog-bar.js"></script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/categoryBar/categoryBar.js"></script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script>// åˆå§‹åŒ–å‡½æ•°
let rm = {};

//ç¦æ­¢å›¾ç‰‡æ‹–æ‹½
let imgElements = document.getElementsByTagName("img");
for (let i = 0; i < imgElements.length; i++) {
  imgElements[i].addEventListener("dragstart", function (event) {
    event.preventDefault();
  });
}

// æ˜¾ç¤ºèœå•
rm.showRightMenu = function (isTrue, x = 0, y = 0) {
  console.info(x, y)
  let rightMenu = document.getElementById("rightMenu");
  rightMenu.style.top = x + "px";
  rightMenu.style.left = y + "px";
  if (isTrue) {
    rightMenu.style.display = "block";
    stopMaskScroll();
  } else {
    rightMenu.style.display = "none";
  }
};

// éšè—èœå•
rm.hideRightMenu = function () {
  rm.showRightMenu(false);
  let rightMenuMask = document.querySelector("#rightmenu-mask");
  rightMenuMask.style.display = "none";
};

// å°ºå¯¸
let rmWidth = document.getElementById("rightMenu").offsetWidth;
let rmHeight = document.getElementById("rightMenu").offsetHeight;

// é‡æ–°å®šä¹‰å°ºå¯¸
rm.reloadrmSize = function () {
  rightMenu.style.visibility = "hidden";
  rightMenu.style.display = "block";
  // è·å–å®½åº¦å’Œé«˜åº¦
  rmWidth = document.getElementById("rightMenu").offsetWidth;
  rmHeight = document.getElementById("rightMenu").offsetHeight;
  rightMenu.style.visibility = "visible";
};

// è·å–ç‚¹å‡»çš„href
let domhref = "";
let domImgSrc = "";
let globalEvent = null;

// ç›‘å¬å³é”®åˆå§‹åŒ–
window.oncontextmenu = function (event) {
  if (document.body.clientWidth > 768) {
    let pageX = event.clientX + 10; //åŠ 10æ˜¯ä¸ºäº†é˜²æ­¢æ˜¾ç¤ºæ—¶é¼ æ ‡é®åœ¨èœå•ä¸Š
    let pageY = event.clientY;

    //å…¶ä»–é¢å¤–èœå•
    const $rightMenuOther = document.querySelector(".rightMenuOther");
    const $rightMenuPlugin = document.querySelector(".rightMenuPlugin");
    const $rightMenuCopyText = document.querySelector("#menu-copytext");
    const $rightMenuPasteText = document.querySelector("#menu-pastetext");
    const $rightMenuCommentText = document.querySelector("#menu-commenttext");
    const $rightMenuNewWindow = document.querySelector("#menu-newwindow");
    const $rightMenuNewWindowImg = document.querySelector("#menu-newwindowimg");
    const $rightMenuCopyLink = document.querySelector("#menu-copylink");
    const $rightMenuCopyImg = document.querySelector("#menu-copyimg");
    const $rightMenuDownloadImg = document.querySelector("#menu-downloadimg");
    const $rightMenuSearch = document.querySelector("#menu-search");
    const $rightMenuSearchBaidu = document.querySelector("#menu-searchBaidu");
    const $rightMenuMusicToggle = document.querySelector("#menu-music-toggle");
    const $rightMenuMusicBack = document.querySelector("#menu-music-back");
    const $rightMenuMusicForward = document.querySelector("#menu-music-forward");
    const $rightMenuMusicPlaylist = document.querySelector("#menu-music-playlist");
    const $rightMenuMusicCopyMusicName = document.querySelector("#menu-music-copyMusicName");

    let href = event.target.href;
    let imgsrc = event.target.currentSrc;

    // åˆ¤æ–­æ¨¡å¼ æ‰©å±•æ¨¡å¼ä¸ºæœ‰äº‹ä»¶
    let pluginMode = false;
    $rightMenuOther.style.display = "block";
    globalEvent = event;

    // æ£€æŸ¥æ˜¯å¦éœ€è¦å¤åˆ¶ æ˜¯å¦æœ‰é€‰ä¸­æ–‡æœ¬
    if (selectTextNow && window.getSelection()) {
      pluginMode = true;
      $rightMenuCopyText.style.display = "block";
      $rightMenuCommentText.style.display = "block";
      $rightMenuSearch.style.display = "block";
      $rightMenuSearchBaidu.style.display = "block";
    } else {
      $rightMenuCopyText.style.display = "none";
      $rightMenuCommentText.style.display = "none";
      $rightMenuSearchBaidu.style.display = "none";
      $rightMenuSearch.style.display = "none";
    }

    //æ£€æŸ¥æ˜¯å¦å³é”®ç‚¹å‡»äº†é“¾æ¥aæ ‡ç­¾
    if (href) {
      pluginMode = true;
      $rightMenuNewWindow.style.display = "block";
      $rightMenuCopyLink.style.display = "block";
      domhref = href;
    } else {
      $rightMenuNewWindow.style.display = "none";
      $rightMenuCopyLink.style.display = "none";
    }

    //æ£€æŸ¥æ˜¯å¦éœ€è¦å¤åˆ¶å›¾ç‰‡
    if (imgsrc) {
      pluginMode = true;
      $rightMenuCopyImg.style.display = "block";
      $rightMenuDownloadImg.style.display = "block";
      $rightMenuNewWindowImg.style.display = "block";
      document.getElementById("rightMenu").style.width="12rem"
      domImgSrc = imgsrc;
    } else {
      $rightMenuCopyImg.style.display = "none";
      $rightMenuDownloadImg.style.display = "none";
      $rightMenuNewWindowImg.style.display = "none";
    }

    // åˆ¤æ–­æ˜¯å¦ä¸ºè¾“å…¥æ¡†
    if (event.target.tagName.toLowerCase() === "input" || event.target.tagName.toLowerCase() === "textarea") {
      pluginMode = true;
      $rightMenuPasteText.style.display = "block";
    } else {
      $rightMenuPasteText.style.display = "none";
    }
    const navMusicEl = document.querySelector("#nav-music");
    //åˆ¤æ–­æ˜¯å¦æ˜¯éŸ³ä¹
    if (navMusicEl && navMusicEl.contains(event.target)) {
      pluginMode = true;
      $rightMenuMusicToggle.style.display = "block";
      $rightMenuMusicBack.style.display = "block";
      $rightMenuMusicForward.style.display = "block";
      $rightMenuMusicPlaylist.style.display = "block";
      $rightMenuMusicCopyMusicName.style.display = "block";
    } else {
      $rightMenuMusicToggle.style.display = "none";
      $rightMenuMusicBack.style.display = "none";
      $rightMenuMusicForward.style.display = "none";
      $rightMenuMusicPlaylist.style.display = "none";
      $rightMenuMusicCopyMusicName.style.display = "none";
    }

    // å¦‚æœä¸æ˜¯æ‰©å±•æ¨¡å¼åˆ™éšè—æ‰©å±•æ¨¡å—
    if (pluginMode) {
      $rightMenuOther.style.display = "none";
      $rightMenuPlugin.style.display = "block";
    } else {
      $rightMenuPlugin.style.display = "none";
    }

    rm.reloadrmSize();

    // é¼ æ ‡é»˜è®¤æ˜¾ç¤ºåœ¨é¼ æ ‡å³ä¸‹æ–¹ï¼Œå½“é¼ æ ‡é å³æˆ–é ä¸‹æ—¶ï¼Œå°†èœå•æ˜¾ç¤ºåœ¨é¼ æ ‡å·¦æ–¹\ä¸Šæ–¹
    if (pageX + rmWidth > window.innerWidth) {
      pageX -= rmWidth + 10;
    }
    if (pageY + rmHeight > window.innerHeight) {
      pageY -= pageY + rmHeight - window.innerHeight;
    }

    rm.showRightMenu(true, pageY, pageX);
    document.getElementById("rightmenu-mask").style.display = "flex";
    return false;
  }
};

// ä¸‹è½½å›¾ç‰‡çŠ¶æ€
rm.downloadimging = false;

// å¤åˆ¶å›¾ç‰‡åˆ°å‰ªè´´æ¿
rm.writeClipImg = function (imgsrc) {
  console.log("æŒ‰ä¸‹å¤åˆ¶");
  rm.hideRightMenu();
  anzhiyu.snackbarShow("æ­£åœ¨ä¸‹è½½ä¸­ï¼Œè¯·ç¨å", false, 10000);
  if (rm.downloadimging == false) {
    rm.downloadimging = true;
    setTimeout(function () {
      copyImage(imgsrc);
      anzhiyu.snackbarShow("å¤åˆ¶æˆåŠŸï¼å›¾ç‰‡å·²æ·»åŠ ç›²æ°´å°ï¼Œè¯·éµå®ˆç‰ˆæƒåè®®");
      rm.downloadimging = false;
    }, "10000");
  }
};

function imageToBlob(imageURL) {
  const img = new Image();
  const c = document.createElement("canvas");
  const ctx = c.getContext("2d");
  img.crossOrigin = "";
  img.src = imageURL;
  return new Promise(resolve => {
    img.onload = function () {
      c.width = this.naturalWidth;
      c.height = this.naturalHeight;
      ctx.drawImage(this, 0, 0);
      c.toBlob(
        blob => {
          // here the image is a blob
          resolve(blob);
        },
        "image/png",
        0.75
      );
    };
  });
}

async function copyImage(imageURL) {
  const blob = await imageToBlob(imageURL);
  const item = new ClipboardItem({ "image/png": blob });
  navigator.clipboard.write([item]);
}

rm.switchDarkMode = function () {
  // Switch Between Light And Dark Mode
  const nowMode = document.documentElement.getAttribute("data-theme") === "dark" ? "dark" : "light";
  if (nowMode === "light") {
    activateDarkMode();
    saveToLocal.set("theme", "dark", 2);
    GLOBAL_CONFIG.Snackbar !== undefined && anzhiyu.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night);
    document.querySelector(".menu-darkmode-text").textContent = "æµ…è‰²æ¨¡å¼";
  } else {
    activateLightMode();
    saveToLocal.set("theme", "light", 2);
    GLOBAL_CONFIG.Snackbar !== undefined && anzhiyu.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day);
    document.querySelector(".menu-darkmode-text").textContent = "æ·±è‰²æ¨¡å¼";
  }
  // handle some cases
  typeof runMermaid === "function" && window.runMermaid();
  rm.hideRightMenu();
  anzhiyu.darkModeStatus();
};

rm.copyUrl = function (id) {
  const input = document.createElement("input"); // Create a new <input> element
  input.id = "copyVal"; // Set the id of the new element to "copyVal"
  document.body.appendChild(input); // Append the new element to the end of the <body> element
  
  const text = id;
  input.value = text;
  input.select();
  input.setSelectionRange(0, input.value.length);
  document.execCommand("copy");
  
  input.remove(); // Remove the <input> element from the DOM
};

function stopMaskScroll() {
  if (document.getElementById("rightmenu-mask")) {
    let xscroll = document.getElementById("rightmenu-mask");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //é˜»æ­¢æµè§ˆå™¨é»˜è®¤æ–¹æ³•
        rm.hideRightMenu();
        // e.preventDefault();
      },
      false
    );
  }
  if (document.getElementById("rightMenu")) {
    let xscroll = document.getElementById("rightMenu");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //é˜»æ­¢æµè§ˆå™¨é»˜è®¤æ–¹æ³•
        rm.hideRightMenu();
        // e.preventDefault();
      },
      false
    );
  }
}

rm.rightmenuCopyText = function (txt) {
  if (navigator.clipboard) {
    navigator.clipboard.writeText(txt);
  }
  rm.hideRightMenu();
};

rm.copyPageUrl = function () {
  var url = window.location.href;
  rm.copyUrl(url);
  anzhiyu.snackbarShow("å¤åˆ¶æœ¬é¡µé“¾æ¥åœ°å€æˆåŠŸ", false, 2000);
  rm.hideRightMenu();
};

rm.sharePage = function () {
  var content = window.location.href;
  rm.copyUrl(url);
  anzhiyu.snackbarShow("å¤åˆ¶æœ¬é¡µé“¾æ¥åœ°å€æˆåŠŸ", false, 2000);
  rm.hideRightMenu();
};

// å¤åˆ¶å½“å‰é€‰ä¸­æ–‡æœ¬
var selectTextNow = "";
document.onmouseup = document.ondblclick = selceText;

function selceText() {
  var txt;
  if (document.selection) {
    txt = document.selection.createRange().text;
  } else {
    txt = window.getSelection().toString();
  }
  selectTextNow = txt !== "" ? txt : "";
}

// è¯»å–å‰ªåˆ‡æ¿
rm.readClipboard = function () {
  if (navigator.clipboard) {
    navigator.clipboard.readText().then(clipText => rm.insertAtCaret(globalEvent.target, clipText));
  }
};

// ç²˜è´´æ–‡æœ¬åˆ°ç„¦ç‚¹
rm.insertAtCaret = function (elemt, value) {
  const startPos = elemt.selectionStart,
    endPos = elemt.selectionEnd;
  if (document.selection) {
    elemt.focus();
    var sel = document.selection.createRange();
    sel.text = value;
    elemt.focus();
  } else {
    if (startPos || startPos == "0") {
      var scrollTop = elemt.scrollTop;
      elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);
      elemt.focus();
      elemt.selectionStart = startPos + value.length;
      elemt.selectionEnd = startPos + value.length;
      elemt.scrollTop = scrollTop;
    } else {
      elemt.value += value;
      elemt.focus();
    }
  }
};

//ç²˜è´´æ–‡æœ¬
rm.pasteText = function () {
  const result = rm.readClipboard() || "";
  rm.hideRightMenu();
};

//å¼•ç”¨åˆ°è¯„è®º
rm.rightMenuCommentText = function (txt) {
  rm.hideRightMenu();
  const postCommentDom = document.getElementById("post-comment");
  var domTop = postCommentDom.offsetTop;
  window.scrollTo(0, domTop - 80);
  if (txt == "undefined" || txt == "null") txt = "å¥½æ£’ï¼";
  function setText() {
    setTimeout(() => {
      var input = document.getElementsByClassName("el-textarea__inner")[0];
      if (!input) setText();
      let evt = document.createEvent("HTMLEvents");
      evt.initEvent("input", true, true);
      let inputValue = replaceAll(txt, "\n", "\n> ");
      input.value = "> " + inputValue + "\n\n";
      input.dispatchEvent(evt);
      input.focus();
      input.setSelectionRange(-1, -1);
      if (document.getElementById("comment-tips")) {
        document.getElementById("comment-tips").classList.add("show");
      }
    }, 100);
  }
  setText();
};

//æ›¿æ¢æ‰€æœ‰å†…å®¹
function replaceAll(string, search, replace) {
  return string.split(search).join(replace);
}

// ç™¾åº¦æœç´¢
rm.searchBaidu = function () {
  anzhiyu.snackbarShow("å³å°†è·³è½¬åˆ°ç™¾åº¦æœç´¢", false, 2000);
  setTimeout(function () {
    window.open("https://www.baidu.com/s?wd=" + selectTextNow);
  }, "2000");
  rm.hideRightMenu();
};

//åˆ†äº«é“¾æ¥
rm.copyLink = function () {
  rm.rightmenuCopyText(domhref);
  anzhiyu.snackbarShow("å·²å¤åˆ¶é“¾æ¥åœ°å€");
};

function addRightMenuClickEvent() {
  // æ·»åŠ ç‚¹å‡»äº‹ä»¶
  document.getElementById("menu-backward").addEventListener("click", function () {
  window.history.back();
    rm.hideRightMenu();
  });

  document.getElementById("menu-forward").addEventListener("click", function () {
    window.history.forward();
    rm.hideRightMenu();
  });

  document.getElementById("menu-refresh").addEventListener("click", function () {
    window.location.reload();
  });

  document.getElementById("menu-top").addEventListener("click", function () {
    anzhiyu.scrollToDest(0, 500);
    rm.hideRightMenu();
  });

  const menuLinks = document.querySelectorAll(".menu-link");
  menuLinks.forEach(function (link) {
    link.addEventListener("click", rm.hideRightMenu);
  });

  document.getElementById("menu-darkmode").addEventListener("click", rm.switchDarkMode);

  document.getElementById("menu-home") && document.getElementById("menu-home").addEventListener("click", function () {
    window.location.href = window.location.origin;
  });

  document.getElementById("menu-randomPost").addEventListener("click", function () {
    toRandomPost();
  });

  document.getElementById("menu-commentBarrage").addEventListener("click", anzhiyu.switchCommentBarrage);

  document.getElementById("rightmenu-mask").addEventListener("click", rm.hideRightMenu);

  document.getElementById("rightmenu-mask").addEventListener("contextmenu", function (event) {
    rm.hideRightMenu();
    event.preventDefault(); // Prevent the default context menu from appearing
  });

  document.getElementById("menu-copy").addEventListener("click", rm.copyPageUrl);

  document.getElementById("menu-pastetext").addEventListener("click", rm.pasteText);

  document.getElementById("menu-copytext").addEventListener("click", function () {
    rm.rightmenuCopyText(selectTextNow);
    anzhiyu.snackbarShow("å¤åˆ¶æˆåŠŸï¼Œå¤åˆ¶å’Œè½¬è½½è¯·æ ‡æ³¨æœ¬æ–‡åœ°å€");
  });

  document.getElementById("menu-commenttext").addEventListener("click", function () {
    rm.rightMenuCommentText(selectTextNow);
  });

  document.getElementById("menu-newwindow").addEventListener("click", function () {
    window.open(domhref);
    rm.hideRightMenu();
  });

  document.getElementById("menu-copylink").addEventListener("click", rm.copyLink);

  document.getElementById("menu-downloadimg").addEventListener("click", function () {
    anzhiyu.downloadImage(domImgSrc, "anzhiyu");
  });

  document.getElementById("menu-newwindowimg").addEventListener("click", function () {
    window.open(domImgSrc);
    rm.hideRightMenu();
  });

  document.getElementById("menu-copyimg").addEventListener("click", function () {
    rm.writeClipImg(domImgSrc);
  });

  document.getElementById("menu-searchBaidu").addEventListener("click", rm.searchBaidu);

  //éŸ³ä¹
  document.getElementById("menu-music-toggle").addEventListener("click", anzhiyu.musicToggle);

  document.getElementById("menu-music-back").addEventListener("click", anzhiyu.musicSkipBack);

  document.getElementById("menu-music-forward").addEventListener("click", anzhiyu.musicSkipForward);

  document.getElementById("menu-music-copyMusicName").addEventListener("click", function () {
    rm.rightmenuCopyText(anzhiyu.musicGetName());
    anzhiyu.snackbarShow("å¤åˆ¶æ­Œæ›²åç§°æˆåŠŸ", false, 3000);
  });

}

addRightMenuClickEvent();</script><script data-pjax>var themeColorMeta = document.querySelector('meta[name="theme-color"]');
var pageHeaderEl = document.getElementById("page-header");
var navMusicEl = document.getElementById("nav-music");
var consoleEl = document.getElementById("console");
// å·²éšæœºçš„æ­Œæ›²
var selectRandomSong = [];
// éŸ³ä¹é»˜è®¤å£°éŸ³å¤§å°
var musicVolume = 0.8;
// æ˜¯å¦åˆ‡æ¢äº†å‘¨æ°ä¼¦éŸ³ä¹åˆ—è¡¨
var changeMusicListFlag = false;
// å½“å‰é»˜è®¤æ’­æ”¾åˆ—è¡¨
var defaultPlayMusicList = [];

document.getElementById("page-name").innerText = document.title.split(" | å®‰çŸ¥é±¼")[0];
anzhiyu.initIndexEssay();
anzhiyu.changeTimeInEssay();
anzhiyu.removeBodyPaceClass();
anzhiyu.qrcodeCreate();
anzhiyu.changeTimeInAlbumDetail();
anzhiyu.reflashEssayWaterFall();
anzhiyu.sayhi();
anzhiyu.stopImgRightDrag();
anzhiyu.addNavBackgroundInit();
anzhiyu.setValueToBodyType();

anzhiyu.getCustomPlayList();
anzhiyu.addEventListenerConsoleMusicList(false);</script><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.6/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://npm.elemecdn.com/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://npm.elemecdn.com/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)
  window.anzhiyuScrollFnToDo && window.removeEventListener('scroll', anzhiyuScrollFnToDo)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>